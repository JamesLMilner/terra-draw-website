function Gh(n,e){for(var i=0;i<e.length;i++){const o=e[i];if(typeof o!="string"&&!Array.isArray(o)){for(const s in o)if(s!=="default"&&!(s in n)){const l=Object.getOwnPropertyDescriptor(o,s);l&&Object.defineProperty(n,s,l.get?l:{enumerable:!0,get:()=>o[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))o(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const h of l.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&o(h)}).observe(document,{childList:!0,subtree:!0});function i(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(s){if(s.ep)return;s.ep=!0;const l=i(s);fetch(s.href,l)}})();var Di,J,pa,_a,Mi,os,ga,pn={},ma=[],qh=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function oe(n,e){for(var i in e)n[i]=e[i];return n}function ya(n){var e=n.parentNode;e&&e.removeChild(n)}function Qe(n,e,i){var o,s,l,h={};for(l in e)l=="key"?o=e[l]:l=="ref"?s=e[l]:h[l]=e[l];if(arguments.length>2&&(h.children=arguments.length>3?Di.call(arguments,2):i),typeof n=="function"&&n.defaultProps!=null)for(l in n.defaultProps)h[l]===void 0&&(h[l]=n.defaultProps[l]);return ki(n,h,o,s,null)}function ki(n,e,i,o,s){var l={type:n,props:e,key:i,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s??++pa};return s==null&&J.vnode!=null&&J.vnode(l),l}function Kh(){return{current:null}}function Oi(n){return n.children}function qe(n,e){this.props=n,this.context=e}function Ei(n,e){if(e==null)return n.__?Ei(n.__,n.__.__k.indexOf(n)+1):null;for(var i;e<n.__k.length;e++)if((i=n.__k[e])!=null&&i.__e!=null)return i.__e;return typeof n.type=="function"?Ei(n):null}function va(n){var e,i;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((i=n.__k[e])!=null&&i.__e!=null){n.__e=n.__c.base=i.__e;break}return va(n)}}function br(n){(!n.__d&&(n.__d=!0)&&Mi.push(n)&&!_n.__r++||os!==J.debounceRendering)&&((os=J.debounceRendering)||setTimeout)(_n)}function _n(){for(var n;_n.__r=Mi.length;)n=Mi.sort(function(e,i){return e.__v.__b-i.__v.__b}),Mi=[],n.some(function(e){var i,o,s,l,h,u;e.__d&&(h=(l=(i=e).__v).__e,(u=i.__P)&&(o=[],(s=oe({},l)).__v=l.__v+1,Ir(u,l,s,i.__n,u.ownerSVGElement!==void 0,l.__h!=null?[h]:null,o,h??Ei(l),l.__h),Pa(o,l),l.__e!=h&&va(l)))})}function wa(n,e,i,o,s,l,h,u,d,_){var p,m,v,x,P,T,O,A=o&&o.__k||ma,w=A.length;for(i.__k=[],p=0;p<e.length;p++)if((x=i.__k[p]=(x=e[p])==null||typeof x=="boolean"?null:typeof x=="string"||typeof x=="number"||typeof x=="bigint"?ki(null,x,null,null,x):Array.isArray(x)?ki(Oi,{children:x},null,null,null):x.__b>0?ki(x.type,x.props,x.key,x.ref?x.ref:null,x.__v):x)!=null){if(x.__=i,x.__b=i.__b+1,(v=A[p])===null||v&&x.key==v.key&&x.type===v.type)A[p]=void 0;else for(m=0;m<w;m++){if((v=A[m])&&x.key==v.key&&x.type===v.type){A[m]=void 0;break}v=null}Ir(n,x,v=v||pn,s,l,h,u,d,_),P=x.__e,(m=x.ref)&&v.ref!=m&&(O||(O=[]),v.ref&&O.push(v.ref,null,x),O.push(m,x.__c||P,x)),P!=null?(T==null&&(T=P),typeof x.type=="function"&&x.__k===v.__k?x.__d=d=xa(x,d,n):d=ba(n,x,v,A,P,d),typeof i.type=="function"&&(i.__d=d)):d&&v.__e==d&&d.parentNode!=n&&(d=Ei(v))}for(i.__e=T,p=w;p--;)A[p]!=null&&Ma(A[p],A[p]);if(O)for(p=0;p<O.length;p++)Ca(O[p],O[++p],O[++p])}function xa(n,e,i){for(var o,s=n.__k,l=0;s&&l<s.length;l++)(o=s[l])&&(o.__=n,e=typeof o.type=="function"?xa(o,e,i):ba(i,o,o,s,o.__e,e));return e}function gn(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(i){gn(i,e)}):e.push(n)),e}function ba(n,e,i,o,s,l){var h,u,d;if(e.__d!==void 0)h=e.__d,e.__d=void 0;else if(i==null||s!=l||s.parentNode==null)t:if(l==null||l.parentNode!==n)n.appendChild(s),h=null;else{for(u=l,d=0;(u=u.nextSibling)&&d<o.length;d+=1)if(u==s)break t;n.insertBefore(s,l),h=l}return h!==void 0?h:s.nextSibling}function $h(n,e,i,o,s){var l;for(l in i)l==="children"||l==="key"||l in e||mn(n,l,null,i[l],o);for(l in e)s&&typeof e[l]!="function"||l==="children"||l==="key"||l==="value"||l==="checked"||i[l]===e[l]||mn(n,l,e[l],i[l],o)}function ss(n,e,i){e[0]==="-"?n.setProperty(e,i):n[e]=i==null?"":typeof i!="number"||qh.test(e)?i:i+"px"}function mn(n,e,i,o,s){var l;t:if(e==="style")if(typeof i=="string")n.style.cssText=i;else{if(typeof o=="string"&&(n.style.cssText=o=""),o)for(e in o)i&&e in i||ss(n.style,e,"");if(i)for(e in i)o&&i[e]===o[e]||ss(n.style,e,i[e])}else if(e[0]==="o"&&e[1]==="n")l=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+l]=i,i?o||n.addEventListener(e,l?ls:as,l):n.removeEventListener(e,l?ls:as,l);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=i??"";break t}catch{}typeof i=="function"||(i==null||i===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,i))}}function as(n){this.l[n.type+!1](J.event?J.event(n):n)}function ls(n){this.l[n.type+!0](J.event?J.event(n):n)}function Ir(n,e,i,o,s,l,h,u,d){var _,p,m,v,x,P,T,O,A,w,M,k,F,I,B,z=e.type;if(e.constructor!==void 0)return null;i.__h!=null&&(d=i.__h,u=e.__e=i.__e,e.__h=null,l=[u]),(_=J.__b)&&_(e);try{t:if(typeof z=="function"){if(O=e.props,A=(_=z.contextType)&&o[_.__c],w=_?A?A.props.value:_.__:o,i.__c?T=(p=e.__c=i.__c).__=p.__E:("prototype"in z&&z.prototype.render?e.__c=p=new z(O,w):(e.__c=p=new qe(O,w),p.constructor=z,p.render=Qh),A&&A.sub(p),p.props=O,p.state||(p.state={}),p.context=w,p.__n=o,m=p.__d=!0,p.__h=[],p._sb=[]),p.__s==null&&(p.__s=p.state),z.getDerivedStateFromProps!=null&&(p.__s==p.state&&(p.__s=oe({},p.__s)),oe(p.__s,z.getDerivedStateFromProps(O,p.__s))),v=p.props,x=p.state,m)z.getDerivedStateFromProps==null&&p.componentWillMount!=null&&p.componentWillMount(),p.componentDidMount!=null&&p.__h.push(p.componentDidMount);else{if(z.getDerivedStateFromProps==null&&O!==v&&p.componentWillReceiveProps!=null&&p.componentWillReceiveProps(O,w),!p.__e&&p.shouldComponentUpdate!=null&&p.shouldComponentUpdate(O,p.__s,w)===!1||e.__v===i.__v){for(p.props=O,p.state=p.__s,e.__v!==i.__v&&(p.__d=!1),p.__v=e,e.__e=i.__e,e.__k=i.__k,e.__k.forEach(function(j){j&&(j.__=e)}),M=0;M<p._sb.length;M++)p.__h.push(p._sb[M]);p._sb=[],p.__h.length&&h.push(p);break t}p.componentWillUpdate!=null&&p.componentWillUpdate(O,p.__s,w),p.componentDidUpdate!=null&&p.__h.push(function(){p.componentDidUpdate(v,x,P)})}if(p.context=w,p.props=O,p.__v=e,p.__P=n,k=J.__r,F=0,"prototype"in z&&z.prototype.render){for(p.state=p.__s,p.__d=!1,k&&k(e),_=p.render(p.props,p.state,p.context),I=0;I<p._sb.length;I++)p.__h.push(p._sb[I]);p._sb=[]}else do p.__d=!1,k&&k(e),_=p.render(p.props,p.state,p.context),p.state=p.__s;while(p.__d&&++F<25);p.state=p.__s,p.getChildContext!=null&&(o=oe(oe({},o),p.getChildContext())),m||p.getSnapshotBeforeUpdate==null||(P=p.getSnapshotBeforeUpdate(v,x)),B=_!=null&&_.type===Oi&&_.key==null?_.props.children:_,wa(n,Array.isArray(B)?B:[B],e,i,o,s,l,h,u,d),p.base=e.__e,e.__h=null,p.__h.length&&h.push(p),T&&(p.__E=p.__=null),p.__e=!1}else l==null&&e.__v===i.__v?(e.__k=i.__k,e.__e=i.__e):e.__e=Jh(i.__e,e,i,o,s,l,h,d);(_=J.diffed)&&_(e)}catch(j){e.__v=null,(d||l!=null)&&(e.__e=u,e.__h=!!d,l[l.indexOf(u)]=null),J.__e(j,e,i)}}function Pa(n,e){J.__c&&J.__c(e,n),n.some(function(i){try{n=i.__h,i.__h=[],n.some(function(o){o.call(i)})}catch(o){J.__e(o,i.__v)}})}function Jh(n,e,i,o,s,l,h,u){var d,_,p,m=i.props,v=e.props,x=e.type,P=0;if(x==="svg"&&(s=!0),l!=null){for(;P<l.length;P++)if((d=l[P])&&"setAttribute"in d==!!x&&(x?d.localName===x:d.nodeType===3)){n=d,l[P]=null;break}}if(n==null){if(x===null)return document.createTextNode(v);n=s?document.createElementNS("http://www.w3.org/2000/svg",x):document.createElement(x,v.is&&v),l=null,u=!1}if(x===null)m===v||u&&n.data===v||(n.data=v);else{if(l=l&&Di.call(n.childNodes),_=(m=i.props||pn).dangerouslySetInnerHTML,p=v.dangerouslySetInnerHTML,!u){if(l!=null)for(m={},P=0;P<n.attributes.length;P++)m[n.attributes[P].name]=n.attributes[P].value;(p||_)&&(p&&(_&&p.__html==_.__html||p.__html===n.innerHTML)||(n.innerHTML=p&&p.__html||""))}if($h(n,v,m,s,u),p)e.__k=[];else if(P=e.props.children,wa(n,Array.isArray(P)?P:[P],e,i,o,s&&x!=="foreignObject",l,h,l?l[0]:i.__k&&Ei(i,0),u),l!=null)for(P=l.length;P--;)l[P]!=null&&ya(l[P]);u||("value"in v&&(P=v.value)!==void 0&&(P!==n.value||x==="progress"&&!P||x==="option"&&P!==m.value)&&mn(n,"value",P,m.value,!1),"checked"in v&&(P=v.checked)!==void 0&&P!==n.checked&&mn(n,"checked",P,m.checked,!1))}return n}function Ca(n,e,i){try{typeof n=="function"?n(e):n.current=e}catch(o){J.__e(o,i)}}function Ma(n,e,i){var o,s;if(J.unmount&&J.unmount(n),(o=n.ref)&&(o.current&&o.current!==n.__e||Ca(o,null,e)),(o=n.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(l){J.__e(l,e)}o.base=o.__P=null,n.__c=void 0}if(o=n.__k)for(s=0;s<o.length;s++)o[s]&&Ma(o[s],e,i||typeof n.type!="function");i||n.__e==null||ya(n.__e),n.__=n.__e=n.__d=void 0}function Qh(n,e,i){return this.constructor(n,i)}function Dr(n,e,i){var o,s,l;J.__&&J.__(n,e),s=(o=typeof i=="function")?null:i&&i.__k||e.__k,l=[],Ir(e,n=(!o&&i||e).__k=Qe(Oi,null,[n]),s||pn,pn,e.ownerSVGElement!==void 0,!o&&i?[i]:s?null:e.firstChild?Di.call(e.childNodes):null,l,!o&&i?i:s?s.__e:e.firstChild,o),Pa(l,n)}function Or(n,e){Dr(n,e,Or)}function ka(n,e,i){var o,s,l,h=oe({},n.props);for(l in e)l=="key"?o=e[l]:l=="ref"?s=e[l]:h[l]=e[l];return arguments.length>2&&(h.children=arguments.length>3?Di.call(arguments,2):i),ki(n.type,h,o||n.key,s||n.ref,null)}function Ar(n,e){var i={__c:e="__cC"+ga++,__:n,Consumer:function(o,s){return o.children(s)},Provider:function(o){var s,l;return this.getChildContext||(s=[],(l={})[e]=this,this.getChildContext=function(){return l},this.shouldComponentUpdate=function(h){this.props.value!==h.value&&s.some(br)},this.sub=function(h){s.push(h);var u=h.componentWillUnmount;h.componentWillUnmount=function(){s.splice(s.indexOf(h),1),u&&u.call(h)}}),o.children}};return i.Provider.__=i.Consumer.contextType=i}Di=ma.slice,J={__e:function(n,e,i,o){for(var s,l,h;e=e.__;)if((s=e.__c)&&!s.__)try{if((l=s.constructor)&&l.getDerivedStateFromError!=null&&(s.setState(l.getDerivedStateFromError(n)),h=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(n,o||{}),h=s.__d),h)return s.__E=s}catch(u){n=u}throw n}},pa=0,_a=function(n){return n!=null&&n.constructor===void 0},qe.prototype.setState=function(n,e){var i;i=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=oe({},this.state),typeof n=="function"&&(n=n(oe({},i),this.props)),n&&oe(i,n),n!=null&&this.__v&&(e&&this._sb.push(e),br(this))},qe.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),br(this))},qe.prototype.render=Oi,Mi=[],_n.__r=0,ga=0;const tc=Object.freeze(Object.defineProperty({__proto__:null,Component:qe,Fragment:Oi,cloneElement:ka,createContext:Ar,createElement:Qe,createRef:Kh,h:Qe,hydrate:Or,get isValidElement(){return _a},get options(){return J},render:Dr,toChildArray:gn},Symbol.toStringTag,{value:"Module"}));var ec=0;function W(n,e,i,o,s){var l,h,u={};for(h in e)h=="ref"?l=e[h]:u[h]=e[h];var d={type:n,props:u,key:i,ref:l,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:--ec,__source:s,__self:o};if(typeof n=="function"&&(l=n.defaultProps))for(h in l)u[h]===void 0&&(u[h]=l[h]);return J.vnode&&J.vnode(d),d}var ic={};function La(n,e){for(var i in e)n[i]=e[i];return n}function Br(n,e,i){var o=/(?:\?([^#]*))?(#.*)?$/,s=n.match(o),l={},h;if(s&&s[1])for(var u=s[1].split("&"),d=0;d<u.length;d++){var _=u[d].split("=");l[decodeURIComponent(_[0])]=decodeURIComponent(_.slice(1).join("="))}n=Pr(n.replace(o,"")),e=Pr(e||"");for(var p=Math.max(n.length,e.length),m=0;m<p;m++)if(e[m]&&e[m].charAt(0)===":"){var v=e[m].replace(/(^:|[+*?]+$)/g,""),x=(e[m].match(/[+*?]+$/)||ic)[0]||"",P=~x.indexOf("+"),T=~x.indexOf("*"),O=n[m]||"";if(!O&&!T&&(x.indexOf("?")<0||P)){h=!1;break}if(l[v]=decodeURIComponent(O),P||T){l[v]=n.slice(m).map(decodeURIComponent).join("/");break}}else if(e[m]!==n[m]){h=!1;break}return i.default!==!0&&h===!1?!1:l}function nc(n,e){return n.rank<e.rank?1:n.rank>e.rank?-1:n.index-e.index}function rc(n,e){return n.index=e,n.rank=ac(n),n.props}function Pr(n){return n.replace(/(^\/+|\/+$)/g,"").split("/")}function oc(n){return n.charAt(0)==":"?1+"*+?".indexOf(n.charAt(n.length-1))||4:5}function sc(n){return Pr(n).map(oc).join("")}function ac(n){return n.props.default?0:sc(n.props.path)}var Tt=null,Ce=[],yn=[],lc={};function hc(n,e){e===void 0&&(e="push"),Tt&&Tt[e]?Tt[e](n):typeof history<"u"&&history[e+"State"]&&history[e+"State"](null,null,n)}function Ln(){var n;return Tt&&Tt.location?n=Tt.location:Tt&&Tt.getCurrentLocation?n=Tt.getCurrentLocation():n=typeof location<"u"?location:lc,""+(n.pathname||"")+(n.search||"")}function Fr(n,e){return e===void 0&&(e=!1),typeof n!="string"&&n.url&&(e=n.replace,n=n.url),cc(n)&&hc(n,e?"replace":"push"),Sa(n)}function cc(n){for(var e=Ce.length;e--;)if(Ce[e].canRoute(n))return!0;return!1}function Sa(n){for(var e=!1,i=0;i<Ce.length;i++)Ce[i].routeTo(n)===!0&&(e=!0);for(var o=yn.length;o--;)yn[o](n);return e}function Ea(n){if(!(!n||!n.getAttribute)){var e=n.getAttribute("href"),i=n.getAttribute("target");if(!(!e||!e.match(/^\//g)||i&&!i.match(/^_?self$/i)))return Fr(e)}}function uc(n){if(!(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button!==0))return Ea(n.currentTarget||n.target||this),Ta(n)}function Ta(n){return n&&(n.stopImmediatePropagation&&n.stopImmediatePropagation(),n.stopPropagation&&n.stopPropagation(),n.preventDefault()),!1}function dc(n){if(!(n.ctrlKey||n.metaKey||n.altKey||n.shiftKey||n.button!==0)){var e=n.target;do if(String(e.nodeName).toUpperCase()==="A"&&e.getAttribute("href")){if(e.hasAttribute("native"))return;if(Ea(e))return Ta(n)}while(e=e.parentNode)}}var hs=!1;function fc(){hs||(typeof addEventListener=="function"&&(Tt||addEventListener("popstate",function(){Sa(Ln())}),addEventListener("click",dc)),hs=!0)}var qt=function(n){function e(i){n.call(this,i),i.history&&(Tt=i.history),this.state={url:i.url||Ln()},fc()}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.shouldComponentUpdate=function(o){return o.static!==!0?!0:o.url!==this.props.url||o.onChange!==this.props.onChange},e.prototype.canRoute=function(o){var s=gn(this.props.children);return this.getMatchingChildren(s,o,!1).length>0},e.prototype.routeTo=function(o){this.setState({url:o});var s=this.canRoute(o);return this.updating||this.forceUpdate(),s},e.prototype.componentWillMount=function(){Ce.push(this),this.updating=!0},e.prototype.componentDidMount=function(){var o=this;Tt&&(this.unlisten=Tt.listen(function(s){o.routeTo(""+(s.pathname||"")+(s.search||""))})),this.updating=!1},e.prototype.componentWillUnmount=function(){typeof this.unlisten=="function"&&this.unlisten(),Ce.splice(Ce.indexOf(this),1)},e.prototype.componentWillUpdate=function(){this.updating=!0},e.prototype.componentDidUpdate=function(){this.updating=!1},e.prototype.getMatchingChildren=function(o,s,l){return o.filter(rc).sort(nc).map(function(h){var u=Br(s,h.props.path,h.props);if(u){if(l!==!1){var d={url:s,matches:u};return La(d,u),delete d.ref,delete d.key,ka(h,d)}return h}}).filter(Boolean)},e.prototype.render=function(o,s){var l=o.children,h=o.onChange,u=s.url,d=this.getMatchingChildren(gn(l),u,!0),_=d[0]||null,p=this.previousUrl;return u!==p&&(this.previousUrl=u,typeof h=="function"&&h({router:this,url:u,previous:p,active:d,current:_})),_},e}(qe),za=function(n){return Qe("a",La({onClick:uc},n))},vn=function(n){return Qe(n.component,n)};qt.subscribers=yn;qt.getCurrentUrl=Ln;qt.route=Fr;qt.Router=qt;qt.Route=vn;qt.Link=za;qt.exec=Br;const pc=Object.freeze(Object.defineProperty({__proto__:null,Link:za,Route:vn,Router:qt,default:qt,exec:Br,getCurrentUrl:Ln,route:Fr,subscribers:yn},Symbol.toStringTag,{value:"Module"}));function wn(){return wn=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},wn.apply(this,arguments)}var He;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(He||(He={}));var cs=function(n){return n},us="beforeunload",_c="hashchange",gc="popstate";function mc(n){n===void 0&&(n={});var e=n,i=e.window,o=i===void 0?document.defaultView:i,s=o.history;function l(){var z=ps(o.location.hash.substr(1)),j=z.pathname,H=j===void 0?"/":j,V=z.search,G=V===void 0?"":V,q=z.hash,y=q===void 0?"":q,C=s.state||{};return[C.idx,cs({pathname:H,search:G,hash:y,state:C.usr||null,key:C.key||"default"})]}var h=null;function u(){if(h)x.call(h),h=null;else{var z=He.Pop,j=l(),H=j[0],V=j[1];if(x.length){if(H!=null){var G=p-H;G&&(h={action:z,location:V,retry:function(){I(G*-1)}},I(G))}}else M(z)}}o.addEventListener(gc,u),o.addEventListener(_c,function(){var z=l(),j=z[1];hr(j)!==hr(m)&&u()});var d=He.Pop,_=l(),p=_[0],m=_[1],v=fs(),x=fs();p==null&&(p=0,s.replaceState(wn({},s.state,{idx:p}),""));function P(){var z=document.querySelector("base"),j="";if(z&&z.getAttribute("href")){var H=o.location.href,V=H.indexOf("#");j=V===-1?H:H.slice(0,V)}return j}function T(z){return P()+"#"+(typeof z=="string"?z:hr(z))}function O(z,j){return j===void 0&&(j=null),cs(wn({pathname:m.pathname,hash:"",search:""},typeof z=="string"?ps(z):z,{state:j,key:yc()}))}function A(z,j){return[{usr:z.state,key:z.key,idx:j},T(z)]}function w(z,j,H){return!x.length||(x.call({action:z,location:j,retry:H}),!1)}function M(z){d=z;var j=l();p=j[0],m=j[1],v.call({action:d,location:m})}function k(z,j){var H=He.Push,V=O(z,j);function G(){k(z,j)}if(w(H,V,G)){var q=A(V,p+1),y=q[0],C=q[1];try{s.pushState(y,"",C)}catch{o.location.assign(C)}M(H)}}function F(z,j){var H=He.Replace,V=O(z,j);function G(){F(z,j)}if(w(H,V,G)){var q=A(V,p),y=q[0],C=q[1];s.replaceState(y,"",C),M(H)}}function I(z){s.go(z)}var B={get action(){return d},get location(){return m},createHref:T,push:k,replace:F,go:I,back:function(){I(-1)},forward:function(){I(1)},listen:function(j){return v.push(j)},block:function(j){var H=x.push(j);return x.length===1&&o.addEventListener(us,ds),function(){H(),x.length||o.removeEventListener(us,ds)}}};return B}function ds(n){n.preventDefault(),n.returnValue=""}function fs(){var n=[];return{get length(){return n.length},push:function(i){return n.push(i),function(){n=n.filter(function(o){return o!==i})}},call:function(i){n.forEach(function(o){return o&&o(i)})}}}function yc(){return Math.random().toString(36).substr(2,8)}function hr(n){var e=n.pathname,i=e===void 0?"/":e,o=n.search,s=o===void 0?"":o,l=n.hash,h=l===void 0?"":l;return s&&s!=="?"&&(i+=s.charAt(0)==="?"?s:"?"+s),h&&h!=="#"&&(i+=h.charAt(0)==="#"?h:"#"+h),i}function ps(n){var e={};if(n){var i=n.indexOf("#");i>=0&&(e.hash=n.substr(i),n=n.substr(0,i));var o=n.indexOf("?");o>=0&&(e.search=n.substr(o),n=n.substr(0,o)),n&&(e.pathname=n)}return e}var vc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function wc(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function Ia(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var i=function o(){return this instanceof o?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};i.prototype=e.prototype}else i={};return Object.defineProperty(i,"__esModule",{value:!0}),Object.keys(n).forEach(function(o){var s=Object.getOwnPropertyDescriptor(n,o);Object.defineProperty(i,o,s.get?s:{enumerable:!0,get:function(){return n[o]}})}),i}var ti={};const xc=Ia(tc),bc=Ia(pc);Object.defineProperty(ti,"__esModule",{value:!0});var Cr=ti.Link=ti.Match=void 0,Pc=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},Mr=xc,Ue=bc;function Cc(n,e){var i={};for(var o in n)e.indexOf(o)>=0||Object.prototype.hasOwnProperty.call(n,o)&&(i[o]=n[o]);return i}function Mc(n,e){if(!(n instanceof e))throw new TypeError("Cannot call a class as a function")}function _s(n,e){if(!n)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e&&(typeof e=="object"||typeof e=="function")?e:n}function kc(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof e);n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(n,e):n.__proto__=e)}var Rr=ti.Match=function(n){kc(e,n);function e(){var i,o,s;Mc(this,e);for(var l=arguments.length,h=Array(l),u=0;u<l;u++)h[u]=arguments[u];return s=(i=(o=_s(this,n.call.apply(n,[this].concat(h))),o),o.update=function(d){o.nextUrl=d,o.setState({})},i),_s(o,s)}return e.prototype.componentDidMount=function(){Ue.subscribers.push(this.update)},e.prototype.componentWillUnmount=function(){Ue.subscribers.splice(Ue.subscribers.indexOf(this.update)>>>0,1)},e.prototype.render=function(o){var s=this.nextUrl||(0,Ue.getCurrentUrl)(),l=s.replace(/\?.+$/,"");return this.nextUrl=null,o.children({url:s,path:l,matches:(0,Ue.exec)(l,o.path,{})!==!1})},e}(Mr.Component),Da=function(e){var i=e.activeClassName,o=e.path,s=Cc(e,["activeClassName","path"]);return(0,Mr.h)(Rr,{path:o||s.href},function(l){var h=l.matches;return(0,Mr.h)(Ue.Link,Pc({},s,{class:[s.class||s.className,h&&i].filter(Boolean).join(" ")}))})};Cr=ti.Link=Da;ti.default=Rr;Rr.Link=Da;const Lc="_header_19max_1",Sc="_nav_19max_14",Ec="_github_19max_19",Tc="_logo_19max_26",zc="_active_19max_66",Be={header:Lc,nav:Sc,github:Ec,logo:Tc,active:zc},Ic="/assets/logo-CVw9Dily.png",Dc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDpFNTE3OEEyQTk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDpFNTE3OEEyQjk5QTAxMUUyOUExNUJDMTA0NkE4OTA0RCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkU1MTc4QTI4OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOkU1MTc4QTI5OTlBMDExRTI5QTE1QkMxMDQ2QTg5MDREIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+m4QGuQAAAyRJREFUeNrEl21ojWEYx895TDPbMNlBK46IUiNmPvHBSUjaqc0H8pF5+aDUKPEBqU2NhRQpX5Rv5jWlDIWlMCv7MMSWsWwmb3tpXub4XXWdPHvc9/Gc41nu+nedc7/8r/99PffLdYdDPsvkwsgkTBwsA/PADJCnzX2gHTwBt8Hl7p537/3whn04XoDZDcpBlk+9P8AFcAghzRkJwPF4zGGw0Y9QS0mAM2AnQj77FqCzrtcwB1Hk81SYojHK4DyGuQ6mhIIrBWB9Xm7ug/6B/nZrBHBegrkFxoVGpnwBMSLR9EcEcC4qb8pP14BWcBcUgewMnF3T34VqhWMFkThLJAalwnENOAKiHpJq1FZgI2AT6HZtuxZwR9GidSHtI30jOrbawxlVX78/AbNfhHlomEUJJI89O2MqeE79T8/nk8nMBm/dK576hZgmA3cp/R4l9/UeSxiHLVIlNm4nFfT0bxyuIj7LHRTKai+zdJobwMKzcZSJb0ePV5PKN+BqAAKE47UlMnERELMM3EdYP/yrd+XYb2mOiYBiQ8OQnoRBlXrl9JZix7D1pHTazu4MoyBcnYamqAjIMTR8G4FT8LuhLsexXYYjICBiqhQBvYb6fLZIJCjPypVvaOoVAW2WcasCnL2Nq82xHJNSqlCeFcDshaPK0twkAhosjZL31QYw+1rlMpWGMArl23SBsZZO58F2tlJXmjOXS+s4WGvpMiBJT/I2PInZ6lIs9/hBsNS1hS6BG0DSqmYEDRlCXQrmy50P1oDRKTSegmNbUsA0zDMwRhPJXeCE3vWLPQMvan6X8AgIa1vcR4AkGZkDR4ejJ1UHpsaVI0g2LInpOsNFUud1rhxSV+fzC9Woz2EZkWQuja7/B+jUrgtIMpy9YCW4n4K41YfzRneW5E1KJTe4B2Zq1Q5EHEtj4U3AfEzR5SVY4l7QYQPJdN2as7RKBF0BPZqqH4VgMAMBL8Byxr7y8zCZiDlnOcEKIPmUpgB5Z2ww5RdOiiRiNajUmWda5IG6WbhsyY2fx6m8gLcoJDJFkH219M3We1+cnda93pfycZpIJEL/s/wSYADmOAwAQgdpBAAAAABJRU5ErkJggg==",Oc=()=>W("header",{class:Be.header,children:[W("div",{class:Be.nav,children:[W("img",{class:Be.logo,src:Ic}),W("nav",{children:[W(Cr,{activeClassName:Be.active,href:"/",children:"Home"}),W(Cr,{activeClassName:Be.active,href:"/api",children:"API Docs"})]})]}),W("div",{class:Be.github,children:W("a",{href:"https://www.github.com/JamesLMilner/terra-draw",children:W("img",{src:Dc})})})]}),Ac="_home_ko5gx_1",Bc="_map_ko5gx_7",Fc="_tab_ko5gx_14",Rc="_tabActive_ko5gx_15",Zc="_tabButtons_ko5gx_24",jc="_buttons_ko5gx_33",Nc="_expanded_ko5gx_44",Wc="_collapsed_ko5gx_50",Uc="_collapse_ko5gx_50",Vc="_tabs_ko5gx_65",Hc="_tabsHidden_ko5gx_74",Ft={home:Ac,map:Bc,tab:Fc,tabActive:Rc,tabButtons:Zc,buttons:jc,expanded:Nc,collapsed:Wc,collapse:Uc,tabs:Vc,tabsHidden:Hc};var Ai,vt,cr,gs,Ti=0,Oa=[],un=[],ms=J.__b,ys=J.__r,vs=J.diffed,ws=J.__c,xs=J.unmount;function Sn(n,e){J.__h&&J.__h(vt,n,Ti||e),Ti=0;var i=vt.__H||(vt.__H={__:[],__h:[]});return n>=i.__.length&&i.__.push({__V:un}),i.__[n]}function we(n){return Ti=1,Aa(Ba,n)}function Aa(n,e,i){var o=Sn(Ai++,2);if(o.t=n,!o.__c&&(o.__=[Ba(void 0,e),function(l){var h=o.__N?o.__N[0]:o.__[0],u=o.t(h,l);h!==u&&(o.__N=[u,o.__[1]],o.__c.setState({}))}],o.__c=vt,!vt.u)){vt.u=!0;var s=vt.shouldComponentUpdate;vt.shouldComponentUpdate=function(l,h,u){if(!o.__c.__H)return!0;var d=o.__c.__H.__.filter(function(p){return p.__c});if(d.every(function(p){return!p.__N}))return!s||s.call(this,l,h,u);var _=!1;return d.forEach(function(p){if(p.__N){var m=p.__[0];p.__=p.__N,p.__N=void 0,m!==p.__[0]&&(_=!0)}}),!(!_&&o.__c.props===l)&&(!s||s.call(this,l,h,u))}}return o.__N||o.__}function bs(n,e){var i=Sn(Ai++,3);!J.__s&&Zr(i.__H,e)&&(i.__=n,i.i=e,vt.__H.__h.push(i))}function Yc(n,e){var i=Sn(Ai++,4);!J.__s&&Zr(i.__H,e)&&(i.__=n,i.i=e,vt.__h.push(i))}function Xc(n){return Ti=5,Le(function(){return{current:n}},[])}function Le(n,e){var i=Sn(Ai++,7);return Zr(i.__H,e)?(i.__V=n(),i.i=e,i.__h=n,i.__V):i.__}function Ke(n,e){return Ti=8,Le(function(){return n},e)}function Gc(){for(var n;n=Oa.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(dn),n.__H.__h.forEach(kr),n.__H.__h=[]}catch(e){n.__H.__h=[],J.__e(e,n.__v)}}J.__b=function(n){vt=null,ms&&ms(n)},J.__r=function(n){ys&&ys(n),Ai=0;var e=(vt=n.__c).__H;e&&(cr===vt?(e.__h=[],vt.__h=[],e.__.forEach(function(i){i.__N&&(i.__=i.__N),i.__V=un,i.__N=i.i=void 0})):(e.__h.forEach(dn),e.__h.forEach(kr),e.__h=[])),cr=vt},J.diffed=function(n){vs&&vs(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Oa.push(e)!==1&&gs===J.requestAnimationFrame||((gs=J.requestAnimationFrame)||qc)(Gc)),e.__H.__.forEach(function(i){i.i&&(i.__H=i.i),i.__V!==un&&(i.__=i.__V),i.i=void 0,i.__V=un})),cr=vt=null},J.__c=function(n,e){e.some(function(i){try{i.__h.forEach(dn),i.__h=i.__h.filter(function(o){return!o.__||kr(o)})}catch(o){e.some(function(s){s.__h&&(s.__h=[])}),e=[],J.__e(o,i.__v)}}),ws&&ws(n,e)},J.unmount=function(n){xs&&xs(n);var e,i=n.__c;i&&i.__H&&(i.__H.__.forEach(function(o){try{dn(o)}catch(s){e=s}}),i.__H=void 0,e&&J.__e(e,i.__v))};var Ps=typeof requestAnimationFrame=="function";function qc(n){var e,i=function(){clearTimeout(o),Ps&&cancelAnimationFrame(e),setTimeout(n)},o=setTimeout(i,100);Ps&&(e=requestAnimationFrame(i))}function dn(n){var e=vt,i=n.__c;typeof i=="function"&&(n.__c=void 0,i()),vt=e}function kr(n){var e=vt;n.__c=n.__(),vt=e}function Zr(n,e){return!n||n.length!==e.length||e.some(function(i,o){return i!==n[o]})}function Ba(n,e){return typeof e=="function"?e(n):e}function dt(){return dt=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(n[o]=i[o])}return n},dt.apply(this,arguments)}function xt(n,e=9){const i=Math.pow(10,e);return Math.round(n*i)/i}const Gt=(n,e)=>{const{x:i,y:o}=n,{x:s,y:l}=e,h=s-i,u=l-o;return Math.sqrt(u*u+h*h)};class Fe{constructor({name:e,callback:i,unregister:o,register:s}){this.name=void 0,this.callback=void 0,this.registered=!1,this.register=void 0,this.unregister=void 0,this.name=e,this.register=()=>{this.registered||(this.registered=!0,s(i))},this.unregister=()=>{this.register&&(this.registered=!1,o(i))},this.callback=i}}class Kc{constructor(e){this._minPixelDragDistance=void 0,this._minPixelDragDistanceDrawing=void 0,this._minPixelDragDistanceSelecting=void 0,this._lastDrawEvent=void 0,this._coordinatePrecision=void 0,this._heldKeys=new Set,this._listeners=[],this._dragState="not-dragging",this._currentModeCallbacks=void 0,this._minPixelDragDistance=typeof e.minPixelDragDistance=="number"?e.minPixelDragDistance:1,this._minPixelDragDistanceSelecting=typeof e.minPixelDragDistanceSelecting=="number"?e.minPixelDragDistanceSelecting:1,this._minPixelDragDistanceDrawing=typeof e.minPixelDragDistanceDrawing=="number"?e.minPixelDragDistanceDrawing:8,this._coordinatePrecision=typeof e.coordinatePrecision=="number"?e.coordinatePrecision:9}getButton(e){return e.button===-1?"neither":e.button===0?"left":e.button===1?"middle":e.button===2?"right":"neither"}getMapElementXYPosition(e){const i=this.getMapEventElement(),{left:o,top:s}=i.getBoundingClientRect();return{containerX:e.clientX-o,containerY:e.clientY-s}}getDrawEventFromEvent(e){const i=this.getLngLatFromEvent(e);if(!i)return null;const{lng:o,lat:s}=i,{containerX:l,containerY:h}=this.getMapElementXYPosition(e),u=this.getButton(e),d=Array.from(this._heldKeys);return{lng:xt(o,this._coordinatePrecision),lat:xt(s,this._coordinatePrecision),containerX:l,containerY:h,button:u,heldKeys:d}}register(e){this._currentModeCallbacks=e,this._listeners=this.getAdapterListeners(),this._listeners.forEach(i=>{i.register()})}getCoordinatePrecision(){return this._coordinatePrecision}getAdapterListeners(){return[new Fe({name:"pointerdown",callback:e=>{if(!this._currentModeCallbacks||!e.isPrimary)return;const i=this.getDrawEventFromEvent(e);i&&(this._dragState="pre-dragging",this._lastDrawEvent=i)},register:e=>{this.getMapEventElement().addEventListener("pointerdown",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointerdown",e)}}),new Fe({name:"pointermove",callback:e=>{if(!this._currentModeCallbacks||!e.isPrimary)return;e.preventDefault();const i=this.getDrawEventFromEvent(e);if(i)if(this._dragState==="not-dragging")this._currentModeCallbacks.onMouseMove(i),this._lastDrawEvent=i;else if(this._dragState==="pre-dragging"){if(!this._lastDrawEvent)return;const o={x:this._lastDrawEvent.containerX,y:this._lastDrawEvent.containerY},s={x:i.containerX,y:i.containerY},l=this._currentModeCallbacks.getState(),h=Gt(o,s);let u=!1;if(u=l==="drawing"?h<this._minPixelDragDistanceDrawing:l==="selecting"?h<this._minPixelDragDistanceSelecting:h<this._minPixelDragDistance,u)return;this._dragState="dragging",this._currentModeCallbacks.onDragStart(i,d=>{this.setDraggability.bind(this)(d)})}else this._dragState==="dragging"&&this._currentModeCallbacks.onDrag(i,o=>{this.setDraggability.bind(this)(o)})},register:e=>{this.getMapEventElement().addEventListener("pointermove",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointermove",e)}}),new Fe({name:"contextmenu",callback:e=>{this._currentModeCallbacks&&e.preventDefault()},register:e=>{this.getMapEventElement().addEventListener("contextmenu",e)},unregister:e=>{this.getMapEventElement().removeEventListener("contextmenu",e)}}),new Fe({name:"pointerup",callback:e=>{if(!this._currentModeCallbacks||e.target!==this.getMapEventElement()||!e.isPrimary)return;const i=this.getDrawEventFromEvent(e);i&&(this._dragState==="dragging"?this._currentModeCallbacks.onDragEnd(i,o=>{this.setDraggability.bind(this)(o)}):this._dragState!=="not-dragging"&&this._dragState!=="pre-dragging"||this._currentModeCallbacks.onClick(i),this._dragState="not-dragging",this.setDraggability(!0))},register:e=>{this.getMapEventElement().addEventListener("pointerup",e)},unregister:e=>{this.getMapEventElement().removeEventListener("pointerup",e)}}),new Fe({name:"keyup",callback:e=>{this._currentModeCallbacks&&(this._heldKeys.delete(e.key),this._currentModeCallbacks.onKeyUp({key:e.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>e.preventDefault()}))},register:e=>{this.getMapEventElement().addEventListener("keyup",e)},unregister:e=>{this.getMapEventElement().removeEventListener("keyup",e)}}),new Fe({name:"keydown",callback:e=>{this._currentModeCallbacks&&(this._heldKeys.add(e.key),this._currentModeCallbacks.onKeyDown({key:e.key,heldKeys:Array.from(this._heldKeys),preventDefault:()=>e.preventDefault()}))},register:e=>{this.getMapEventElement().addEventListener("keydown",e)},unregister:e=>{this.getMapEventElement().removeEventListener("keydown",e)}})]}unregister(){this._listeners.forEach(e=>{e.unregister()}),this.clear()}}class $c extends Kc{constructor(e){super(e),this._lib=void 0,this._map=void 0,this._panes={},this._container=void 0,this._layers={},this._lib=e.lib,this._map=e.map,this._container=this._map.getContainer()}createPaneStyleSheet(e,i){const o=document.createElement("style");return o.innerHTML=`.leaflet-${e}-pane {z-index: ${i+600};}`,document.getElementsByTagName("head")[0].appendChild(o),this._map.createPane(e),o}clearPanes(){Object.values(this._panes).forEach(e=>{e&&e.remove()}),this._panes={}}clearLayers(){Object.values(this._layers).forEach(e=>{this._map.removeLayer(e)}),this._layers={}}styleGeoJSONLayer(e){return{pointToLayer:(i,o)=>{if(!i.properties)throw new Error("Feature has no properties");if(typeof i.properties.mode!="string")throw new Error("Feature mode is not a string");const s=(0,e[i.properties.mode])(i),l=String(s.zIndex);return this._panes[l]||(this._panes[l]=this.createPaneStyleSheet(l,s.zIndex)),this._lib.circleMarker(o,{radius:s.pointWidth,stroke:s.pointOutlineWidth||!1,color:s.pointOutlineColor,weight:s.pointOutlineWidth,fillOpacity:.8,fillColor:s.pointColor,pane:l,interactive:!1})},style:i=>{if(!i||!i.properties)return{};const o=i,s=(0,e[o.properties.mode])(o),l=String(s.zIndex);return this._panes[l]||(this._panes[l]=this.createPaneStyleSheet(l,s.zIndex)),o.geometry.type==="LineString"?{interactive:!1,color:s.lineStringColor,weight:s.lineStringWidth,pane:l}:o.geometry.type==="Polygon"?{interactive:!1,fillOpacity:s.polygonFillOpacity,fillColor:s.polygonFillColor,weight:s.polygonOutlineWidth,stroke:!0,color:s.polygonFillColor,pane:l}:{}}}}getLngLatFromEvent(e){const{containerX:i,containerY:o}=this.getMapElementXYPosition(e),s={x:i,y:o};if(s.x===null||isNaN(s.x)||s.y===null||isNaN(s.y))return null;const l=this._map.containerPointToLatLng(s);return l.lng===null||isNaN(l.lng)||l.lat===null||isNaN(l.lat)?null:{lng:l.lng,lat:l.lat}}getMapEventElement(){return this._container}setDraggability(e){e?this._map.dragging.enable():this._map.dragging.disable()}project(e,i){const{x:o,y:s}=this._map.latLngToContainerPoint({lng:e,lat:i});return{x:o,y:s}}unproject(e,i){const{lng:o,lat:s}=this._map.containerPointToLatLng({x:e,y:i});return{lng:o,lat:s}}setCursor(e){e==="unset"?this.getMapEventElement().style.removeProperty("cursor"):this.getMapEventElement().style.cursor=e}setDoubleClickToZoom(e){e?this._map.doubleClickZoom.enable():this._map.doubleClickZoom.disable()}render(e,i){e.created.forEach(o=>{this._layers[o.id]=this._lib.geoJSON(o,this.styleGeoJSONLayer(i)),this._map.addLayer(this._layers[o.id])}),e.deletedIds.forEach(o=>{this._map.removeLayer(this._layers[o])}),e.updated.forEach(o=>{this._map.removeLayer(this._layers[o.id]),this._layers[o.id]=this._lib.geoJSON(o,this.styleGeoJSONLayer(i)),this._map.addLayer(this._layers[o.id])})}clear(){this._currentModeCallbacks&&(this._currentModeCallbacks.onClear(),this.clearLayers(),this.clearPanes())}register(e){super.register(e),this._currentModeCallbacks&&this._currentModeCallbacks.onReady&&this._currentModeCallbacks.onReady()}getCoordinatePrecision(){return super.getCoordinatePrecision()}unregister(){return super.unregister()}}let Jc=0;const ue=typeof navigator<"u"&&navigator.userAgent!==void 0?navigator.userAgent.toLowerCase():"";ue.includes("firefox"),ue.includes("safari")&&!ue.includes("chrom")&&(ue.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(ue)),ue.includes("webkit")&&ue.includes("edge"),ue.includes("macintosh");typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope;(function(){let n=!1;try{const e=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,e),window.removeEventListener("_",null,e)}catch{}})();var Qc=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}},Fa=class{constructor(e){this.type=e,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};function Cs(){}function Ra(n){for(const e in n)delete n[e]}var tu=class extends Qc{constructor(n){super(),this.eventTarget_=n,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(n,e){if(!n||!e)return;const i=this.listeners_||(this.listeners_={}),o=i[n]||(i[n]=[]);o.includes(e)||o.push(e)}dispatchEvent(n){const e=typeof n=="string",i=e?n:n.type,o=this.listeners_&&this.listeners_[i];if(!o)return;const s=e?new Fa(n):n;s.target||(s.target=this.eventTarget_||this);const l=this.dispatching_||(this.dispatching_={}),h=this.pendingRemovals_||(this.pendingRemovals_={});let u;i in l||(l[i]=0,h[i]=0),++l[i];for(let d=0,_=o.length;d<_;++d)if(u="handleEvent"in o[d]?o[d].handleEvent(s):o[d].call(this,s),u===!1||s.propagationStopped){u=!1;break}if(--l[i]==0){let d=h[i];for(delete h[i];d--;)this.removeEventListener(i,Cs);delete l[i]}return u}disposeInternal(){this.listeners_&&Ra(this.listeners_)}getListeners(n){return this.listeners_&&this.listeners_[n]||void 0}hasListener(n){return!!this.listeners_&&(n?n in this.listeners_:Object.keys(this.listeners_).length>0)}removeEventListener(n,e){if(!this.listeners_)return;const i=this.listeners_[n];if(!i)return;const o=i.indexOf(e);o!==-1&&(this.pendingRemovals_&&n in this.pendingRemovals_?(i[o]=Cs,++this.pendingRemovals_[n]):(i.splice(o,1),i.length===0&&delete this.listeners_[n]))}},eu="change";function Lr(n,e,i,o,s){if(s){const h=i;i=function(){n.removeEventListener(e,i),h.apply(this,arguments)}}const l={target:n,type:e,listener:i};return n.addEventListener(e,i),l}function Ms(n,e,i,o){return Lr(n,e,i,o,!0)}function ks(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),Ra(n))}var iu=class extends tu{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(eu)}getRevision(){return this.revision_}onInternal(n,e){if(Array.isArray(n)){const i=n.length,o=new Array(i);for(let s=0;s<i;++s)o[s]=Lr(this,n[s],e);return o}return Lr(this,n,e)}onceInternal(n,e){let i;if(Array.isArray(n)){const o=n.length;i=new Array(o);for(let s=0;s<o;++s)i[s]=Ms(this,n[s],e)}else i=Ms(this,n,e);return e.ol_key=i,i}unInternal(n,e){const i=e.ol_key;if(i)(function(o){if(Array.isArray(o))for(let s=0,l=o.length;s<l;++s)ks(o[s]);else ks(o)})(i);else if(Array.isArray(n))for(let o=0,s=n.length;o<s;++o)this.removeEventListener(n[o],e);else this.removeEventListener(n,e)}};class Ls extends Fa{constructor(e,i,o){super(e),this.key=i,this.oldValue=o}}new class extends iu{constructor(n){super(),this.ol_uid||(this.ol_uid=String(++Jc)),this.values_=null,n!==void 0&&this.setProperties(n)}get(n){let e;return this.values_&&this.values_.hasOwnProperty(n)&&(e=this.values_[n]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(n,e){let i;i=`change:${n}`,this.hasListener(i)&&this.dispatchEvent(new Ls(i,n,e)),i="propertychange",this.hasListener(i)&&this.dispatchEvent(new Ls(i,n,e))}addChangeListener(n,e){this.addEventListener(`change:${n}`,e)}removeChangeListener(n,e){this.removeEventListener(`change:${n}`,e)}set(n,e,i){const o=this.values_||(this.values_={});if(i)o[n]=e;else{const s=o[n];o[n]=e,s!==e&&this.notify(n,s)}}setProperties(n,e){for(const i in n)this.set(i,n[i],e)}applyProperties(n){n.values_&&Object.assign(this.values_||(this.values_={}),n.values_)}unset(n,e){if(this.values_&&n in this.values_){const i=this.values_[n];delete this.values_[n],function(o){let s;for(s in o)return!1;return!s}(this.values_)&&(this.values_=null),e||this.notify(n,i)}}};const nu={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};var Za=class{constructor(n){this.code_=n.code,this.units_=n.units,this.extent_=n.extent!==void 0?n.extent:null,this.worldExtent_=n.worldExtent!==void 0?n.worldExtent:null,this.axisOrientation_=n.axisOrientation!==void 0?n.axisOrientation:"enu",this.global_=n.global!==void 0&&n.global,this.canWrapX_=!(!this.global_||!this.extent_),this.getPointResolutionFunc_=n.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=n.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||nu[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(n){this.global_=n,this.canWrapX_=!(!n||!this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(n){this.defaultTileGrid_=n}setExtent(n){this.extent_=n,this.canWrapX_=!(!this.global_||!n)}setWorldExtent(n){this.worldExtent_=n}setGetPointResolution(n){this.getPointResolutionFunc_=n}getPointResolutionFunc(){return this.getPointResolutionFunc_}};const zi=6378137,Ye=Math.PI*zi,ru=[-Ye,-Ye,Ye,Ye],ou=[-180,-85,180,85],rn=zi*Math.log(Math.tan(Math.PI/2));class Re extends Za{constructor(e){super({code:e,units:"m",extent:ru,global:!0,worldExtent:ou,getPointResolution:function(i,o){return i/Math.cosh(o[1]/zi)}})}}const Ss=[new Re("EPSG:3857"),new Re("EPSG:102100"),new Re("EPSG:102113"),new Re("EPSG:900913"),new Re("http://www.opengis.net/def/crs/EPSG/0/3857"),new Re("http://www.opengis.net/gml/srs/epsg.xml#3857")],Es=[-180,-90,180,90],su=6378137*Math.PI/180;class xe extends Za{constructor(e,i){super({code:e,units:"degrees",extent:Es,axisOrientation:i,global:!0,metersPerUnit:su,worldExtent:Es})}}const Ts=[new xe("CRS:84"),new xe("EPSG:4326","neu"),new xe("urn:ogc:def:crs:OGC:1.3:CRS84"),new xe("urn:ogc:def:crs:OGC:2:84"),new xe("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new xe("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new xe("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ur={};function xn(n,e,i){const o=n.getCode(),s=e.getCode();o in ur||(ur[o]={}),ur[o][s]=i}function ja(n,e){if(e!==void 0)for(let i=0,o=n.length;i<o;++i)e[i]=n[i];else e=n.slice();return e}function au(n){n.getCode(),xn(n,n,ja)}function zs(n){(function(e){e.forEach(au)})(n),n.forEach(function(e){n.forEach(function(i){e!==i&&xn(e,i,ja)})})}var Is,Ds,Os,pt;zs(Ss),zs(Ts),Is=Ss,Ds=function(n,e,i){const o=n.length;i=i>1?i:2,e===void 0&&(e=i>2?n.slice():new Array(o));for(let s=0;s<o;s+=i){e[s]=Ye*n[s]/180;let l=zi*Math.log(Math.tan(Math.PI*(+n[s+1]+90)/360));l>rn?l=rn:l<-rn&&(l=-rn),e[s+1]=l}return e},Os=function(n,e,i){const o=n.length;i=i>1?i:2,e===void 0&&(e=i>2?n.slice():new Array(o));for(let s=0;s<o;s+=i)e[s]=180*n[s]/Ye,e[s+1]=360*Math.atan(Math.exp(n[s+1]/zi))/Math.PI-90;return e},Ts.forEach(function(n){Is.forEach(function(e){xn(n,e,Ds),xn(e,n,Os)})});(function(n){n.Commit="commit",n.Provisional="provisional",n.Finish="finish"})(pt||(pt={}));const Sr="selected",Li="midPoint",As="closingPoint";function dr(n){return!!(n&&typeof n=="object"&&n!==null&&!Array.isArray(n))}function Bs(n){if(!function(e){return typeof e=="number"&&!isNaN(new Date(e).valueOf())}(n))throw new Error("updatedAt and createdAt are not valid timestamps");return!0}var ei;(function(n){n.Drawing="drawing",n.Select="select",n.Static="static",n.Render="render"})(ei||(ei={}));class fe{get state(){return this._state}set state(e){throw new Error("Please use the modes lifecycle methods")}get styles(){return this._styles}set styles(e){if(typeof e!="object")throw new Error("Styling must be an object");this.onStyleChange([],"styling"),this._styles=e}registerBehaviors(e){}constructor(e){this._state=void 0,this._styles=void 0,this.behaviors=[],this.validate=void 0,this.pointerDistance=void 0,this.coordinatePrecision=void 0,this.onStyleChange=void 0,this.store=void 0,this.setDoubleClickToZoom=void 0,this.unproject=void 0,this.project=void 0,this.setCursor=void 0,this.projection=void 0,this.type=ei.Drawing,this.mode="base",this._state="unregistered",this._styles=e&&e.styles?dt({},e.styles):{},this.pointerDistance=e&&e.pointerDistance||40,this.validate=e&&e.validation,this.projection=e&&e.projection||"web-mercator"}setDrawing(){if(this._state!=="started")throw new Error("Mode must be unregistered or stopped to start");this._state="drawing"}setStarted(){if(this._state!=="stopped"&&this._state!=="registered"&&this._state!=="drawing"&&this._state!=="selecting")throw new Error("Mode must be unregistered or stopped to start");this._state="started",this.setDoubleClickToZoom(!1)}setStopped(){if(this._state!=="started")throw new Error("Mode must be started to be stopped");this._state="stopped",this.setDoubleClickToZoom(!0)}register(e){if(this._state!=="unregistered")throw new Error("Can not register unless mode is unregistered");this._state="registered",this.store=e.store,this.store.registerOnChange(e.onChange),this.setDoubleClickToZoom=e.setDoubleClickToZoom,this.project=e.project,this.unproject=e.unproject,this.onSelect=e.onSelect,this.onDeselect=e.onDeselect,this.setCursor=e.setCursor,this.onStyleChange=e.onChange,this.onFinish=e.onFinish,this.coordinatePrecision=e.coordinatePrecision,this.registerBehaviors({mode:e.mode,store:this.store,project:this.project,unproject:this.unproject,pointerDistance:this.pointerDistance,coordinatePrecision:e.coordinatePrecision,projection:this.projection})}validateFeature(e){if(this._state==="unregistered")throw new Error("Mode must be registered");const i=function(o,s){let l;if(dr(o))if(o.id==null)l="Feature has no id";else if(typeof o.id!="string"&&typeof o.id!="number")l="Feature must be string or number as per GeoJSON spec";else if(s(o.id))if(dr(o.geometry))if(dr(o.properties))if(typeof o.geometry.type=="string"&&["Polygon","LineString","Point"].includes(o.geometry.type))if(Array.isArray(o.geometry.coordinates)){if(!o.properties.mode||typeof o.properties.mode!="string")throw new Error("Feature does not have a valid mode property")}else l="Feature coordinates is not an array";else l="Feature is not Point, LineString or Polygon";else l="Feature has no properties";else l="Feature has no geometry";else l="Feature must match the id strategy (default is UUID4)";else l="Feature is not object";if(l)throw new Error(l);return!0}(e,this.store.idStrategy.isValidId);return this.validate?this.validate(e,{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Provisional}):i}onFinish(e,i){}onDeselect(e){}onSelect(e){}onKeyDown(e){}onKeyUp(e){}onMouseMove(e){}onClick(e){}onDragStart(e,i){}onDrag(e,i){}onDragEnd(e,i){}getHexColorStylingValue(e,i,o){return this.getStylingValue(e,i,o)}getNumericStylingValue(e,i,o){return this.getStylingValue(e,i,o)}getStylingValue(e,i,o){return e===void 0?i:typeof e=="function"?e(o):e}}class lu extends fe{constructor(...e){super(...e),this.type=ei.Select}}function de(n,e){const i=_=>_*Math.PI/180,o=i(n[1]),s=i(n[0]),l=i(e[1]),h=l-o,u=i(e[0])-s,d=Math.sin(h/2)*Math.sin(h/2)+Math.cos(o)*Math.cos(l)*Math.sin(u/2)*Math.sin(u/2);return 2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d))*6371e3/1e3}const jr=63710088e-1;function kt(n){return n%360*Math.PI/180}function Na(n){return n/(jr/1e3)}function ii(n){return n%(2*Math.PI)*180/Math.PI}const Fs=57.29577951308232,Rs=.017453292519943295,bn=6378137,Pt=(n,e)=>({x:n===0?0:n*Rs*bn,y:e===0?0:Math.log(Math.tan(Math.PI/4+e*Rs/2))*bn}),Me=(n,e)=>({lng:n===0?0:Fs*(n/bn),lat:e===0?0:(2*Math.atan(Math.exp(e/bn))-Math.PI/2)*Fs});function hu(n,e,i){const o=kt(n[0]),s=kt(n[1]),l=kt(i),h=Na(e),u=Math.asin(Math.sin(s)*Math.cos(h)+Math.cos(s)*Math.sin(h)*Math.cos(l));return[ii(o+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(s),Math.cos(h)-Math.sin(s)*Math.sin(u))),ii(u)]}function Zs(n){const{center:e,radiusKilometers:i,coordinatePrecision:o}=n,s=n.steps?n.steps:64,l=[];for(let h=0;h<s;h++){const u=hu(e,i,-360*h/s);l.push([xt(u[0],o),xt(u[1],o)])}return l.push(l[0]),{type:"Feature",geometry:{type:"Polygon",coordinates:[l]},properties:{}}}function Nr(n){const e={epsilon:0};let i;if(n.geometry.type==="Polygon")i=n.geometry.coordinates;else{if(n.geometry.type!=="LineString")throw new Error("Self intersects only accepts Polygons and LineStrings");i=[n.geometry.coordinates]}const o=[];for(let h=0;h<i.length;h++)for(let u=0;u<i[h].length-1;u++)for(let d=0;d<i.length;d++)for(let _=0;_<i[d].length-1;_++)l(h,u,d,_);return o.length>0;function s(h){return h<0-e.epsilon||h>1+e.epsilon}function l(h,u,d,_){const p=i[h][u],m=i[h][u+1],v=i[d][_],x=i[d][_+1],P=function(A,w,M,k){if(on(A,M)||on(A,k)||on(w,M)||on(k,M))return null;const F=A[0],I=A[1],B=w[0],z=w[1],j=M[0],H=M[1],V=k[0],G=k[1],q=(F-B)*(H-G)-(I-z)*(j-V);return q===0?null:[((F*z-I*B)*(j-V)-(F-B)*(j*G-H*V))/q,((F*z-I*B)*(H-G)-(I-z)*(j*G-H*V))/q]}(p,m,v,x);if(P===null)return;let T,O;T=m[0]!==p[0]?(P[0]-p[0])/(m[0]-p[0]):(P[1]-p[1])/(m[1]-p[1]),O=x[0]!==v[0]?(P[0]-v[0])/(x[0]-v[0]):(P[1]-v[1])/(x[1]-v[1]),s(T)||s(O)||(P.toString(),o.push(P))}}function on(n,e){return n[0]===e[0]&&n[1]===e[1]}function Wr(n,e){return n.length===2&&typeof n[0]=="number"&&typeof n[1]=="number"&&n[0]!==1/0&&n[1]!==1/0&&(o=n[0])>=-180&&o<=180&&(i=n[1])>=-90&&i<=90&&js(n[0])<=e&&js(n[1])<=e;var i,o}function js(n){let e=1,i=0;for(;Math.round(n*e)/e!==n;)e*=10,i++;return i}function Ur(n,e){return n.geometry.type==="Polygon"&&n.geometry.coordinates.length===1&&n.geometry.coordinates[0].length>=4&&n.geometry.coordinates[0].every(s=>Wr(s,e))&&(i=n.geometry.coordinates[0][0])[0]===(o=n.geometry.coordinates[0][n.geometry.coordinates[0].length-1])[0]&&i[1]===o[1];var i,o}function Wa(n,e){return Ur(n,e)&&!Nr(n)}class cu extends fe{constructor(e){var i;super(e),this.mode="circle",this.center=void 0,this.clickCount=0,this.currentCircleId=void 0,this.keyEvents=void 0,this.cursors=void 0,this.startingRadiusKilometers=1e-5;const o={start:"crosshair"};if(this.cursors=e&&e.cursors?dt({},o,e.cursors):o,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const s={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?dt({},s,e.keyEvents):s}this.startingRadiusKilometers=(i=e==null?void 0:e.startingRadiusKilometers)!=null?i:1e-5,this.validate=e==null?void 0:e.validation}close(){if(this.currentCircleId===void 0)return;const e=this.currentCircleId;if(this.validate&&e){const i=this.store.getGeometryCopy(e);if(!this.validate({type:"Feature",id:e,geometry:i,properties:{}},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Finish}))return}this.center=void 0,this.currentCircleId=void 0,this.clickCount=0,this.state==="drawing"&&this.setStarted(),this.onFinish(e,{mode:this.mode,action:"draw"})}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onClick(e){if(this.clickCount===0){this.center=[e.lng,e.lat];const i=Zs({center:this.center,radiusKilometers:this.startingRadiusKilometers,coordinatePrecision:this.coordinatePrecision}),[o]=this.store.create([{geometry:i.geometry,properties:{mode:this.mode,radiusKilometers:this.startingRadiusKilometers}}]);this.currentCircleId=o,this.clickCount++,this.setDrawing()}else this.clickCount===1&&this.center&&this.currentCircleId!==void 0&&this.updateCircle(e),this.close()}onMouseMove(e){this.updateCircle(e)}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel?this.cleanUp():e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){const e=this.currentCircleId;this.center=void 0,this.currentCircleId=void 0,this.clickCount=0,this.state==="drawing"&&this.setStarted();try{e!==void 0&&this.store.delete([e])}catch{}}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});return e.type==="Feature"&&e.geometry.type==="Polygon"&&e.properties.mode===this.mode&&(i.polygonFillColor=this.getHexColorStylingValue(this.styles.fillColor,i.polygonFillColor,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.outlineColor,i.polygonOutlineColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.outlineWidth,i.polygonOutlineWidth,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.fillOpacity,i.polygonFillOpacity,e),i.zIndex=10),i}validateFeature(e){return!!super.validateFeature(e)&&e.properties.mode===this.mode&&Wa(e,this.coordinatePrecision)}updateCircle(e){if(this.clickCount===1&&this.center&&this.currentCircleId){const i=de(this.center,[e.lng,e.lat]);let o;if(this.projection==="web-mercator"){const s=function(l,h){const u=1e3*de(l,h);if(u===0)return 1;const{x:d,y:_}=Pt(l[0],l[1]),{x:p,y:m}=Pt(h[0],h[1]);return Math.sqrt(Math.pow(p-d,2)+Math.pow(m-_,2))/u}(this.center,[e.lng,e.lat]);o=function(l){const{center:h,radiusKilometers:u,coordinatePrecision:d}=l,_=l.steps?l.steps:64,p=1e3*u,[m,v]=h,{x,y:P}=Pt(m,v),T=[];for(let O=0;O<_;O++){const A=360*O/_*Math.PI/180,w=p*Math.cos(A),M=p*Math.sin(A),[k,F]=[x+w,P+M],{lng:I,lat:B}=Me(k,F);T.push([xt(I,d),xt(B,d)])}return T.push(T[0]),{type:"Feature",geometry:{type:"Polygon",coordinates:[T]},properties:{}}}({center:this.center,radiusKilometers:i*s,coordinatePrecision:this.coordinatePrecision})}else{if(this.projection!=="globe")throw new Error("Invalid projection");o=Zs({center:this.center,radiusKilometers:i,coordinatePrecision:this.coordinatePrecision})}if(this.validate&&!this.validate({type:"Feature",id:this.currentCircleId,geometry:o.geometry,properties:{radiusKilometers:i}},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Provisional}))return;this.store.updateGeometry([{id:this.currentCircleId,geometry:o.geometry}]),this.store.updateProperty([{id:this.currentCircleId,property:"radiusKilometers",value:i}])}}}class uu extends fe{constructor(e){super(e),this.mode="freehand",this.startingClick=!1,this.currentId=void 0,this.closingPointId=void 0,this.minDistance=void 0,this.keyEvents=void 0,this.cursors=void 0,this.preventPointsNearClose=void 0;const i={start:"crosshair",close:"pointer"};if(this.cursors=e&&e.cursors?dt({},i,e.cursors):i,this.preventPointsNearClose=e&&e.preventPointsNearClose||!0,this.minDistance=e&&e.minDistance||20,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const o={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?dt({},o,e.keyEvents):o}this.validate=e==null?void 0:e.validation}close(){if(this.currentId===void 0)return;const e=this.currentId;if(this.validate&&e){const i=this.store.getGeometryCopy(e);if(!this.validate({type:"Feature",id:e,geometry:i,properties:{}},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Finish}))return}this.closingPointId&&this.store.delete([this.closingPointId]),this.startingClick=!1,this.currentId=void 0,this.closingPointId=void 0,this.state==="drawing"&&this.setStarted(),this.onFinish(e,{mode:this.mode,action:"draw"})}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(e){if(this.currentId===void 0||this.startingClick===!1)return;const i=this.store.getGeometryCopy(this.currentId),o=i.coordinates[0].length-2,[s,l]=i.coordinates[0][o],{x:h,y:u}=this.project(s,l),d=Gt({x:h,y:u},{x:e.containerX,y:e.containerY}),[_,p]=i.coordinates[0][0],{x:m,y:v}=this.project(_,p);if(Gt({x:m,y:v},{x:e.containerX,y:e.containerY})<this.pointerDistance){if(this.setCursor(this.cursors.close),this.preventPointsNearClose)return}else this.setCursor(this.cursors.start);if(d<this.minDistance)return;i.coordinates[0].pop();const x={type:"Polygon",coordinates:[[...i.coordinates[0],[e.lng,e.lat],i.coordinates[0][0]]]};this.validate&&!this.validate({type:"Feature",id:this.currentId,geometry:x,properties:{}},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Provisional})||this.store.updateGeometry([{id:this.currentId,geometry:x}])}onClick(e){if(this.startingClick===!1){const[i,o]=this.store.create([{geometry:{type:"Polygon",coordinates:[[[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat]]]},properties:{mode:this.mode}},{geometry:{type:"Point",coordinates:[e.lng,e.lat]},properties:{mode:this.mode}}]);return this.currentId=i,this.closingPointId=o,this.startingClick=!0,void this.setDrawing()}this.close()}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel?this.cleanUp():e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){const e=this.currentId,i=this.closingPointId;this.closingPointId=void 0,this.currentId=void 0,this.startingClick=!1,this.state==="drawing"&&this.setStarted();try{e!==void 0&&this.store.delete([e]),i!==void 0&&this.store.delete([i])}catch{}}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});return e.type==="Feature"&&e.geometry.type==="Polygon"&&e.properties.mode===this.mode?(i.polygonFillColor=this.getHexColorStylingValue(this.styles.fillColor,i.polygonFillColor,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.outlineColor,i.polygonOutlineColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.outlineWidth,i.polygonOutlineWidth,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.fillOpacity,i.polygonFillOpacity,e),i.zIndex=10,i):(e.type==="Feature"&&e.geometry.type==="Point"&&e.properties.mode===this.mode&&(i.pointWidth=this.getNumericStylingValue(this.styles.closingPointWidth,i.pointWidth,e),i.pointColor=this.getHexColorStylingValue(this.styles.closingPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.closingPointOutlineColor,i.pointOutlineColor,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.closingPointOutlineWidth,2,e),i.zIndex=40),i)}validateFeature(e){return!!super.validateFeature(e)&&e.properties.mode===this.mode&&Ur(e,this.coordinatePrecision)}}class It{constructor({store:e,mode:i,project:o,unproject:s,pointerDistance:l,coordinatePrecision:h,projection:u}){this.store=void 0,this.mode=void 0,this.project=void 0,this.unproject=void 0,this.pointerDistance=void 0,this.coordinatePrecision=void 0,this.projection=void 0,this.store=e,this.mode=i,this.project=o,this.unproject=s,this.pointerDistance=l,this.coordinatePrecision=h,this.projection=u}}function Ua({unproject:n,point:e,pointerDistance:i}){const o=i/2,{x:s,y:l}=e;return{type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[[n(s-o,l-o),n(s+o,l-o),n(s+o,l+o),n(s-o,l+o),n(s-o,l-o)].map(h=>[h.lng,h.lat])]}}}class Vr extends It{constructor(e){super(e)}create(e){const{containerX:i,containerY:o}=e;return Ua({unproject:this.unproject,point:{x:i,y:o},pointerDistance:this.pointerDistance})}}class Hr extends It{constructor(e){super(e)}measure(e,i){const{x:o,y:s}=this.project(i[0],i[1]);return Gt({x:o,y:s},{x:e.containerX,y:e.containerY})}}class Va extends It{constructor(e,i,o){super(e),this.config=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.getSnappableCoordinateFirstClick=s=>this.getSnappable(s,l=>!!(l.properties&&l.properties.mode===this.mode)),this.getSnappableCoordinate=(s,l)=>this.getSnappable(s,h=>!!(h.properties&&h.properties.mode===this.mode&&h.id!==l)),this.config=e,this.pixelDistance=i,this.clickBoundingBox=o}getSnappable(e,i){const o=this.clickBoundingBox.create(e),s=this.store.search(o,i),l={coord:void 0,minDist:1/0};return s.forEach(h=>{let u;if(h.geometry.type==="Polygon")u=h.geometry.coordinates[0];else{if(h.geometry.type!=="LineString")return;u=h.geometry.coordinates}u.forEach(d=>{const _=this.pixelDistance.measure(e,d);_<l.minDist&&_<this.pointerDistance&&(l.coord=d,l.minDist=_)})}),l.coord}}function Ns(n,e,i){const o=kt(n[0]),s=kt(n[1]),l=kt(i),h=Na(e),u=Math.asin(Math.sin(s)*Math.cos(h)+Math.cos(s)*Math.sin(h)*Math.cos(l));return[ii(o+Math.atan2(Math.sin(l)*Math.sin(h)*Math.cos(s),Math.cos(h)-Math.sin(s)*Math.sin(u))),ii(u)]}function Ws(n,e){const i=kt(n[0]),o=kt(e[0]),s=kt(n[1]),l=kt(e[1]),h=Math.sin(o-i)*Math.cos(l),u=Math.cos(s)*Math.sin(l)-Math.sin(s)*Math.cos(l)*Math.cos(o-i);return ii(Math.atan2(h,u))}function du({x:n,y:e},{x:i,y:o}){let s=Math.atan2(o-e,i-n);return s*=180/Math.PI,s>180?s-=360:s<-180&&(s+=360),s}function fu(n,e,i){const o=[],s=n.length;let l,h,u,d=0;for(let p=0;p<n.length&&!(e>=d&&p===n.length-1);p++){if(d>e&&o.length===0){if(l=e-d,!l)return o.push(n[p]),o;h=Ws(n[p],n[p-1])-180,u=Ns(n[p],l,h),o.push(u)}if(d>=i)return l=i-d,l?(h=Ws(n[p],n[p-1])-180,u=Ns(n[p],l,h),o.push(u),o):(o.push(n[p]),o);if(d>=e&&o.push(n[p]),p===n.length-1)return o;d+=de(n[p],n[p+1])}if(d<e&&n.length===s)throw new Error("Start position is beyond line");const _=n[n.length-1];return[_,_]}function sn(n){return n*(Math.PI/180)}function Us(n){return n*(180/Math.PI)}class pu extends It{constructor(e){super(e),this.config=void 0,this.config=e}generateInsertionCoordinates(e,i,o){const s=[e,i];let l=0;for(let _=0;_<s.length-1;_++)l+=de(s[0],s[1]);if(l<=o)return s;let h=l/o-1;Number.isInteger(h)||(h=Math.floor(h)+1);const u=[];for(let _=0;_<h;_++){const p=fu(s,o*_,o*(_+1));u.push(p)}const d=[];for(let _=0;_<u.length;_++)d.push(u[_][1]);return this.limitCoordinates(d)}generateInsertionGeodesicCoordinates(e,i,o){const s=de(e,i),l=function(h,u,d){const _=[],p=sn(h[1]),m=sn(h[0]),v=sn(u[1]),x=sn(u[0]);d+=1;const P=2*Math.asin(Math.sqrt(Math.sin((v-p)/2)**2+Math.cos(p)*Math.cos(v)*Math.sin((x-m)/2)**2));if(P===0||isNaN(P))return _;for(let T=0;T<=d;T++){const O=T/d,A=Math.sin((1-O)*P)/Math.sin(P),w=Math.sin(O*P)/Math.sin(P),M=A*Math.cos(p)*Math.cos(m)+w*Math.cos(v)*Math.cos(x),k=A*Math.cos(p)*Math.sin(m)+w*Math.cos(v)*Math.sin(x),F=A*Math.sin(p)+w*Math.sin(v);if(isNaN(M)||isNaN(k)||isNaN(F))continue;const I=Math.atan2(F,Math.sqrt(M**2+k**2)),B=Math.atan2(k,M);isNaN(I)||isNaN(B)||_.push([Us(B),Us(I)])}return _.slice(1,-1)}(e,i,Math.floor(s/o));return this.limitCoordinates(l)}limitCoordinates(e){return e.map(i=>[xt(i[0],this.config.coordinatePrecision),xt(i[1],this.config.coordinatePrecision)])}}function fn(n,e){return n[0]===e[0]&&n[1]===e[1]}class _u extends fe{constructor(e){super(e),this.mode="linestring",this.currentCoordinate=0,this.currentId=void 0,this.closingPointId=void 0,this.keyEvents=void 0,this.snappingEnabled=void 0,this.cursors=void 0,this.mouseMove=!1,this.insertCoordinates=void 0,this.lastCommitedCoordinates=void 0,this.snapping=void 0,this.insertPoint=void 0;const i={start:"crosshair",close:"pointer"};if(this.cursors=e&&e.cursors?dt({},i,e.cursors):i,this.snappingEnabled=!(!e||e.snapping===void 0)&&e.snapping,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const o={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?dt({},o,e.keyEvents):o}this.validate=e==null?void 0:e.validation,this.insertCoordinates=e==null?void 0:e.insertCoordinates}close(){if(this.currentId===void 0)return;const e=this.store.getGeometryCopy(this.currentId);e.coordinates.pop(),this.updateGeometries([...e.coordinates],void 0,pt.Commit);const i=this.currentId;this.closingPointId&&this.store.delete([this.closingPointId]),this.currentCoordinate=0,this.currentId=void 0,this.closingPointId=void 0,this.lastCommitedCoordinates=void 0,this.state==="drawing"&&this.setStarted(),this.onFinish(i,{mode:this.mode,action:"draw"})}updateGeometries(e,i,o){if(!this.currentId)return;const s={type:"LineString",coordinates:e};if(this.validate&&!this.validate({type:"Feature",geometry:s},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:o}))return;const l=[{id:this.currentId,geometry:s}];this.closingPointId&&i&&l.push({id:this.closingPointId,geometry:{type:"Point",coordinates:i}}),o==="commit"&&(this.lastCommitedCoordinates=s.coordinates),this.store.updateGeometry(l)}generateInsertCoordinates(e,i){if(!this.insertCoordinates||!this.lastCommitedCoordinates)throw new Error("Not able to insert coordinates");if(this.insertCoordinates.strategy!=="amount")throw new Error("Strategy does not exist");const o=de(e,i)/(this.insertCoordinates.value+1);let s=[];return this.projection==="globe"?s=this.insertPoint.generateInsertionGeodesicCoordinates(e,i,o):this.projection==="web-mercator"&&(s=this.insertPoint.generateInsertionCoordinates(e,i,o)),s}createLine(e){const[i]=this.store.create([{geometry:{type:"LineString",coordinates:[e,e]},properties:{mode:this.mode}}]);this.lastCommitedCoordinates=[e,e],this.currentId=i,this.currentCoordinate++,this.setDrawing()}firstUpdateToLine(e){if(!this.currentId)return;const i=this.store.getGeometryCopy(this.currentId).coordinates,[o]=this.store.create([{geometry:{type:"Point",coordinates:[...e]},properties:{mode:this.mode}}]);this.closingPointId=o,this.setCursor(this.cursors.close);const s=[...i,e];this.updateGeometries(s,void 0,pt.Commit),this.currentCoordinate++}updateToLine(e,i){if(!this.currentId)return;const o=this.store.getGeometryCopy(this.currentId).coordinates,[s,l]=this.lastCommitedCoordinates?this.lastCommitedCoordinates[this.lastCommitedCoordinates.length-1]:o[o.length-2],{x:h,y:u}=this.project(s,l);if(Gt({x:h,y:u},{x:i.x,y:i.y})<this.pointerDistance)return void this.close();this.setCursor(this.cursors.close);const d=[...o,e];this.updateGeometries(d,o[o.length-1],pt.Commit),this.currentCoordinate++}registerBehaviors(e){this.snapping=new Va(e,new Hr(e),new Vr(e)),this.insertPoint=new pu(e)}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(e){if(this.mouseMove=!0,this.setCursor(this.cursors.start),this.currentId===void 0||this.currentCoordinate===0)return;const i=this.store.getGeometryCopy(this.currentId).coordinates;i.pop();const o=this.snappingEnabled&&this.snapping.getSnappableCoordinate(e,this.currentId)||[e.lng,e.lat];if(this.closingPointId){const[l,h]=i[i.length-1],{x:u,y:d}=this.project(l,h);Gt({x:u,y:d},{x:e.containerX,y:e.containerY})<this.pointerDistance&&this.setCursor(this.cursors.close)}let s=[...i,o];if(this.insertCoordinates&&this.currentId&&this.lastCommitedCoordinates){const l=this.lastCommitedCoordinates[this.lastCommitedCoordinates.length-1],h=o;if(!fn(l,h)){const u=this.generateInsertCoordinates(l,h);s=[...this.lastCommitedCoordinates.slice(0,-1),...u,o]}}this.updateGeometries(s,void 0,pt.Provisional)}onClick(e){this.currentCoordinate>0&&!this.mouseMove&&this.onMouseMove(e),this.mouseMove=!1;const i=this.currentId&&this.snappingEnabled&&this.snapping.getSnappableCoordinate(e,this.currentId)||[e.lng,e.lat];this.currentCoordinate===0?this.createLine(i):this.currentCoordinate===1&&this.currentId?this.firstUpdateToLine(i):this.currentId&&this.updateToLine(i,{x:e.containerX,y:e.containerY})}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel&&this.cleanUp(),e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){const e=this.currentId;this.closingPointId=void 0,this.currentId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted();try{e!==void 0&&this.store.delete([e]),this.closingPointId!==void 0&&this.store.delete([this.closingPointId])}catch{}}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});return e.type==="Feature"&&e.geometry.type==="LineString"&&e.properties.mode===this.mode?(i.lineStringColor=this.getHexColorStylingValue(this.styles.lineStringColor,i.lineStringColor,e),i.lineStringWidth=this.getNumericStylingValue(this.styles.lineStringWidth,i.lineStringWidth,e),i.zIndex=10,i):(e.type==="Feature"&&e.geometry.type==="Point"&&e.properties.mode===this.mode&&(i.pointColor=this.getHexColorStylingValue(this.styles.closingPointColor,i.pointColor,e),i.pointWidth=this.getNumericStylingValue(this.styles.closingPointWidth,i.pointWidth,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.closingPointOutlineColor,"#ffffff",e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.closingPointOutlineWidth,2,e),i.zIndex=40),i)}validateFeature(e){return!!super.validateFeature(e)&&e.geometry.type==="LineString"&&e.properties.mode===this.mode&&e.geometry.coordinates.length>=2}}function gu(n,e){return n.geometry.type==="Point"&&Wr(n.geometry.coordinates,e)}class mu extends fe{constructor(e){super(e),this.mode="point",this.cursors=void 0;const i={create:"crosshair"};this.cursors=e&&e.cursors?dt({},i,e.cursors):i}start(){this.setStarted(),this.setCursor(this.cursors.create)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onClick(e){if(!this.store)throw new Error("Mode must be registered first");const i={type:"Point",coordinates:[e.lng,e.lat]},o={mode:this.mode};if(this.validate&&!this.validate({type:"Feature",geometry:i,properties:o},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Finish}))return;const[s]=this.store.create([{geometry:i,properties:o}]);this.onFinish(s,{mode:this.mode,action:"draw"})}onMouseMove(){}onKeyDown(){}onKeyUp(){}cleanUp(){}onDragStart(){}onDrag(){}onDragEnd(){}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});return e.type==="Feature"&&e.geometry.type==="Point"&&e.properties.mode===this.mode&&(i.pointWidth=this.getNumericStylingValue(this.styles.pointWidth,i.pointWidth,e),i.pointColor=this.getHexColorStylingValue(this.styles.pointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.pointOutlineColor,i.pointOutlineColor,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.pointOutlineWidth,2,e),i.zIndex=30),i}validateFeature(e){return!!super.validateFeature(e)&&e.properties.mode===this.mode&&gu(e,this.coordinatePrecision)}}class yu extends It{constructor(e,i){super(e),this.config=void 0,this.pixelDistance=void 0,this._startEndPoints=[],this.config=e,this.pixelDistance=i}get ids(){return this._startEndPoints.concat()}set ids(e){}create(e,i){if(this.ids.length)throw new Error("Opening and closing points already created");if(e.length<=3)throw new Error("Requires at least 4 coordinates");this._startEndPoints=this.store.create([{geometry:{type:"Point",coordinates:e[0]},properties:{mode:i,[As]:!0}},{geometry:{type:"Point",coordinates:e[e.length-2]},properties:{mode:i,[As]:!0}}])}delete(){this.ids.length&&(this.store.delete(this.ids),this._startEndPoints=[])}update(e){if(this.ids.length!==2)throw new Error("No closing points to update");this.store.updateGeometry([{id:this.ids[0],geometry:{type:"Point",coordinates:e[0]}},{id:this.ids[1],geometry:{type:"Point",coordinates:e[e.length-3]}}])}isClosingPoint(e){const i=this.store.getGeometryCopy(this.ids[0]),o=this.store.getGeometryCopy(this.ids[1]),s=this.pixelDistance.measure(e,i.coordinates),l=this.pixelDistance.measure(e,o.coordinates);return{isClosing:s<this.pointerDistance,isPreviousClosing:l<this.pointerDistance}}}class vu extends fe{constructor(e){super(e),this.mode="polygon",this.currentCoordinate=0,this.currentId=void 0,this.keyEvents=void 0,this.snappingEnabled=void 0,this.snapping=void 0,this.pixelDistance=void 0,this.closingPoints=void 0,this.cursors=void 0,this.mouseMove=!1;const i={start:"crosshair",close:"pointer"};if(this.cursors=e&&e.cursors?dt({},i,e.cursors):i,this.snappingEnabled=!(!e||e.snapping===void 0)&&e.snapping,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const o={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?dt({},o,e.keyEvents):o}}close(){if(this.currentId===void 0)return;const e=this.store.getGeometryCopy(this.currentId).coordinates[0];if(e.length<5||!this.updatePolygonGeometry([...e.slice(0,-2),e[0]],pt.Finish))return;const i=this.currentId;this.currentCoordinate=0,this.currentId=void 0,this.closingPoints.delete(),this.state==="drawing"&&this.setStarted(),this.onFinish(i,{mode:this.mode,action:"draw"})}registerBehaviors(e){this.pixelDistance=new Hr(e),this.snapping=new Va(e,this.pixelDistance,new Vr(e)),this.closingPoints=new yu(e,this.pixelDistance)}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onMouseMove(e){if(this.mouseMove=!0,this.setCursor(this.cursors.start),this.currentId===void 0||this.currentCoordinate===0)return;const i=this.snappingEnabled?this.snapping.getSnappableCoordinate(e,this.currentId):void 0,o=this.store.getGeometryCopy(this.currentId).coordinates[0];let s;if(i&&(e.lng=i[0],e.lat=i[1]),this.currentCoordinate===1){const l=1/Math.pow(10,this.coordinatePrecision-1),h=Math.max(1e-6,l);s=[o[0],[e.lng,e.lat],[e.lng,e.lat-h],o[0]]}else if(this.currentCoordinate===2)s=[o[0],o[1],[e.lng,e.lat],o[0]];else{const{isClosing:l,isPreviousClosing:h}=this.closingPoints.isClosingPoint(e);h||l?(this.setCursor(this.cursors.close),s=[...o.slice(0,-2),o[0],o[0]]):s=[...o.slice(0,-2),[e.lng,e.lat],o[0]]}this.updatePolygonGeometry(s,pt.Provisional)}updatePolygonGeometry(e,i){if(!this.currentId)return!1;const o={type:"Polygon",coordinates:[e]};return!(this.validate&&!this.validate({type:"Feature",geometry:o},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:i})||(this.store.updateGeometry([{id:this.currentId,geometry:o}]),0))}onClick(e){if(this.currentCoordinate>0&&!this.mouseMove&&this.onMouseMove(e),this.mouseMove=!1,this.currentCoordinate===0){const i=this.snappingEnabled?this.snapping.getSnappableCoordinateFirstClick(e):void 0;i&&(e.lng=i[0],e.lat=i[1]);const[o]=this.store.create([{geometry:{type:"Polygon",coordinates:[[[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat]]]},properties:{mode:this.mode}}]);this.currentId=o,this.currentCoordinate++,this.setDrawing()}else if(this.currentCoordinate===1&&this.currentId){const i=this.snappingEnabled?this.snapping.getSnappableCoordinate(e,this.currentId):void 0;i&&(e.lng=i[0],e.lat=i[1]);const o=this.store.getGeometryCopy(this.currentId);if(fn([e.lng,e.lat],o.coordinates[0][0])||!this.updatePolygonGeometry([o.coordinates[0][0],[e.lng,e.lat],[e.lng,e.lat],o.coordinates[0][0]],pt.Commit))return;this.currentCoordinate++}else if(this.currentCoordinate===2&&this.currentId){const i=this.snappingEnabled?this.snapping.getSnappableCoordinate(e,this.currentId):void 0;i&&(e.lng=i[0],e.lat=i[1]);const o=this.store.getGeometryCopy(this.currentId).coordinates[0];if(fn([e.lng,e.lat],o[1])||!this.updatePolygonGeometry([o[0],o[1],[e.lng,e.lat],[e.lng,e.lat],o[0]],pt.Commit))return;this.currentCoordinate===2&&this.closingPoints.create(o,"polygon"),this.currentCoordinate++}else if(this.currentId){const i=this.snappingEnabled?this.snapping.getSnappableCoordinate(e,this.currentId):void 0,o=this.store.getGeometryCopy(this.currentId).coordinates[0],{isClosing:s,isPreviousClosing:l}=this.closingPoints.isClosingPoint(e);if(l||s)this.close();else{if(i&&(e.lng=i[0],e.lat=i[1]),fn([e.lng,e.lat],o[this.currentCoordinate-1]))return;const h=function(u=[[[0,0],[0,1],[1,1],[1,0],[0,0]]]){return{type:"Feature",geometry:{type:"Polygon",coordinates:u},properties:{}}}([[...o.slice(0,-1),[e.lng,e.lat],o[0]]]);if(!this.updatePolygonGeometry(h.geometry.coordinates[0],pt.Commit))return;this.currentCoordinate++,this.closingPoints.ids.length&&this.closingPoints.update(h.geometry.coordinates[0])}}}onKeyUp(e){e.key===this.keyEvents.cancel?this.cleanUp():e.key===this.keyEvents.finish&&this.close()}onKeyDown(){}onDragStart(){this.setCursor("unset")}onDrag(){}onDragEnd(){this.setCursor(this.cursors.start)}cleanUp(){const e=this.currentId;this.currentId=void 0,this.currentCoordinate=0,this.state==="drawing"&&this.setStarted();try{e!==void 0&&this.store.delete([e]),this.closingPoints.ids.length&&this.closingPoints.delete()}catch{}}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});if(e.properties.mode===this.mode){if(e.geometry.type==="Polygon")return i.polygonFillColor=this.getHexColorStylingValue(this.styles.fillColor,i.polygonFillColor,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.outlineColor,i.polygonOutlineColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.outlineWidth,i.polygonOutlineWidth,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.fillOpacity,i.polygonFillOpacity,e),i.zIndex=10,i;if(e.geometry.type==="Point")return i.pointWidth=this.getNumericStylingValue(this.styles.closingPointWidth,i.pointWidth,e),i.pointColor=this.getHexColorStylingValue(this.styles.closingPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.closingPointOutlineColor,i.pointOutlineColor,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.closingPointOutlineWidth,2,e),i.zIndex=30,i}return i}validateFeature(e){return!!super.validateFeature(e)&&e.properties.mode===this.mode&&Ur(e,this.coordinatePrecision)}}class wu extends fe{constructor(e){super(e),this.mode="rectangle",this.center=void 0,this.clickCount=0,this.currentRectangleId=void 0,this.keyEvents=void 0,this.cursors=void 0;const i={start:"crosshair"};if(this.cursors=e&&e.cursors?dt({},i,e.cursors):i,(e==null?void 0:e.keyEvents)===null)this.keyEvents={cancel:null,finish:null};else{const o={cancel:"Escape",finish:"Enter"};this.keyEvents=e&&e.keyEvents?dt({},o,e.keyEvents):o}}updateRectangle(e,i){if(this.clickCount===1&&this.center&&this.currentRectangleId){const o=this.store.getGeometryCopy(this.currentRectangleId).coordinates[0][0],s={type:"Polygon",coordinates:[[o,[e.lng,o[1]],[e.lng,e.lat],[o[0],e.lat],o]]};if(this.validate&&!this.validate({id:this.currentRectangleId,geometry:s},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:i}))return;this.store.updateGeometry([{id:this.currentRectangleId,geometry:s}])}}close(){const e=this.currentRectangleId;this.center=void 0,this.currentRectangleId=void 0,this.clickCount=0,this.state==="drawing"&&this.setStarted(),e&&this.onFinish(e,{mode:this.mode,action:"draw"})}start(){this.setStarted(),this.setCursor(this.cursors.start)}stop(){this.cleanUp(),this.setStopped(),this.setCursor("unset")}onClick(e){if(this.clickCount===0){this.center=[e.lng,e.lat];const[i]=this.store.create([{geometry:{type:"Polygon",coordinates:[[[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat],[e.lng,e.lat]]]},properties:{mode:this.mode}}]);this.currentRectangleId=i,this.clickCount++,this.setDrawing()}else this.updateRectangle(e,pt.Finish),this.close()}onMouseMove(e){this.updateRectangle(e,pt.Provisional)}onKeyDown(){}onKeyUp(e){e.key===this.keyEvents.cancel?this.cleanUp():e.key===this.keyEvents.finish&&this.close()}onDragStart(){}onDrag(){}onDragEnd(){}cleanUp(){const e=this.currentRectangleId;this.center=void 0,this.currentRectangleId=void 0,this.clickCount=0,this.state==="drawing"&&this.setStarted(),e!==void 0&&this.store.delete([e])}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});return e.type==="Feature"&&e.geometry.type==="Polygon"&&e.properties.mode===this.mode&&(i.polygonFillColor=this.getHexColorStylingValue(this.styles.fillColor,i.polygonFillColor,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.outlineColor,i.polygonOutlineColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.outlineWidth,i.polygonOutlineWidth,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.fillOpacity,i.polygonFillOpacity,e),i.zIndex=10),i}validateFeature(e){return!!super.validateFeature(e)&&e.properties.mode===this.mode&&Wa(e,this.coordinatePrecision)}}function Pn(n,e){const i=n,o=e,s=kt(i[1]),l=kt(o[1]);let h=kt(o[0]-i[0]);h>Math.PI&&(h-=2*Math.PI),h<-Math.PI&&(h+=2*Math.PI);const u=Math.log(Math.tan(l/2+Math.PI/4)/Math.tan(s/2+Math.PI/4)),d=(ii(Math.atan2(h,u))+360)%360;return d>180?-(360-d):d}function Yr(n,e,i){let o=e;e<0&&(o=-Math.abs(o));const s=o/jr,l=n[0]*Math.PI/180,h=kt(n[1]),u=kt(i),d=s*Math.cos(u);let _=h+d;Math.abs(_)>Math.PI/2&&(_=_>0?Math.PI-_:-Math.PI-_);const p=Math.log(Math.tan(_/2+Math.PI/4)/Math.tan(h/2+Math.PI/4)),m=Math.abs(p)>1e-11?d/p:Math.cos(h),v=[(180*(l+s*Math.sin(u)/m)/Math.PI+540)%360-180,180*_/Math.PI];return v[0]+=v[0]-n[0]>180?-360:n[0]-v[0]>180?360:0,v}function xu(n,e,i,o,s){const l=o(n[0],n[1]),h=o(e[0],e[1]),{lng:u,lat:d}=s((l.x+h.x)/2,(l.y+h.y)/2);return[xt(u,i),xt(d,i)]}function bu(n,e,i){const o=Yr(n,1e3*de(n,e)/2,Pn(n,e));return[xt(o[0],i),xt(o[1],i)]}function Vs({featureCoords:n,precision:e,unproject:i,project:o,projection:s}){const l=[];for(let h=0;h<n.length-1;h++){let u;if(s==="web-mercator")u=xu(n[h],n[h+1],e,o,i);else{if(s!=="globe")throw new Error("Invalid projection");u=bu(n[h],n[h+1],e)}l.push(u)}return l}class Pu extends It{constructor(e,i){super(e),this.config=void 0,this.selectionPointBehavior=void 0,this._midPoints=[],this.config=e,this.selectionPointBehavior=i}get ids(){return this._midPoints.concat()}set ids(e){}insert(e,i){const o=this.store.getGeometryCopy(e),{midPointFeatureId:s,midPointSegment:l}=this.store.getPropertiesCopy(e),h=this.store.getGeometryCopy(s),u=h.type==="Polygon"?h.coordinates[0]:h.coordinates;u.splice(l+1,0,o.coordinates),h.coordinates=h.type==="Polygon"?[u]:u,this.store.updateGeometry([{id:s,geometry:h}]),this.store.delete([...this._midPoints,...this.selectionPointBehavior.ids]),this.create(u,s,i),this.selectionPointBehavior.create(u,h.type,s)}create(e,i,o){if(!this.store.has(i))throw new Error("Store does not have feature with this id");this._midPoints=this.store.create(function(s,l,h,u,d,_){return Vs({featureCoords:s,precision:h,project:u,unproject:d,projection:_}).map((p,m)=>({geometry:{type:"Point",coordinates:p},properties:l(m)}))}(e,s=>({mode:this.mode,[Li]:!0,midPointSegment:s,midPointFeatureId:i}),o,this.config.project,this.config.unproject,this.projection))}delete(){this._midPoints.length&&(this.store.delete(this._midPoints),this._midPoints=[])}getUpdated(e){if(this._midPoints.length!==0)return Vs({featureCoords:e,precision:this.coordinatePrecision,project:this.config.project,unproject:this.config.unproject,projection:this.config.projection}).map((i,o)=>({id:this._midPoints[o],geometry:{type:"Point",coordinates:i}}))}}class Cu extends It{constructor(e){super(e),this._selectionPoints=[]}get ids(){return this._selectionPoints.concat()}set ids(e){}create(e,i,o){this._selectionPoints=this.store.create(function(s,l,h){const u=[],d=l==="Polygon"?s.length-1:s.length;for(let _=0;_<d;_++)u.push({geometry:{type:"Point",coordinates:s[_]},properties:h(_)});return u}(e,i,s=>({mode:this.mode,selectionPoint:!0,selectionPointFeatureId:o,index:s})))}delete(){this.ids.length&&(this.store.delete(this.ids),this._selectionPoints=[])}getUpdated(e){if(this._selectionPoints.length!==0)return this._selectionPoints.map((i,o)=>({id:i,geometry:{type:"Point",coordinates:e[o]}}))}getOneUpdated(e,i){if(this._selectionPoints[e]!==void 0)return{id:this._selectionPoints[e],geometry:{type:"Point",coordinates:i}}}}function Ha(n,e){let i=!1;for(let h=0,u=e.length;h<u;h++){const d=e[h];for(let _=0,p=d.length,m=p-1;_<p;m=_++)(s=d[_])[1]>(o=n)[1]!=(l=d[m])[1]>o[1]&&o[0]<(l[0]-s[0])*(o[1]-s[1])/(l[1]-s[1])+s[0]&&(i=!i)}var o,s,l;return i}const Ya=(n,e,i)=>{const o=l=>l*l,s=(l,h)=>o(l.x-h.x)+o(l.y-h.y);return Math.sqrt(((l,h,u)=>{const d=s(h,u);if(d===0)return s(l,h);let _=((l.x-h.x)*(u.x-h.x)+(l.y-h.y)*(u.y-h.y))/d;return _=Math.max(0,Math.min(1,_)),s(l,{x:h.x+_*(u.x-h.x),y:h.y+_*(u.y-h.y)})})(n,e,i))};class Mu extends It{constructor(e,i,o){super(e),this.config=void 0,this.createClickBoundingBox=void 0,this.pixelDistance=void 0,this.config=e,this.createClickBoundingBox=i,this.pixelDistance=o}find(e,i){let o,s,l=1/0,h=1/0;const u=this.createClickBoundingBox.create(e),d=this.store.search(u);for(let _=0;_<d.length;_++){const p=d[_],m=p.geometry;if(m.type==="Point"){if(p.properties.selectionPoint||!i&&p.properties[Li])continue;const v=this.pixelDistance.measure(e,m.coordinates);p.properties[Li]&&v<this.pointerDistance&&v<h?(h=v,s=p):!p.properties[Li]&&v<this.pointerDistance&&v<l&&(l=v,o=p)}else if(m.type==="LineString")for(let v=0;v<m.coordinates.length-1;v++){const x=m.coordinates[v],P=m.coordinates[v+1],T=Ya({x:e.containerX,y:e.containerY},this.project(x[0],x[1]),this.project(P[0],P[1]));T<this.pointerDistance&&T<l&&(l=T,o=p)}else m.type==="Polygon"&&Ha([e.lng,e.lat],m.coordinates)&&(l=0,o=p)}return{clickedFeature:o,clickedMidPoint:s}}}class ku extends It{constructor(e,i,o,s){super(e),this.config=void 0,this.featuresAtMouseEvent=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.draggedFeatureId=null,this.dragPosition=void 0,this.config=e,this.featuresAtMouseEvent=i,this.selectionPoints=o,this.midPoints=s}startDragging(e,i){this.draggedFeatureId=i,this.dragPosition=[e.lng,e.lat]}stopDragging(){this.draggedFeatureId=null,this.dragPosition=void 0}isDragging(){return this.draggedFeatureId!==null}canDrag(e,i){const{clickedFeature:o}=this.featuresAtMouseEvent.find(e,!0);return!(!o||o.id!==i)}drag(e,i){if(!this.draggedFeatureId)return;const o=this.store.getGeometryCopy(this.draggedFeatureId),s=[e.lng,e.lat];if(o.type==="Polygon"||o.type==="LineString"){let l,h;if(o.type==="Polygon"?(l=o.coordinates[0],h=l.length-1):(l=o.coordinates,h=l.length),!this.dragPosition)return!1;for(let _=0;_<h;_++){const p=l[_],m=[this.dragPosition[0]-s[0],this.dragPosition[1]-s[1]],v=xt(p[0]-m[0],this.config.coordinatePrecision),x=xt(p[1]-m[1],this.config.coordinatePrecision);if(v>180||v<-180||x>90||x<-90)return!1;l[_]=[v,x]}o.type==="Polygon"&&(l[l.length-1]=[l[0][0],l[0][1]]);const u=this.selectionPoints.getUpdated(l)||[],d=this.midPoints.getUpdated(l)||[];if(i&&!i({type:"Feature",id:this.draggedFeatureId,geometry:o,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pt.Provisional}))return!1;this.store.updateGeometry([{id:this.draggedFeatureId,geometry:o},...u,...d]),this.dragPosition=[e.lng,e.lat]}else o.type==="Point"&&(this.store.updateGeometry([{id:this.draggedFeatureId,geometry:{type:"Point",coordinates:s}}]),this.dragPosition=[e.lng,e.lat])}}class Lu extends It{constructor(e,i,o,s){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.draggedCoordinate={id:null,index:-1},this.config=e,this.pixelDistance=i,this.selectionPoints=o,this.midPoints=s}getClosestCoordinate(e,i){const o={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(i.type==="LineString")s=i.coordinates;else{if(i.type!=="Polygon")return o;s=i.coordinates[0]}for(let l=0;l<s.length;l++){const h=this.pixelDistance.measure(e,s[l]);if(h<this.pointerDistance&&h<o.dist){const u=i.type==="Polygon"&&(l===s.length-1||l===0);o.dist=h,o.index=u?0:l,o.isFirstOrLastPolygonCoord=u}}return o}getDraggableIndex(e,i){const o=this.store.getGeometryCopy(i),s=this.getClosestCoordinate(e,o);return s.index===-1?-1:s.index}drag(e,i,o){if(!this.draggedCoordinate.id)return!1;const s=this.draggedCoordinate.index,l=this.store.getGeometryCopy(this.draggedCoordinate.id),h=l.type==="LineString"?l.coordinates:l.coordinates[0],u=[e.lng,e.lat];if(e.lng>180||e.lng<-180||e.lat>90||e.lat<-90)return!1;if(l.type!=="Polygon"||s!==h.length-1&&s!==0)h[s]=u;else{const m=h.length-1;h[0]=u,h[m]=u}const d=this.selectionPoints.getOneUpdated(s,u),_=d?[d]:[],p=this.midPoints.getUpdated(h)||[];return!(l.type!=="Point"&&!i&&Nr({type:"Feature",geometry:l,properties:{}})||o&&!o({type:"Feature",id:this.draggedCoordinate.id,geometry:l,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pt.Provisional})||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:l},..._,...p]),0))}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,i){this.draggedCoordinate={id:e,index:i}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}}function Cn(n){let e=0,i=0,o=0;return(n.geometry.type==="Polygon"?n.geometry.coordinates[0].slice(0,-1):n.geometry.coordinates).forEach(s=>{e+=s[0],i+=s[1],o++},!0),[e/o,i/o]}function Xa(n,e){n[0]+=n[0]-e[0]>180?-360:e[0]-n[0]>180?360:0;const i=jr,o=e[1]*Math.PI/180,s=n[1]*Math.PI/180,l=s-o;let h=Math.abs(n[0]-e[0])*Math.PI/180;h>Math.PI&&(h-=2*Math.PI);const u=Math.log(Math.tan(s/2+Math.PI/4)/Math.tan(o/2+Math.PI/4)),d=Math.abs(u)>1e-11?l/u:Math.cos(o);return Math.sqrt(l*l+d*d*h*h)*i}function Mn(n){const e=(n.geometry.type==="Polygon"?n.geometry.coordinates[0]:n.geometry.coordinates).map(i=>{const{x:o,y:s}=Pt(i[0],i[1]);return[o,s]});return n.geometry.type==="Polygon"?function(i){let o=0,s=0,l=0;const h=i.length;for(let u=0;u<h-1;u++){const[d,_]=i[u],[p,m]=i[u+1],v=d*m-p*_;o+=v,s+=(d+p)*v,l+=(_+m)*v}return o/=2,s/=6*o,l/=6*o,{x:s,y:l}}(e):function(i){const o=i.length;let s=0,l=0;for(let h=0;h<o;h++){const[u,d]=i[h];s+=u,l+=d}return{x:s/o,y:l/o}}(e)}class Su extends It{constructor(e,i,o){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.lastBearing=void 0,this.config=e,this.selectionPoints=i,this.midPoints=o}reset(){this.lastBearing=void 0}rotate(e,i,o){const s=this.store.getGeometryCopy(i);if(s.type!=="Polygon"&&s.type!=="LineString")return;const l=[e.lng,e.lat];let h;const u={type:"Feature",geometry:s,properties:{}};if(this.config.projection==="web-mercator"){if(h=du(Mn(u),Pt(e.lng,e.lat)),!this.lastBearing)return void(this.lastBearing=h);((m,v)=>{if(v===0||v===360||v===-360)return m;const x=.017453292519943295*v,P=(m.geometry.type==="Polygon"?m.geometry.coordinates[0]:m.geometry.coordinates).map(([A,w])=>Pt(A,w)),T=P.reduce((A,w)=>({x:A.x+w.x,y:A.y+w.y}),{x:0,y:0});T.x/=P.length,T.y/=P.length;const O=P.map(A=>({x:T.x+(A.x-T.x)*Math.cos(x)-(A.y-T.y)*Math.sin(x),y:T.y+(A.x-T.x)*Math.sin(x)+(A.y-T.y)*Math.cos(x)})).map(({x:A,y:w})=>[Me(A,w).lng,Me(A,w).lat]);m.geometry.type==="Polygon"?m.geometry.coordinates[0]=O:(console.log("rotatedCoordinates linestring",O),m.geometry.coordinates=O)})(u,-(this.lastBearing-h))}else{if(this.config.projection!=="globe")throw new Error("Unsupported projection");if(h=Pn(Cn({type:"Feature",geometry:s,properties:{}}),l),!this.lastBearing)return void(this.lastBearing=h+180);(function(m,v){if(v===0||v===360||v===-360)return m;const x=Cn(m);(m.geometry.type==="Polygon"?m.geometry.coordinates[0]:m.geometry.coordinates).forEach(P=>{const T=Pn(x,P)+v,O=Xa(x,P),A=Yr(x,O,T);P[0]=A[0],P[1]=A[1]})})(u,-(this.lastBearing-(h+180)))}const d=s.type==="Polygon"?s.coordinates[0]:s.coordinates;d.forEach(m=>{m[0]=xt(m[0],this.coordinatePrecision),m[1]=xt(m[1],this.coordinatePrecision)});const _=this.midPoints.getUpdated(d)||[],p=this.selectionPoints.getUpdated(d)||[];if(o&&!o({id:i,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pt.Provisional}))return!1;this.store.updateGeometry([{id:i,geometry:s},...p,..._]),this.projection==="web-mercator"?this.lastBearing=h:this.projection==="globe"&&(this.lastBearing=h+180)}}class Eu extends It{constructor(e,i,o){super(e),this.config=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.lastDistance=void 0,this.config=e,this.selectionPoints=i,this.midPoints=o}reset(){this.lastDistance=void 0}scale(e,i,o){const s=this.store.getGeometryCopy(i);if(s.type!=="Polygon"&&s.type!=="LineString")return;const l=[e.lng,e.lat],h={type:"Feature",geometry:s,properties:{}};let u;const d=Mn(h);if(this.config.projection==="web-mercator"){const x=Pt(e.lng,e.lat);u=Gt(d,x)}else{if(this.config.projection!=="globe")throw new Error("Invalid projection");u=de(Cn({type:"Feature",geometry:s,properties:{}}),l)}if(!this.lastDistance)return void(this.lastDistance=u);const _=1-(this.lastDistance-u)/u;if(this.config.projection==="web-mercator"){const{lng:x,lat:P}=Me(d.x,d.y);(function(T,O,A){if(O===1)return T;const w=(T.geometry.type==="Polygon"?T.geometry.coordinates[0]:T.geometry.coordinates).map(([F,I])=>Pt(F,I)),M=Pt(A[0],A[1]),k=w.map(F=>({x:M.x+(F.x-M.x)*O,y:M.y+(F.y-M.y)*O})).map(({x:F,y:I})=>[Me(F,I).lng,Me(F,I).lat]);T.geometry.type==="Polygon"?T.geometry.coordinates[0]=k:T.geometry.coordinates=k})(h,_,[x,P])}else this.config.projection==="globe"&&function(x,P,T,O="xy"){P===1||(x.geometry.type==="Polygon"?x.geometry.coordinates[0]:x.geometry.coordinates).forEach(A=>{const w=Xa(T,A),M=Pn(T,A),k=Yr(T,w*P,M);O!=="x"&&O!=="xy"||(A[0]=k[0]),O!=="y"&&O!=="xy"||(A[1]=k[1])})}(h,_,Cn(h));const p=s.type==="Polygon"?s.coordinates[0]:s.coordinates;p.forEach(x=>{x[0]=xt(x[0],this.coordinatePrecision),x[1]=xt(x[1],this.coordinatePrecision)});const m=this.midPoints.getUpdated(p)||[],v=this.selectionPoints.getUpdated(p)||[];if(o&&!o({id:i,type:"Feature",geometry:s,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pt.Provisional}))return!1;this.store.updateGeometry([{id:i,geometry:s},...v,...m]),this.lastDistance=u}}class Tu extends It{constructor(e,i,o,s){super(e),this.config=void 0,this.pixelDistance=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.minimumScale=1e-4,this.draggedCoordinate={id:null,index:-1},this.boundingBoxMaps={opposite:{0:4,1:5,2:6,3:7,4:0,5:1,6:2,7:3}},this.config=e,this.pixelDistance=i,this.selectionPoints=o,this.midPoints=s}getClosestCoordinate(e,i){const o={dist:1/0,index:-1,isFirstOrLastPolygonCoord:!1};let s;if(i.type==="LineString")s=i.coordinates;else{if(i.type!=="Polygon")return o;s=i.coordinates[0]}for(let l=0;l<s.length;l++){const h=this.pixelDistance.measure(e,s[l]);if(h<this.pointerDistance&&h<o.dist){const u=i.type==="Polygon"&&(l===s.length-1||l===0);o.dist=h,o.index=u?0:l,o.isFirstOrLastPolygonCoord=u}}return o}isValidDragWebMercator(e,i,o){switch(e){case 0:if(i<=0||o>=0)return!1;break;case 1:if(o>=0)return!1;break;case 2:if(i>=0||o>=0)return!1;break;case 3:if(i>=0)return!1;break;case 4:if(i>=0||o<=0)return!1;break;case 5:if(o<=0)return!1;break;case 6:if(i<=0||o<=0)return!1;break;case 7:if(i<=0)return!1}return!0}getSelectedFeatureDataWebMercator(){if(!this.draggedCoordinate.id||this.draggedCoordinate.index===-1)return null;const e=this.getFeature(this.draggedCoordinate.id);if(!e)return null;const i=this.getNormalisedCoordinates(e.geometry);return{boundingBox:this.getBBoxWebMercator(i),feature:e,updatedCoords:i,selectedCoordinate:i[this.draggedCoordinate.index]}}centerWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{feature:o,boundingBox:s,updatedCoords:l,selectedCoordinate:h}=i,u=Mn(o);if(!u)return null;const d=Pt(h[0],h[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),p=Pt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:_,updatedCoords:l,webMercatorCursor:p,webMercatorSelected:d,webMercatorOrigin:u}),l}centerFixedWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{feature:o,boundingBox:s,updatedCoords:l,selectedCoordinate:h}=i,u=Mn(o);if(!u)return null;const d=Pt(h[0],h[1]),{closestBBoxIndex:_}=this.getIndexesWebMercator(s,d),p=Pt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:_,updatedCoords:l,webMercatorCursor:p,webMercatorSelected:d,webMercatorOrigin:u}),l}scaleFixedWebMercator({closestBBoxIndex:e,webMercatorOrigin:i,webMercatorSelected:o,webMercatorCursor:s,updatedCoords:l}){if(!this.isValidDragWebMercator(e,i.x-s.x,i.y-s.y))return null;let h=Gt(i,s)/Gt(i,o);return h<0&&(h=this.minimumScale),this.performWebMercatorScale(l,i.x,i.y,h,h),l}oppositeFixedWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{boundingBox:o,updatedCoords:s,selectedCoordinate:l}=i,h=Pt(l[0],l[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(o,h),_={x:o[u][0],y:o[u][1]},p=Pt(e.lng,e.lat);return this.scaleFixedWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:p,webMercatorSelected:h,webMercatorOrigin:_}),s}oppositeWebMercatorDrag(e){const i=this.getSelectedFeatureDataWebMercator();if(!i)return null;const{boundingBox:o,updatedCoords:s,selectedCoordinate:l}=i,h=Pt(l[0],l[1]),{oppositeBboxIndex:u,closestBBoxIndex:d}=this.getIndexesWebMercator(o,h),_={x:o[u][0],y:o[u][1]},p=Pt(e.lng,e.lat);return this.scaleWebMercator({closestBBoxIndex:d,updatedCoords:s,webMercatorCursor:p,webMercatorSelected:h,webMercatorOrigin:_}),s}scaleWebMercator({closestBBoxIndex:e,webMercatorOrigin:i,webMercatorSelected:o,webMercatorCursor:s,updatedCoords:l}){const h=i.x-s.x,u=i.y-s.y;if(!this.isValidDragWebMercator(e,h,u))return null;let d=1;h!==0&&e!==1&&e!==5&&(d=1-(i.x-o.x-h)/h);let _=1;return u!==0&&e!==3&&e!==7&&(_=1-(i.y-o.y-u)/u),this.validateScale(d,_)?(d<0&&(d=this.minimumScale),_<0&&(_=this.minimumScale),this.performWebMercatorScale(l,i.x,i.y,d,_),l):null}getFeature(e){if(this.draggedCoordinate.id===null)return null;const i=this.store.getGeometryCopy(e);return i.type!=="Polygon"&&i.type!=="LineString"?null:{type:"Feature",geometry:i,properties:{}}}getNormalisedCoordinates(e){return e.type==="Polygon"?e.coordinates[0]:e.coordinates}validateScale(e,i){const o=!isNaN(e)&&i<Number.MAX_SAFE_INTEGER,s=!isNaN(i)&&i<Number.MAX_SAFE_INTEGER;return o&&s}performWebMercatorScale(e,i,o,s,l){e.forEach(h=>{const{x:u,y:d}=Pt(h[0],h[1]),_=i+(u-i)*s,p=o+(d-o)*l,{lng:m,lat:v}=Me(_,p);h[0]=m,h[1]=v})}getBBoxWebMercator(e){const i=[1/0,1/0,-1/0,-1/0];(e=e.map(u=>{const{x:d,y:_}=Pt(u[0],u[1]);return[d,_]})).forEach(([u,d])=>{u<i[0]&&(i[0]=u),d<i[1]&&(i[1]=d),u>i[2]&&(i[2]=u),d>i[3]&&(i[3]=d)});const[o,s,l,h]=i;return[[o,h],[(o+l)/2,h],[l,h],[l,h+(s-h)/2],[l,s],[(o+l)/2,s],[o,s],[o,h+(s-h)/2]]}getIndexesWebMercator(e,i){let o,s=1/0;for(let l=0;l<e.length;l++){const h=Gt({x:i.x,y:i.y},{x:e[l][0],y:e[l][1]});h<s&&(o=l,s=h)}if(o===void 0)throw new Error("No closest coordinate found");return{oppositeBboxIndex:this.boundingBoxMaps.opposite[o],closestBBoxIndex:o}}isDragging(){return this.draggedCoordinate.id!==null}startDragging(e,i){this.draggedCoordinate={id:e,index:i}}stopDragging(){this.draggedCoordinate={id:null,index:-1}}getDraggableIndex(e,i){const o=this.store.getGeometryCopy(i),s=this.getClosestCoordinate(e,o);return s.index===-1?-1:s.index}drag(e,i,o){if(!this.draggedCoordinate.id)return!1;const s=this.getFeature(this.draggedCoordinate.id);if(!s)return!1;let l=null;if(i==="center"?l=this.centerWebMercatorDrag(e):i==="opposite"?l=this.oppositeWebMercatorDrag(e):i==="center-fixed"?l=this.centerFixedWebMercatorDrag(e):i==="opposite-fixed"&&(l=this.oppositeFixedWebMercatorDrag(e)),!l)return!1;for(let _=0;_<l.length;_++){const p=l[_];if(p[0]=xt(p[0],this.coordinatePrecision),p[1]=xt(p[1],this.coordinatePrecision),!Wr(p,this.coordinatePrecision))return!1}const h=this.midPoints.getUpdated(l)||[],u=this.selectionPoints.getUpdated(l)||[],d={type:s.geometry.type,coordinates:s.geometry.type==="Polygon"?[l]:l};return!(o&&!o({id:this.draggedCoordinate.id,type:"Feature",geometry:d,properties:{}},{project:this.config.project,unproject:this.config.unproject,coordinatePrecision:this.config.coordinatePrecision,updateType:pt.Provisional})||(this.store.updateGeometry([{id:this.draggedCoordinate.id,geometry:d},...u,...h]),0))}}class zu extends lu{constructor(e){var i;super(e),this.mode="select",this.allowManualDeselection=!0,this.dragEventThrottle=5,this.dragEventCount=0,this.selected=[],this.flags=void 0,this.keyEvents=void 0,this.selectionPoints=void 0,this.midPoints=void 0,this.featuresAtMouseEvent=void 0,this.pixelDistance=void 0,this.clickBoundingBox=void 0,this.dragFeature=void 0,this.dragCoordinate=void 0,this.rotateFeature=void 0,this.scaleFeature=void 0,this.dragCoordinateResizeFeature=void 0,this.cursors=void 0,this.validations={},this.flags=e&&e.flags?e.flags:{};const o={pointerOver:"move",dragStart:"move",dragEnd:"move",insertMidpoint:"crosshair"};if(this.cursors=e&&e.cursors?dt({},o,e.cursors):o,(e==null?void 0:e.keyEvents)===null)this.keyEvents={deselect:null,delete:null,rotate:null,scale:null};else{const s={deselect:"Escape",delete:"Delete",rotate:["Control","r"],scale:["Control","s"]};this.keyEvents=e&&e.keyEvents?dt({},s,e.keyEvents):s}if(this.dragEventThrottle=e&&e.dragEventThrottle!==void 0&&e.dragEventThrottle||5,this.allowManualDeselection=(i=e==null?void 0:e.allowManualDeselection)==null||i,e&&e.flags&&e.flags)for(const s in e.flags){const l=e.flags[s].feature;l&&l.validation&&(this.validations[s]=l.validation)}}selectFeature(e){this.select(e,!1)}setSelecting(){if(this._state!=="started")throw new Error("Mode must be started to move to selecting state");this._state="selecting"}registerBehaviors(e){this.pixelDistance=new Hr(e),this.clickBoundingBox=new Vr(e),this.featuresAtMouseEvent=new Mu(e,this.clickBoundingBox,this.pixelDistance),this.selectionPoints=new Cu(e),this.midPoints=new Pu(e,this.selectionPoints),this.rotateFeature=new Su(e,this.selectionPoints,this.midPoints),this.scaleFeature=new Eu(e,this.selectionPoints,this.midPoints),this.dragFeature=new ku(e,this.featuresAtMouseEvent,this.selectionPoints,this.midPoints),this.dragCoordinate=new Lu(e,this.pixelDistance,this.selectionPoints,this.midPoints),this.dragCoordinateResizeFeature=new Tu(e,this.pixelDistance,this.selectionPoints,this.midPoints)}deselectFeature(){this.deselect()}deselect(){const e=this.selected.filter(i=>this.store.has(i)).map(i=>({id:i,property:Sr,value:!1}));this.store.updateProperty(e),this.onDeselect(this.selected[0]),this.selected=[],this.selectionPoints.delete(),this.midPoints.delete()}deleteSelected(){this.store.delete(this.selected),this.selected=[]}onRightClick(e){if(!this.selectionPoints.ids.length)return;let i,o=1/0;if(this.selectionPoints.ids.forEach(m=>{const v=this.store.getGeometryCopy(m),x=this.pixelDistance.measure(e,v.coordinates);x<this.pointerDistance&&x<o&&(o=x,i=this.store.getPropertiesCopy(m))}),!i)return;const s=i.selectionPointFeatureId,l=i.index,h=this.store.getPropertiesCopy(s),u=this.flags[h.mode],d=this.validations[h.mode];if(!(u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.deletable))return;const _=this.store.getGeometryCopy(s);let p;if(_.type==="Polygon"){if(p=_.coordinates[0],p.length<=4)return}else if(_.type==="LineString"&&(p=_.coordinates,p.length<=3))return;if(p){if(_.type==="Polygon"&&l===0||l===p.length-1?(p.shift(),p.pop(),p.push([p[0][0],p[0][1]])):p.splice(l,1),d&&!d({id:s,type:"Feature",geometry:_,properties:h},{project:this.project,unproject:this.unproject,coordinatePrecision:this.coordinatePrecision,updateType:pt.Commit}))return;this.store.delete([...this.midPoints.ids,...this.selectionPoints.ids]),this.store.updateGeometry([{id:s,geometry:_}]),this.selectionPoints.create(p,_.type,s),u&&u.feature&&u.feature.coordinates&&u.feature.coordinates.midpoints&&this.midPoints.create(p,s,this.coordinatePrecision)}}select(e,i=!0){if(this.selected[0]===e)return;const{mode:o}=this.store.getPropertiesCopy(e),s=this.flags[o];if(!s||!s.feature)return;const l=this.selected[0];if(l){if(l===e)return;this.deselect()}i&&this.setCursor(this.cursors.pointerOver),this.selected=[e],this.store.updateProperty([{id:e,property:"selected",value:!0}]),this.onSelect(e);const{type:h,coordinates:u}=this.store.getGeometryCopy(e);if(h!=="LineString"&&h!=="Polygon")return;const d=h==="LineString"?u:u[0];d&&s&&s.feature.coordinates&&(this.selectionPoints.create(d,h,e),s.feature.coordinates.midpoints&&this.midPoints.create(d,e,this.coordinatePrecision))}onLeftClick(e){const{clickedFeature:i,clickedMidPoint:o}=this.featuresAtMouseEvent.find(e,this.selected.length>0);if(this.selected.length&&o)this.midPoints.insert(o.id,this.coordinatePrecision);else if(i&&i.id)this.select(i.id,!0);else if(this.selected.length&&this.allowManualDeselection)return void this.deselect()}start(){this.setStarted(),this.setSelecting()}stop(){this.cleanUp(),this.setStarted(),this.setStopped()}onClick(e){e.button!=="right"?e.button==="left"&&this.onLeftClick(e):this.onRightClick(e)}canScale(e){return this.keyEvents.scale&&this.keyEvents.scale.every(i=>e.heldKeys.includes(i))}canRotate(e){return this.keyEvents.rotate&&this.keyEvents.rotate.every(i=>e.heldKeys.includes(i))}preventDefaultKeyEvent(e){const i=this.canRotate(e),o=this.canScale(e);(i||o)&&e.preventDefault()}onKeyDown(e){this.preventDefaultKeyEvent(e)}onKeyUp(e){if(this.preventDefaultKeyEvent(e),this.keyEvents.delete&&e.key===this.keyEvents.delete){if(!this.selected.length)return;this.onDeselect(this.selected[0]),this.deleteSelected(),this.selectionPoints.delete(),this.midPoints.delete()}else this.keyEvents.deselect&&e.key===this.keyEvents.deselect&&this.cleanUp()}cleanUp(){this.selected.length&&this.deselect()}onDragStart(e,i){if(!this.selected.length)return;const o=this.store.getPropertiesCopy(this.selected[0]),s=this.flags[o.mode];if(!(s&&s.feature&&(s.feature.draggable||s.feature.coordinates&&s.feature.coordinates.draggable||s.feature.coordinates&&s.feature.coordinates.resizable)))return;this.dragEventCount=0;const l=this.selected[0],h=this.dragCoordinate.getDraggableIndex(e,l);return s&&s.feature&&s.feature.coordinates&&(s.feature.coordinates.draggable||s.feature.coordinates.resizable)&&h!==-1?(this.setCursor(this.cursors.dragStart),s.feature.coordinates.resizable?this.dragCoordinateResizeFeature.startDragging(l,h):this.dragCoordinate.startDragging(l,h),void i(!1)):s&&s.feature&&s.feature.draggable&&this.dragFeature.canDrag(e,l)?(this.setCursor(this.cursors.dragStart),this.dragFeature.startDragging(e,l),void i(!1)):void 0}onDrag(e,i){const o=this.selected[0];if(!o)return;const s=this.store.getPropertiesCopy(o),l=this.flags[s.mode],h=(l&&l.feature&&l.feature.selfIntersectable)===!0;if(this.dragEventCount++,this.dragEventCount%this.dragEventThrottle==0)return;const u=this.validations[s.mode];if(l&&l.feature&&l.feature.rotateable&&this.canRotate(e))return i(!1),void this.rotateFeature.rotate(e,o,u);if(l&&l.feature&&l.feature.scaleable&&this.canScale(e))return i(!1),void this.scaleFeature.scale(e,o,u);if(this.dragCoordinateResizeFeature.isDragging()&&l.feature&&l.feature.coordinates&&l.feature.coordinates.resizable){if(this.projection==="globe")throw new Error("Globe is currently unsupported projection for resizable");return i(!1),void this.dragCoordinateResizeFeature.drag(e,l.feature.coordinates.resizable,u)}this.dragCoordinate.isDragging()?this.dragCoordinate.drag(e,h,u):this.dragFeature.isDragging()?this.dragFeature.drag(e,u):i(!0)}onDragEnd(e,i){this.setCursor(this.cursors.dragEnd),this.dragCoordinate.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinate"}):this.dragFeature.isDragging()?this.onFinish(this.selected[0],{mode:this.mode,action:"dragFeature"}):this.dragCoordinateResizeFeature.isDragging()&&this.onFinish(this.selected[0],{mode:this.mode,action:"dragCoordinateResize"}),this.dragCoordinate.stopDragging(),this.dragFeature.stopDragging(),this.dragCoordinateResizeFeature.stopDragging(),this.rotateFeature.reset(),this.scaleFeature.reset(),i(!0)}onMouseMove(e){if(!this.selected.length)return void this.setCursor("unset");if(this.dragFeature.isDragging())return;let i=!1;this.midPoints.ids.forEach(l=>{if(i)return;const h=this.store.getGeometryCopy(l);this.pixelDistance.measure(e,h.coordinates)<this.pointerDistance&&(i=!0)});let o=!1;if(this.selectionPoints.ids.forEach(l=>{const h=this.store.getGeometryCopy(l);this.pixelDistance.measure(e,h.coordinates)<this.pointerDistance&&(i=!1,o=!0)}),i)return void this.setCursor(this.cursors.insertMidpoint);const{clickedFeature:s}=this.featuresAtMouseEvent.find(e,!0);this.setCursor(this.selected.length>0&&(s&&s.id===this.selected[0]||o)?this.cursors.pointerOver:"unset")}styleFeature(e){const i=dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0});if(e.properties.mode===this.mode&&e.geometry.type==="Point"){if(e.properties.selectionPoint)return i.pointColor=this.getHexColorStylingValue(this.styles.selectionPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectionPointOutlineColor,i.pointOutlineColor,e),i.pointWidth=this.getNumericStylingValue(this.styles.selectionPointWidth,i.pointWidth,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectionPointOutlineWidth,2,e),i.zIndex=30,i;if(e.properties.midPoint)return i.pointColor=this.getHexColorStylingValue(this.styles.midPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.midPointOutlineColor,i.pointOutlineColor,e),i.pointWidth=this.getNumericStylingValue(this.styles.midPointWidth,4,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.midPointOutlineWidth,2,e),i.zIndex=40,i}else if(e.properties[Sr]){if(e.geometry.type==="Polygon")return i.polygonFillColor=this.getHexColorStylingValue(this.styles.selectedPolygonColor,i.polygonFillColor,e),i.polygonOutlineWidth=this.getNumericStylingValue(this.styles.selectedPolygonOutlineWidth,i.polygonOutlineWidth,e),i.polygonOutlineColor=this.getHexColorStylingValue(this.styles.selectedPolygonOutlineColor,i.polygonOutlineColor,e),i.polygonFillOpacity=this.getNumericStylingValue(this.styles.selectedPolygonFillOpacity,i.polygonFillOpacity,e),i.zIndex=10,i;if(e.geometry.type==="LineString")return i.lineStringColor=this.getHexColorStylingValue(this.styles.selectedLineStringColor,i.lineStringColor,e),i.lineStringWidth=this.getNumericStylingValue(this.styles.selectedLineStringWidth,i.lineStringWidth,e),i.zIndex=10,i;if(e.geometry.type==="Point")return i.pointWidth=this.getNumericStylingValue(this.styles.selectedPointWidth,i.pointWidth,e),i.pointColor=this.getHexColorStylingValue(this.styles.selectedPointColor,i.pointColor,e),i.pointOutlineColor=this.getHexColorStylingValue(this.styles.selectedPointOutlineColor,i.pointOutlineColor,e),i.pointOutlineWidth=this.getNumericStylingValue(this.styles.selectedPointOutlineWidth,i.pointOutlineWidth,e),i.zIndex=10,i}return i}}class Iu extends fe{constructor(...e){super(...e),this.type=ei.Static,this.mode="static"}start(){}stop(){}onKeyUp(){}onKeyDown(){}onClick(){}onDragStart(){}onDrag(){}onDragEnd(){}onMouseMove(){}cleanUp(){}styleFeature(){return dt({},{polygonFillColor:"#3f97e0",polygonOutlineColor:"#3f97e0",polygonOutlineWidth:4,polygonFillOpacity:.3,pointColor:"#3f97e0",pointOutlineColor:"#ffffff",pointOutlineWidth:0,pointWidth:6,lineStringColor:"#3f97e0",lineStringWidth:4,zIndex:0})}}function Ga(n,e,i,o,s){for(;o>i;){if(o-i>600){const d=o-i+1,_=e-i+1,p=Math.log(d),m=.5*Math.exp(2*p/3),v=.5*Math.sqrt(p*m*(d-m)/d)*(_-d/2<0?-1:1);Ga(n,e,Math.max(i,Math.floor(e-_*m/d+v)),Math.min(o,Math.floor(e+(d-_)*m/d+v)),s)}const l=n[e];let h=i,u=o;for(yi(n,i,e),s(n[o],l)>0&&yi(n,i,o);h<u;){for(yi(n,h,u),h++,u--;s(n[h],l)<0;)h++;for(;s(n[u],l)>0;)u--}s(n[i],l)===0?yi(n,i,u):(u++,yi(n,u,o)),u<=e&&(i=u+1),e<=u&&(o=u-1)}}function yi(n,e,i){const o=n[e];n[e]=n[i],n[i]=o}function Ze(n,e){bi(n,0,n.children.length,e,n)}function bi(n,e,i,o,s){s||(s=Ve([])),s.minX=1/0,s.minY=1/0,s.maxX=-1/0,s.maxY=-1/0;for(let l=e;l<i;l++){const h=n.children[l];Pi(s,n.leaf?o(h):h)}return s}function Pi(n,e){return n.minX=Math.min(n.minX,e.minX),n.minY=Math.min(n.minY,e.minY),n.maxX=Math.max(n.maxX,e.maxX),n.maxY=Math.max(n.maxY,e.maxY),n}function Du(n,e){return n.minX-e.minX}function Ou(n,e){return n.minY-e.minY}function fr(n){return(n.maxX-n.minX)*(n.maxY-n.minY)}function an(n){return n.maxX-n.minX+(n.maxY-n.minY)}function Au(n,e){const i=Math.max(n.minX,e.minX),o=Math.max(n.minY,e.minY),s=Math.min(n.maxX,e.maxX),l=Math.min(n.maxY,e.maxY);return Math.max(0,s-i)*Math.max(0,l-o)}function pr(n,e){return n.minX<=e.minX&&n.minY<=e.minY&&e.maxX<=n.maxX&&e.maxY<=n.maxY}function ln(n,e){return e.minX<=n.maxX&&e.minY<=n.maxY&&e.maxX>=n.minX&&e.maxY>=n.minY}function Ve(n){return{children:n,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function Hs(n,e,i,o,s){const l=[e,i];for(;l.length;){if((i=l.pop())-(e=l.pop())<=o)continue;const h=e+Math.ceil((i-e)/o/2)*o;Ga(n,h,e,i,s),l.push(e,h,h,i)}}class Bu{constructor(e){this._maxEntries=void 0,this._minEntries=void 0,this.data=void 0,this._maxEntries=Math.max(4,e),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()}search(e){let i=this.data;const o=[];if(!ln(e,i))return o;const s=this.toBBox,l=[];for(;i;){for(let h=0;h<i.children.length;h++){const u=i.children[h],d=i.leaf?s(u):u;ln(e,d)&&(i.leaf?o.push(u):pr(e,d)?this._all(u,o):l.push(u))}i=l.pop()}return o}collides(e){let i=this.data;if(ln(e,i)){const o=[];for(;i;){for(let s=0;s<i.children.length;s++){const l=i.children[s],h=i.leaf?this.toBBox(l):l;if(ln(e,h)){if(i.leaf||pr(e,h))return!0;o.push(l)}}i=o.pop()}}return!1}load(e){if(e.length<this._minEntries){for(let o=0;o<e.length;o++)this.insert(e[o]);return}let i=this._build(e.slice(),0,e.length-1,0);if(this.data.children.length)if(this.data.height===i.height)this._splitRoot(this.data,i);else{if(this.data.height<i.height){const o=this.data;this.data=i,i=o}this._insert(i,this.data.height-i.height-1,!0)}else this.data=i}insert(e){this._insert(e,this.data.height-1)}clear(){this.data=Ve([])}remove(e){let i=this.data;const o=this.toBBox(e),s=[],l=[];let h,u,d=!1;for(;i||s.length;){if(i||(i=s.pop(),u=s[s.length-1],h=l.pop(),d=!0),i.leaf){const _=i.children.indexOf(e);_!==-1&&(i.children.splice(_,1),s.push(i),this._condense(s))}d||i.leaf||!pr(i,o)?u?(h++,i=u.children[h],d=!1):i=null:(s.push(i),l.push(h),h=0,u=i,i=i.children[0])}}toBBox(e){return e}compareMinX(e,i){return e.minX-i.minX}compareMinY(e,i){return e.minY-i.minY}_all(e,i){const o=[];for(;e;)e.leaf?i.push(...e.children):o.push(...e.children),e=o.pop();return i}_build(e,i,o,s){const l=o-i+1;let h,u=this._maxEntries;if(l<=u)return h=Ve(e.slice(i,o+1)),Ze(h,this.toBBox),h;s||(s=Math.ceil(Math.log(l)/Math.log(u)),u=Math.ceil(l/Math.pow(u,s-1))),h=Ve([]),h.leaf=!1,h.height=s;const d=Math.ceil(l/u),_=d*Math.ceil(Math.sqrt(u));Hs(e,i,o,_,this.compareMinX);for(let p=i;p<=o;p+=_){const m=Math.min(p+_-1,o);Hs(e,p,m,d,this.compareMinY);for(let v=p;v<=m;v+=d){const x=Math.min(v+d-1,m);h.children.push(this._build(e,v,x,s-1))}}return Ze(h,this.toBBox),h}_chooseSubtree(e,i,o,s){for(;s.push(i),!i.leaf&&s.length-1!==o;){let u,d=1/0,_=1/0;for(let p=0;p<i.children.length;p++){const m=i.children[p],v=fr(m),x=(l=e,h=m,(Math.max(h.maxX,l.maxX)-Math.min(h.minX,l.minX))*(Math.max(h.maxY,l.maxY)-Math.min(h.minY,l.minY))-v);x<_?(_=x,d=v<d?v:d,u=m):x===_&&v<d&&(d=v,u=m)}i=u||i.children[0]}var l,h;return i}_insert(e,i,o){const s=o?e:this.toBBox(e),l=[],h=this._chooseSubtree(s,this.data,i,l);for(h.children.push(e),Pi(h,s);i>=0&&l[i].children.length>this._maxEntries;)this._split(l,i),i--;this._adjustParentBBoxes(s,l,i)}_split(e,i){const o=e[i],s=o.children.length,l=this._minEntries;this._chooseSplitAxis(o,l,s);const h=this._chooseSplitIndex(o,l,s),u=Ve(o.children.splice(h,o.children.length-h));u.height=o.height,u.leaf=o.leaf,Ze(o,this.toBBox),Ze(u,this.toBBox),i?e[i-1].children.push(u):this._splitRoot(o,u)}_splitRoot(e,i){this.data=Ve([e,i]),this.data.height=e.height+1,this.data.leaf=!1,Ze(this.data,this.toBBox)}_chooseSplitIndex(e,i,o){let s,l=1/0,h=1/0;for(let u=i;u<=o-i;u++){const d=bi(e,0,u,this.toBBox),_=bi(e,u,o,this.toBBox),p=Au(d,_),m=fr(d)+fr(_);p<l?(l=p,s=u,h=m<h?m:h):p===l&&m<h&&(h=m,s=u)}return s||o-i}_chooseSplitAxis(e,i,o){const s=e.leaf?this.compareMinX:Du,l=e.leaf?this.compareMinY:Ou;this._allDistMargin(e,i,o,s)<this._allDistMargin(e,i,o,l)&&e.children.sort(s)}_allDistMargin(e,i,o,s){e.children.sort(s);const l=this.toBBox,h=bi(e,0,i,l),u=bi(e,o-i,o,l);let d=an(h)+an(u);for(let _=i;_<o-i;_++){const p=e.children[_];Pi(h,e.leaf?l(p):p),d+=an(h)}for(let _=o-i-1;_>=i;_--){const p=e.children[_];Pi(u,e.leaf?l(p):p),d+=an(u)}return d}_adjustParentBBoxes(e,i,o){for(let s=o;s>=0;s--)Pi(i[s],e)}_condense(e){for(let i,o=e.length-1;o>=0;o--)e[o].children.length===0?o>0?(i=e[o-1].children,i.splice(i.indexOf(e[o]),1)):this.clear():Ze(e[o],this.toBBox)}}class Fu{constructor(e){this.tree=void 0,this.idToNode=void 0,this.nodeToId=void 0,this.tree=new Bu(e&&e.maxEntries?e.maxEntries:9),this.idToNode=new Map,this.nodeToId=new Map}setMaps(e,i){this.idToNode.set(e.id,i),this.nodeToId.set(i,e.id)}toBBox(e){const i=[],o=[];let s;if(e.geometry.type==="Polygon")s=e.geometry.coordinates[0];else if(e.geometry.type==="LineString")s=e.geometry.coordinates;else{if(e.geometry.type!=="Point")throw new Error("Not a valid feature to turn into a bounding box");s=[e.geometry.coordinates]}for(let u=0;u<s.length;u++)o.push(s[u][1]),i.push(s[u][0]);const l=Math.min(...o),h=Math.max(...o);return{minX:Math.min(...i),minY:l,maxX:Math.max(...i),maxY:h}}insert(e){if(this.idToNode.get(String(e.id)))throw new Error("Feature already exists");const i=this.toBBox(e);this.setMaps(e,i),this.tree.insert(i)}load(e){const i=[],o=new Set;e.forEach(s=>{const l=this.toBBox(s);if(this.setMaps(s,l),o.has(String(s.id)))throw new Error(`Duplicate feature ID found ${s.id}`);o.add(String(s.id)),i.push(l)}),this.tree.load(i)}update(e){this.remove(e.id);const i=this.toBBox(e);this.setMaps(e,i),this.tree.insert(i)}remove(e){const i=this.idToNode.get(e);if(!i)throw new Error(`${e} not inserted into the spatial index`);this.tree.remove(i)}clear(){this.tree.clear()}search(e){return this.tree.search(this.toBBox(e)).map(i=>this.nodeToId.get(i))}collides(e){return this.tree.collides(this.toBBox(e))}}const Ru={getId:()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){const e=16*Math.random()|0;return(n=="x"?e:3&e|8).toString(16)}),isValidId:n=>typeof n=="string"&&n.length===36};class Zu{constructor(e){this.idStrategy=void 0,this.tracked=void 0,this.spatialIndex=void 0,this.store=void 0,this._onChange=()=>{},this.store={},this.spatialIndex=new Fu,this.tracked=!e||e.tracked!==!1,this.idStrategy=e&&e.idStrategy?e.idStrategy:Ru}clone(e){return JSON.parse(JSON.stringify(e))}getId(){return this.idStrategy.getId()}has(e){return!!this.store[e]}load(e,i){if(e.length===0)return;const o=this.clone(e);o.forEach(l=>{l.id==null&&(l.id=this.idStrategy.getId()),this.tracked&&(l.properties.createdAt?Bs(l.properties.createdAt):l.properties.createdAt=+new Date,l.properties.updatedAt?Bs(l.properties.updatedAt):l.properties.updatedAt=+new Date)});const s=[];o.forEach(l=>{const h=l.id;if(i&&!i(l))throw new Error(`Feature is not ${h} valid: ${JSON.stringify(l)}`);if(this.has(h))throw new Error(`Feature already exists with this id: ${h}`);this.store[h]=l,s.push(h)}),this.spatialIndex.load(o),this._onChange(s,"create")}search(e,i){const o=this.spatialIndex.search(e).map(s=>this.store[s]);return this.clone(i?o.filter(i):o)}registerOnChange(e){this._onChange=(i,o)=>{e(i,o)}}getGeometryCopy(e){const i=this.store[e];if(!i)throw new Error(`No feature with this id (${e}), can not get geometry copy`);return this.clone(i.geometry)}getPropertiesCopy(e){const i=this.store[e];if(!i)throw new Error(`No feature with this id (${e}), can not get properties copy`);return this.clone(i.properties)}updateProperty(e){const i=[];e.forEach(({id:o,property:s,value:l})=>{const h=this.store[o];if(!h)throw new Error(`No feature with this (${o}), can not update geometry`);i.push(o),h.properties[s]=l,this.tracked&&(h.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(i,"update")}updateGeometry(e){const i=[];e.forEach(({id:o,geometry:s})=>{i.push(o);const l=this.store[o];if(!l)throw new Error(`No feature with this (${o}), can not update geometry`);l.geometry=this.clone(s),this.spatialIndex.update(l),this.tracked&&(l.properties.updatedAt=+new Date)}),this._onChange&&this._onChange(i,"update")}create(e){const i=[];return e.forEach(({geometry:o,properties:s})=>{let l,h=dt({},s);this.tracked&&(l=+new Date,s?(h.createdAt=typeof s.createdAt=="number"?s.createdAt:l,h.updatedAt=typeof s.updatedAt=="number"?s.updatedAt:l):h={createdAt:l,updatedAt:l});const u=this.getId(),d={id:u,type:"Feature",geometry:o,properties:h};this.store[u]=d,this.spatialIndex.insert(d),i.push(u)}),this._onChange&&this._onChange([...i],"create"),i}delete(e){e.forEach(i=>{if(!this.store[i])throw new Error("No feature with this id, can not delete");delete this.store[i],this.spatialIndex.remove(i)}),this._onChange&&this._onChange([...e],"delete")}copyAll(){return this.clone(Object.keys(this.store).map(e=>this.store[e]))}clear(){this.store={},this.spatialIndex.clear()}size(){return Object.keys(this.store).length}}const _r=n=>(n.geometry.type==="Polygon"||n.geometry.type==="LineString")&&!Nr(n);class ju{constructor(e){this._modes=void 0,this._mode=void 0,this._adapter=void 0,this._enabled=!1,this._store=void 0,this._eventListeners=void 0,this._instanceSelectMode=void 0,this._adapter=e.adapter,this._mode=new Iu;const i=new Set,o=e.modes.reduce((p,m)=>{if(i.has(m.mode))throw new Error(`There is already a ${m.mode} mode provided`);return i.add(m.mode),p[m.mode]=m,p},{}),s=Object.keys(o);if(s.length===0)throw new Error("No modes provided");s.forEach(p=>{if(o[p].type===ei.Select){if(this._instanceSelectMode)throw new Error("only one type of select mode can be provided");this._instanceSelectMode=p}}),this._modes=dt({},o,{static:this._mode}),this._eventListeners={change:[],select:[],deselect:[],finish:[],ready:[]},this._store=new Zu({tracked:!!e.tracked,idStrategy:e.idStrategy?e.idStrategy:void 0});const l=p=>{const m=[],v=this._store.copyAll().filter(x=>!p.includes(x.id)||(m.push(x),!1));return{changed:m,unchanged:v}},h=(p,m)=>{this._enabled&&this._eventListeners.finish.forEach(v=>{v(p,m)})},u=(p,m)=>{if(!this._enabled)return;this._eventListeners.change.forEach(P=>{P(p,m)});const{changed:v,unchanged:x}=l(p);m==="create"?this._adapter.render({created:v,deletedIds:[],unchanged:x,updated:[]},this.getModeStyles()):m==="update"?this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:v},this.getModeStyles()):m==="delete"?this._adapter.render({created:[],deletedIds:p,unchanged:x,updated:[]},this.getModeStyles()):m==="styling"&&this._adapter.render({created:[],deletedIds:[],unchanged:x,updated:[]},this.getModeStyles())},d=p=>{if(!this._enabled)return;this._eventListeners.select.forEach(x=>{x(p)});const{changed:m,unchanged:v}=l([p]);this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:m},this.getModeStyles())},_=p=>{if(!this._enabled)return;this._eventListeners.deselect.forEach(x=>{x()});const{changed:m,unchanged:v}=l([p]);m&&this._adapter.render({created:[],deletedIds:[],unchanged:v,updated:m},this.getModeStyles())};Object.keys(this._modes).forEach(p=>{this._modes[p].register({mode:p,store:this._store,setCursor:this._adapter.setCursor.bind(this._adapter),project:this._adapter.project.bind(this._adapter),unproject:this._adapter.unproject.bind(this._adapter),setDoubleClickToZoom:this._adapter.setDoubleClickToZoom.bind(this._adapter),onChange:u,onSelect:d,onDeselect:_,onFinish:h,coordinatePrecision:this._adapter.getCoordinatePrecision()})})}checkEnabled(){if(!this._enabled)throw new Error("Terra Draw is not enabled")}getModeStyles(){const e={};return Object.keys(this._modes).forEach(i=>{e[i]=o=>this._instanceSelectMode&&o.properties[Sr]?this._modes[this._instanceSelectMode].styleFeature.bind(this._modes[this._instanceSelectMode])(o):this._modes[i].styleFeature.bind(this._modes[i])(o)}),e}featuresAtLocation({lng:e,lat:i},o){const s=o&&o.pointerDistance!==void 0?o.pointerDistance:30,l=!o||o.ignoreSelectFeatures===void 0||o.ignoreSelectFeatures,h=this._adapter.unproject.bind(this._adapter),u=this._adapter.project.bind(this._adapter),d=u(e,i),_=Ua({unproject:h,point:d,pointerDistance:s});return this._store.search(_).filter(p=>{if(l&&(p.properties[Li]||p.properties.selectionPoint))return!1;if(p.geometry.type==="Point"){const m=p.geometry.coordinates,v=u(m[0],m[1]);return Gt(d,v)<s}if(p.geometry.type==="LineString"){const m=p.geometry.coordinates;for(let v=0;v<m.length-1;v++){const x=m[v],P=m[v+1];if(Ya(d,u(x[0],x[1]),u(P[0],P[1]))<s)return!0}return!1}return!!Ha([e,i],p.geometry.coordinates)||void 0})}getSelectMode(){if(this.checkEnabled(),!this._instanceSelectMode)throw new Error("No select mode defined in instance");return this.getMode()!==this._instanceSelectMode&&this.setMode(this._instanceSelectMode),this._modes[this._instanceSelectMode]}setModeStyles(e,i){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._modes[e].styles=i}getSnapshot(){return this._store.copyAll()}clear(){this.checkEnabled(),this._adapter.clear()}get enabled(){return this._enabled}set enabled(e){throw new Error("Enabled is read only")}getMode(){return this._mode.mode}setMode(e){if(this.checkEnabled(),!this._modes[e])throw new Error("No mode with this name present");this._mode.stop(),this._mode=this._modes[e],this._mode.start()}removeFeatures(e){this.checkEnabled(),this._store.delete(e)}selectFeature(e){this.getSelectMode().selectFeature(e)}deselectFeature(e){this.getSelectMode().deselectFeature(e)}getFeatureId(){return this._store.getId()}hasFeature(e){return this._store.has(e)}addFeatures(e){this.checkEnabled(),e.length!==0&&this._store.load(e,i=>{if(i&&typeof i=="object"&&"properties"in i&&typeof i.properties=="object"&&i.properties!==null&&"mode"in i.properties){const o=this._modes[i.properties.mode];return!!o&&o.validateFeature.bind(o)(i)}return!1})}start(){this._enabled=!0,this._adapter.register({onReady:()=>{this._eventListeners.ready.forEach(e=>{e()})},getState:()=>this._mode.state,onClick:e=>{this._mode.onClick(e)},onMouseMove:e=>{this._mode.onMouseMove(e)},onKeyDown:e=>{this._mode.onKeyDown(e)},onKeyUp:e=>{this._mode.onKeyUp(e)},onDragStart:(e,i)=>{this._mode.onDragStart(e,i)},onDrag:(e,i)=>{this._mode.onDrag(e,i)},onDragEnd:(e,i)=>{this._mode.onDragEnd(e,i)},onClear:()=>{this._mode.cleanUp(),this._store.clear()}})}getFeaturesAtLngLat(e,i){const{lng:o,lat:s}=e;return this.featuresAtLocation({lng:o,lat:s},i)}getFeaturesAtPointerEvent(e,i){const o=this._adapter.getLngLatFromEvent.bind(this._adapter)(e);return o===null?[]:this.featuresAtLocation(o,i)}stop(){this._enabled=!1,this._adapter.unregister()}on(e,i){const o=this._eventListeners[e];o.includes(i)||o.push(i)}off(e,i){const o=this._eventListeners[e];o.includes(i)&&o.splice(o.indexOf(i),1)}}function Nu(n,e){return new ju({tracked:!0,adapter:new $c({lib:e,map:n,coordinatePrecision:9}),modes:[new zu({flags:{arbitary:{feature:{}},polygon:{feature:{scaleable:!0,rotateable:!0,draggable:!0,coordinates:{midpoints:!0,draggable:!0,deletable:!0}}},linestring:{feature:{draggable:!0,coordinates:{midpoints:!0,draggable:!0,deletable:!0}}},circle:{feature:{draggable:!0}},point:{feature:{draggable:!0}},rectangle:{feature:{draggable:!0,coordinates:{resizable:"opposite"}}},freehand:{feature:{draggable:!0}}}}),new mu,new _u({snapping:!0,validation:(i,{updateType:o})=>o==="finish"||o==="commit"?_r(i):!0}),new wu,new vu({pointerDistance:30,validation:(i,{updateType:o})=>o==="finish"||o==="commit"?_r(i):!0}),new cu,new uu({pointerDistance:5,validation:i=>_r(i)})]})}var Wu=Object.create,qa=Object.defineProperty,Uu=Object.getOwnPropertyDescriptor,Ka=Object.getOwnPropertyNames,Vu=Object.getPrototypeOf,Hu=Object.prototype.hasOwnProperty,Rt=Math.pow,se=(n,e)=>function(){return e||(0,n[Ka(n)[0]])((e={exports:{}}).exports,e),e.exports},Yu=(n,e,i,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let s of Ka(e))!Hu.call(n,s)&&s!==i&&qa(n,s,{get:()=>e[s],enumerable:!(o=Uu(e,s))||o.enumerable});return n},jt=(n,e,i)=>(i=n!=null?Wu(Vu(n)):{},Yu(!n||!n.__esModule?qa(i,"default",{value:n,enumerable:!0}):i,n)),ni=(n,e,i)=>new Promise((o,s)=>{var l=d=>{try{u(i.next(d))}catch(_){s(_)}},h=d=>{try{u(i.throw(d))}catch(_){s(_)}},u=d=>d.done?o(d.value):Promise.resolve(d.value).then(l,h);u((i=i.apply(n,e)).next())}),ae=se({"node_modules/@mapbox/point-geometry/index.js"(n,e){e.exports=i;function i(o,s){this.x=o,this.y=s}i.prototype={clone:function(){return new i(this.x,this.y)},add:function(o){return this.clone()._add(o)},sub:function(o){return this.clone()._sub(o)},multByPoint:function(o){return this.clone()._multByPoint(o)},divByPoint:function(o){return this.clone()._divByPoint(o)},mult:function(o){return this.clone()._mult(o)},div:function(o){return this.clone()._div(o)},rotate:function(o){return this.clone()._rotate(o)},rotateAround:function(o,s){return this.clone()._rotateAround(o,s)},matMult:function(o){return this.clone()._matMult(o)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(o){return this.x===o.x&&this.y===o.y},dist:function(o){return Math.sqrt(this.distSqr(o))},distSqr:function(o){var s=o.x-this.x,l=o.y-this.y;return s*s+l*l},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(o){return Math.atan2(this.y-o.y,this.x-o.x)},angleWith:function(o){return this.angleWithSep(o.x,o.y)},angleWithSep:function(o,s){return Math.atan2(this.x*s-this.y*o,this.x*o+this.y*s)},_matMult:function(o){var s=o[0]*this.x+o[1]*this.y,l=o[2]*this.x+o[3]*this.y;return this.x=s,this.y=l,this},_add:function(o){return this.x+=o.x,this.y+=o.y,this},_sub:function(o){return this.x-=o.x,this.y-=o.y,this},_mult:function(o){return this.x*=o,this.y*=o,this},_div:function(o){return this.x/=o,this.y/=o,this},_multByPoint:function(o){return this.x*=o.x,this.y*=o.y,this},_divByPoint:function(o){return this.x/=o.x,this.y/=o.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var o=this.y;return this.y=this.x,this.x=-o,this},_rotate:function(o){var s=Math.cos(o),l=Math.sin(o),h=s*this.x-l*this.y,u=l*this.x+s*this.y;return this.x=h,this.y=u,this},_rotateAround:function(o,s){var l=Math.cos(o),h=Math.sin(o),u=s.x+l*(this.x-s.x)-h*(this.y-s.y),d=s.y+h*(this.x-s.x)+l*(this.y-s.y);return this.x=u,this.y=d,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},i.convert=function(o){return o instanceof i?o:Array.isArray(o)?new i(o[0],o[1]):o}}}),Xu=se({"node_modules/@mapbox/unitbezier/index.js"(n,e){e.exports=i;function i(o,s,l,h){this.cx=3*o,this.bx=3*(l-o)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*s,this.by=3*(h-s)-this.cy,this.ay=1-this.cy-this.by,this.p1x=o,this.p1y=h,this.p2x=l,this.p2y=h}i.prototype.sampleCurveX=function(o){return((this.ax*o+this.bx)*o+this.cx)*o},i.prototype.sampleCurveY=function(o){return((this.ay*o+this.by)*o+this.cy)*o},i.prototype.sampleCurveDerivativeX=function(o){return(3*this.ax*o+2*this.bx)*o+this.cx},i.prototype.solveCurveX=function(o,s){typeof s>"u"&&(s=1e-6);var l,h,u,d,_;for(u=o,_=0;_<8;_++){if(d=this.sampleCurveX(u)-o,Math.abs(d)<s)return u;var p=this.sampleCurveDerivativeX(u);if(Math.abs(p)<1e-6)break;u=u-d/p}if(l=0,h=1,u=o,u<l)return l;if(u>h)return h;for(;l<h;){if(d=this.sampleCurveX(u),Math.abs(d-o)<s)return u;o>d?l=u:h=u,u=(h-l)*.5+l}return u},i.prototype.solve=function(o,s){return this.sampleCurveY(this.solveCurveX(o,s))}}}),$a=se({"node_modules/@mapbox/vector-tile/lib/vectortilefeature.js"(n,e){var i=ae();e.exports=o;function o(d,_,p,m,v){this.properties={},this.extent=p,this.type=0,this._pbf=d,this._geometry=-1,this._keys=m,this._values=v,d.readFields(s,this,_)}function s(d,_,p){d==1?_.id=p.readVarint():d==2?l(p,_):d==3?_.type=p.readVarint():d==4&&(_._geometry=p.pos)}function l(d,_){for(var p=d.readVarint()+d.pos;d.pos<p;){var m=_._keys[d.readVarint()],v=_._values[d.readVarint()];_.properties[m]=v}}o.types=["Unknown","Point","LineString","Polygon"],o.prototype.loadGeometry=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,p=1,m=0,v=0,x=0,P=[],T;d.pos<_;){if(m<=0){var O=d.readVarint();p=O&7,m=O>>3}if(m--,p===1||p===2)v+=d.readSVarint(),x+=d.readSVarint(),p===1&&(T&&P.push(T),T=[]),T.push(new i(v,x));else if(p===7)T&&T.push(T[0].clone());else throw new Error("unknown command "+p)}return T&&P.push(T),P},o.prototype.bbox=function(){var d=this._pbf;d.pos=this._geometry;for(var _=d.readVarint()+d.pos,p=1,m=0,v=0,x=0,P=1/0,T=-1/0,O=1/0,A=-1/0;d.pos<_;){if(m<=0){var w=d.readVarint();p=w&7,m=w>>3}if(m--,p===1||p===2)v+=d.readSVarint(),x+=d.readSVarint(),v<P&&(P=v),v>T&&(T=v),x<O&&(O=x),x>A&&(A=x);else if(p!==7)throw new Error("unknown command "+p)}return[P,O,T,A]},o.prototype.toGeoJSON=function(d,_,p){var m=this.extent*Math.pow(2,p),v=this.extent*d,x=this.extent*_,P=this.loadGeometry(),T=o.types[this.type],O,A;function w(F){for(var I=0;I<F.length;I++){var B=F[I],z=180-(B.y+x)*360/m;F[I]=[(B.x+v)*360/m-180,360/Math.PI*Math.atan(Math.exp(z*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(O=0;O<P.length;O++)M[O]=P[O][0];P=M,w(P);break;case 2:for(O=0;O<P.length;O++)w(P[O]);break;case 3:for(P=h(P),O=0;O<P.length;O++)for(A=0;A<P[O].length;A++)w(P[O][A]);break}P.length===1?P=P[0]:T="Multi"+T;var k={type:"Feature",geometry:{type:T,coordinates:P},properties:this.properties};return"id"in this&&(k.id=this.id),k};function h(d){var _=d.length;if(_<=1)return[d];for(var p=[],m,v,x=0;x<_;x++){var P=u(d[x]);P!==0&&(v===void 0&&(v=P<0),v===P<0?(m&&p.push(m),m=[d[x]]):m.push(d[x]))}return m&&p.push(m),p}function u(d){for(var _=0,p=0,m=d.length,v=m-1,x,P;p<m;v=p++)x=d[p],P=d[v],_+=(P.x-x.x)*(x.y+P.y);return _}}}),Ja=se({"node_modules/@mapbox/vector-tile/lib/vectortilelayer.js"(n,e){var i=$a();e.exports=o;function o(h,u){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=h,this._keys=[],this._values=[],this._features=[],h.readFields(s,this,u),this.length=this._features.length}function s(h,u,d){h===15?u.version=d.readVarint():h===1?u.name=d.readString():h===5?u.extent=d.readVarint():h===2?u._features.push(d.pos):h===3?u._keys.push(d.readString()):h===4&&u._values.push(l(d))}function l(h){for(var u=null,d=h.readVarint()+h.pos;h.pos<d;){var _=h.readVarint()>>3;u=_===1?h.readString():_===2?h.readFloat():_===3?h.readDouble():_===4?h.readVarint64():_===5?h.readVarint():_===6?h.readSVarint():_===7?h.readBoolean():null}return u}o.prototype.feature=function(h){if(h<0||h>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[h];var u=this._pbf.readVarint()+this._pbf.pos;return new i(this._pbf,u,this.extent,this._keys,this._values)}}}),Gu=se({"node_modules/@mapbox/vector-tile/lib/vectortile.js"(n,e){var i=Ja();e.exports=o;function o(l,h){this.layers=l.readFields(s,{},h)}function s(l,h,u){if(l===3){var d=new i(u,u.readVarint()+u.pos);d.length&&(h[d.name]=d)}}}}),qu=se({"node_modules/@mapbox/vector-tile/index.js"(n,e){e.exports.VectorTile=Gu(),e.exports.VectorTileFeature=$a(),e.exports.VectorTileLayer=Ja()}}),Ku=se({"node_modules/ieee754/index.js"(n){n.read=function(e,i,o,s,l){var h,u,d=l*8-s-1,_=(1<<d)-1,p=_>>1,m=-7,v=o?l-1:0,x=o?-1:1,P=e[i+v];for(v+=x,h=P&(1<<-m)-1,P>>=-m,m+=d;m>0;h=h*256+e[i+v],v+=x,m-=8);for(u=h&(1<<-m)-1,h>>=-m,m+=s;m>0;u=u*256+e[i+v],v+=x,m-=8);if(h===0)h=1-p;else{if(h===_)return u?NaN:(P?-1:1)*(1/0);u=u+Math.pow(2,s),h=h-p}return(P?-1:1)*u*Math.pow(2,h-s)},n.write=function(e,i,o,s,l,h){var u,d,_,p=h*8-l-1,m=(1<<p)-1,v=m>>1,x=l===23?Math.pow(2,-24)-Math.pow(2,-77):0,P=s?0:h-1,T=s?1:-1,O=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(d=isNaN(i)?1:0,u=m):(u=Math.floor(Math.log(i)/Math.LN2),i*(_=Math.pow(2,-u))<1&&(u--,_*=2),u+v>=1?i+=x/_:i+=x*Math.pow(2,1-v),i*_>=2&&(u++,_/=2),u+v>=m?(d=0,u=m):u+v>=1?(d=(i*_-1)*Math.pow(2,l),u=u+v):(d=i*Math.pow(2,v-1)*Math.pow(2,l),u=0));l>=8;e[o+P]=d&255,P+=T,d/=256,l-=8);for(u=u<<l|d,p+=l;p>0;e[o+P]=u&255,P+=T,u/=256,p-=8);e[o+P-T]|=O*128}}}),$u=se({"node_modules/pbf/index.js"(n,e){e.exports=o;var i=Ku();function o(y){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(y)?y:new Uint8Array(y||0),this.pos=0,this.type=0,this.length=this.buf.length}o.Varint=0,o.Fixed64=1,o.Bytes=2,o.Fixed32=5;var s=65536*65536,l=1/s,h=12,u=typeof TextDecoder>"u"?null:new TextDecoder("utf8");o.prototype={destroy:function(){this.buf=null},readFields:function(y,C,S){for(S=S||this.length;this.pos<S;){var Y=this.readVarint(),Z=Y>>3,K=this.pos;this.type=Y&7,y(Z,C,this),this.pos===K&&this.skip(Y)}return C},readMessage:function(y,C){return this.readFields(y,C,this.readVarint()+this.pos)},readFixed32:function(){var y=z(this.buf,this.pos);return this.pos+=4,y},readSFixed32:function(){var y=H(this.buf,this.pos);return this.pos+=4,y},readFixed64:function(){var y=z(this.buf,this.pos)+z(this.buf,this.pos+4)*s;return this.pos+=8,y},readSFixed64:function(){var y=z(this.buf,this.pos)+H(this.buf,this.pos+4)*s;return this.pos+=8,y},readFloat:function(){var y=i.read(this.buf,this.pos,!0,23,4);return this.pos+=4,y},readDouble:function(){var y=i.read(this.buf,this.pos,!0,52,8);return this.pos+=8,y},readVarint:function(y){var C=this.buf,S,Y;return Y=C[this.pos++],S=Y&127,Y<128||(Y=C[this.pos++],S|=(Y&127)<<7,Y<128)||(Y=C[this.pos++],S|=(Y&127)<<14,Y<128)||(Y=C[this.pos++],S|=(Y&127)<<21,Y<128)?S:(Y=C[this.pos],S|=(Y&15)<<28,d(S,y,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var y=this.readVarint();return y%2===1?(y+1)/-2:y/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var y=this.readVarint()+this.pos,C=this.pos;return this.pos=y,y-C>=h&&u?G(this.buf,C,y):V(this.buf,C,y)},readBytes:function(){var y=this.readVarint()+this.pos,C=this.buf.subarray(this.pos,y);return this.pos=y,C},readPackedVarint:function(y,C){if(this.type!==o.Bytes)return y.push(this.readVarint(C));var S=_(this);for(y=y||[];this.pos<S;)y.push(this.readVarint(C));return y},readPackedSVarint:function(y){if(this.type!==o.Bytes)return y.push(this.readSVarint());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readSVarint());return y},readPackedBoolean:function(y){if(this.type!==o.Bytes)return y.push(this.readBoolean());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readBoolean());return y},readPackedFloat:function(y){if(this.type!==o.Bytes)return y.push(this.readFloat());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readFloat());return y},readPackedDouble:function(y){if(this.type!==o.Bytes)return y.push(this.readDouble());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readDouble());return y},readPackedFixed32:function(y){if(this.type!==o.Bytes)return y.push(this.readFixed32());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readFixed32());return y},readPackedSFixed32:function(y){if(this.type!==o.Bytes)return y.push(this.readSFixed32());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readSFixed32());return y},readPackedFixed64:function(y){if(this.type!==o.Bytes)return y.push(this.readFixed64());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readFixed64());return y},readPackedSFixed64:function(y){if(this.type!==o.Bytes)return y.push(this.readSFixed64());var C=_(this);for(y=y||[];this.pos<C;)y.push(this.readSFixed64());return y},skip:function(y){var C=y&7;if(C===o.Varint)for(;this.buf[this.pos++]>127;);else if(C===o.Bytes)this.pos=this.readVarint()+this.pos;else if(C===o.Fixed32)this.pos+=4;else if(C===o.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+C)},writeTag:function(y,C){this.writeVarint(y<<3|C)},realloc:function(y){for(var C=this.length||16;C<this.pos+y;)C*=2;if(C!==this.length){var S=new Uint8Array(C);S.set(this.buf),this.buf=S,this.length=C}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(y){this.realloc(4),j(this.buf,y,this.pos),this.pos+=4},writeSFixed32:function(y){this.realloc(4),j(this.buf,y,this.pos),this.pos+=4},writeFixed64:function(y){this.realloc(8),j(this.buf,y&-1,this.pos),j(this.buf,Math.floor(y*l),this.pos+4),this.pos+=8},writeSFixed64:function(y){this.realloc(8),j(this.buf,y&-1,this.pos),j(this.buf,Math.floor(y*l),this.pos+4),this.pos+=8},writeVarint:function(y){if(y=+y||0,y>268435455||y<0){m(y,this);return}this.realloc(4),this.buf[this.pos++]=y&127|(y>127?128:0),!(y<=127)&&(this.buf[this.pos++]=(y>>>=7)&127|(y>127?128:0),!(y<=127)&&(this.buf[this.pos++]=(y>>>=7)&127|(y>127?128:0),!(y<=127)&&(this.buf[this.pos++]=y>>>7&127)))},writeSVarint:function(y){this.writeVarint(y<0?-y*2-1:y*2)},writeBoolean:function(y){this.writeVarint(!!y)},writeString:function(y){y=String(y),this.realloc(y.length*4),this.pos++;var C=this.pos;this.pos=q(this.buf,y,this.pos);var S=this.pos-C;S>=128&&P(C,S,this),this.pos=C-1,this.writeVarint(S),this.pos+=S},writeFloat:function(y){this.realloc(4),i.write(this.buf,y,this.pos,!0,23,4),this.pos+=4},writeDouble:function(y){this.realloc(8),i.write(this.buf,y,this.pos,!0,52,8),this.pos+=8},writeBytes:function(y){var C=y.length;this.writeVarint(C),this.realloc(C);for(var S=0;S<C;S++)this.buf[this.pos++]=y[S]},writeRawMessage:function(y,C){this.pos++;var S=this.pos;y(C,this);var Y=this.pos-S;Y>=128&&P(S,Y,this),this.pos=S-1,this.writeVarint(Y),this.pos+=Y},writeMessage:function(y,C,S){this.writeTag(y,o.Bytes),this.writeRawMessage(C,S)},writePackedVarint:function(y,C){C.length&&this.writeMessage(y,T,C)},writePackedSVarint:function(y,C){C.length&&this.writeMessage(y,O,C)},writePackedBoolean:function(y,C){C.length&&this.writeMessage(y,M,C)},writePackedFloat:function(y,C){C.length&&this.writeMessage(y,A,C)},writePackedDouble:function(y,C){C.length&&this.writeMessage(y,w,C)},writePackedFixed32:function(y,C){C.length&&this.writeMessage(y,k,C)},writePackedSFixed32:function(y,C){C.length&&this.writeMessage(y,F,C)},writePackedFixed64:function(y,C){C.length&&this.writeMessage(y,I,C)},writePackedSFixed64:function(y,C){C.length&&this.writeMessage(y,B,C)},writeBytesField:function(y,C){this.writeTag(y,o.Bytes),this.writeBytes(C)},writeFixed32Field:function(y,C){this.writeTag(y,o.Fixed32),this.writeFixed32(C)},writeSFixed32Field:function(y,C){this.writeTag(y,o.Fixed32),this.writeSFixed32(C)},writeFixed64Field:function(y,C){this.writeTag(y,o.Fixed64),this.writeFixed64(C)},writeSFixed64Field:function(y,C){this.writeTag(y,o.Fixed64),this.writeSFixed64(C)},writeVarintField:function(y,C){this.writeTag(y,o.Varint),this.writeVarint(C)},writeSVarintField:function(y,C){this.writeTag(y,o.Varint),this.writeSVarint(C)},writeStringField:function(y,C){this.writeTag(y,o.Bytes),this.writeString(C)},writeFloatField:function(y,C){this.writeTag(y,o.Fixed32),this.writeFloat(C)},writeDoubleField:function(y,C){this.writeTag(y,o.Fixed64),this.writeDouble(C)},writeBooleanField:function(y,C){this.writeVarintField(y,!!C)}};function d(y,C,S){var Y=S.buf,Z,K;if(K=Y[S.pos++],Z=(K&112)>>4,K<128||(K=Y[S.pos++],Z|=(K&127)<<3,K<128)||(K=Y[S.pos++],Z|=(K&127)<<10,K<128)||(K=Y[S.pos++],Z|=(K&127)<<17,K<128)||(K=Y[S.pos++],Z|=(K&127)<<24,K<128)||(K=Y[S.pos++],Z|=(K&1)<<31,K<128))return p(y,Z,C);throw new Error("Expected varint not more than 10 bytes")}function _(y){return y.type===o.Bytes?y.readVarint()+y.pos:y.pos+1}function p(y,C,S){return S?C*4294967296+(y>>>0):(C>>>0)*4294967296+(y>>>0)}function m(y,C){var S,Y;if(y>=0?(S=y%4294967296|0,Y=y/4294967296|0):(S=~(-y%4294967296),Y=~(-y/4294967296),S^4294967295?S=S+1|0:(S=0,Y=Y+1|0)),y>=18446744073709552e3||y<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");C.realloc(10),v(S,Y,C),x(Y,C)}function v(y,C,S){S.buf[S.pos++]=y&127|128,y>>>=7,S.buf[S.pos++]=y&127|128,y>>>=7,S.buf[S.pos++]=y&127|128,y>>>=7,S.buf[S.pos++]=y&127|128,y>>>=7,S.buf[S.pos]=y&127}function x(y,C){var S=(y&7)<<4;C.buf[C.pos++]|=S|((y>>>=3)?128:0),y&&(C.buf[C.pos++]=y&127|((y>>>=7)?128:0),y&&(C.buf[C.pos++]=y&127|((y>>>=7)?128:0),y&&(C.buf[C.pos++]=y&127|((y>>>=7)?128:0),y&&(C.buf[C.pos++]=y&127|((y>>>=7)?128:0),y&&(C.buf[C.pos++]=y&127)))))}function P(y,C,S){var Y=C<=16383?1:C<=2097151?2:C<=268435455?3:Math.floor(Math.log(C)/(Math.LN2*7));S.realloc(Y);for(var Z=S.pos-1;Z>=y;Z--)S.buf[Z+Y]=S.buf[Z]}function T(y,C){for(var S=0;S<y.length;S++)C.writeVarint(y[S])}function O(y,C){for(var S=0;S<y.length;S++)C.writeSVarint(y[S])}function A(y,C){for(var S=0;S<y.length;S++)C.writeFloat(y[S])}function w(y,C){for(var S=0;S<y.length;S++)C.writeDouble(y[S])}function M(y,C){for(var S=0;S<y.length;S++)C.writeBoolean(y[S])}function k(y,C){for(var S=0;S<y.length;S++)C.writeFixed32(y[S])}function F(y,C){for(var S=0;S<y.length;S++)C.writeSFixed32(y[S])}function I(y,C){for(var S=0;S<y.length;S++)C.writeFixed64(y[S])}function B(y,C){for(var S=0;S<y.length;S++)C.writeSFixed64(y[S])}function z(y,C){return(y[C]|y[C+1]<<8|y[C+2]<<16)+y[C+3]*16777216}function j(y,C,S){y[S]=C,y[S+1]=C>>>8,y[S+2]=C>>>16,y[S+3]=C>>>24}function H(y,C){return(y[C]|y[C+1]<<8|y[C+2]<<16)+(y[C+3]<<24)}function V(y,C,S){for(var Y="",Z=C;Z<S;){var K=y[Z],N=null,et=K>239?4:K>223?3:K>191?2:1;if(Z+et>S)break;var Q,ft,ct;et===1?K<128&&(N=K):et===2?(Q=y[Z+1],(Q&192)===128&&(N=(K&31)<<6|Q&63,N<=127&&(N=null))):et===3?(Q=y[Z+1],ft=y[Z+2],(Q&192)===128&&(ft&192)===128&&(N=(K&15)<<12|(Q&63)<<6|ft&63,(N<=2047||N>=55296&&N<=57343)&&(N=null))):et===4&&(Q=y[Z+1],ft=y[Z+2],ct=y[Z+3],(Q&192)===128&&(ft&192)===128&&(ct&192)===128&&(N=(K&15)<<18|(Q&63)<<12|(ft&63)<<6|ct&63,(N<=65535||N>=1114112)&&(N=null))),N===null?(N=65533,et=1):N>65535&&(N-=65536,Y+=String.fromCharCode(N>>>10&1023|55296),N=56320|N&1023),Y+=String.fromCharCode(N),Z+=et}return Y}function G(y,C,S){return u.decode(y.subarray(C,S))}function q(y,C,S){for(var Y=0,Z,K;Y<C.length;Y++){if(Z=C.charCodeAt(Y),Z>55295&&Z<57344)if(K)if(Z<56320){y[S++]=239,y[S++]=191,y[S++]=189,K=Z;continue}else Z=K-55296<<10|Z-56320|65536,K=null;else{Z>56319||Y+1===C.length?(y[S++]=239,y[S++]=191,y[S++]=189):K=Z;continue}else K&&(y[S++]=239,y[S++]=191,y[S++]=189,K=null);Z<128?y[S++]=Z:(Z<2048?y[S++]=Z>>6|192:(Z<65536?y[S++]=Z>>12|224:(y[S++]=Z>>18|240,y[S++]=Z>>12&63|128),y[S++]=Z>>6&63|128),y[S++]=Z&63|128)}return S}}}),Ju=se({"node_modules/rbush/rbush.min.js"(n,e){(function(i,o){typeof n=="object"&&typeof e<"u"?e.exports=o():typeof define=="function"&&define.amd?define(o):(i=i||self).RBush=o()})(n,function(){function i(w,M,k,F,I){(function B(z,j,H,V,G){for(;V>H;){if(V-H>600){var q=V-H+1,y=j-H+1,C=Math.log(q),S=.5*Math.exp(2*C/3),Y=.5*Math.sqrt(C*S*(q-S)/q)*(y-q/2<0?-1:1),Z=Math.max(H,Math.floor(j-y*S/q+Y)),K=Math.min(V,Math.floor(j+(q-y)*S/q+Y));B(z,j,Z,K,G)}var N=z[j],et=H,Q=V;for(o(z,H,j),G(z[V],N)>0&&o(z,H,V);et<Q;){for(o(z,et,Q),et++,Q--;G(z[et],N)<0;)et++;for(;G(z[Q],N)>0;)Q--}G(z[H],N)===0?o(z,H,Q):o(z,++Q,V),Q<=j&&(H=Q+1),j<=Q&&(V=Q-1)}})(w,M,k||0,F||w.length-1,I||s)}function o(w,M,k){var F=w[M];w[M]=w[k],w[k]=F}function s(w,M){return w<M?-1:w>M?1:0}var l=function(w){w===void 0&&(w=9),this._maxEntries=Math.max(4,w),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),this.clear()};function h(w,M,k){if(!k)return M.indexOf(w);for(var F=0;F<M.length;F++)if(k(w,M[F]))return F;return-1}function u(w,M){d(w,0,w.children.length,M,w)}function d(w,M,k,F,I){I||(I=O(null)),I.minX=1/0,I.minY=1/0,I.maxX=-1/0,I.maxY=-1/0;for(var B=M;B<k;B++){var z=w.children[B];_(I,w.leaf?F(z):z)}return I}function _(w,M){return w.minX=Math.min(w.minX,M.minX),w.minY=Math.min(w.minY,M.minY),w.maxX=Math.max(w.maxX,M.maxX),w.maxY=Math.max(w.maxY,M.maxY),w}function p(w,M){return w.minX-M.minX}function m(w,M){return w.minY-M.minY}function v(w){return(w.maxX-w.minX)*(w.maxY-w.minY)}function x(w){return w.maxX-w.minX+(w.maxY-w.minY)}function P(w,M){return w.minX<=M.minX&&w.minY<=M.minY&&M.maxX<=w.maxX&&M.maxY<=w.maxY}function T(w,M){return M.minX<=w.maxX&&M.minY<=w.maxY&&M.maxX>=w.minX&&M.maxY>=w.minY}function O(w){return{children:w,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function A(w,M,k,F,I){for(var B=[M,k];B.length;)if(!((k=B.pop())-(M=B.pop())<=F)){var z=M+Math.ceil((k-M)/F/2)*F;i(w,z,M,k,I),B.push(M,z,z,k)}}return l.prototype.all=function(){return this._all(this.data,[])},l.prototype.search=function(w){var M=this.data,k=[];if(!T(w,M))return k;for(var F=this.toBBox,I=[];M;){for(var B=0;B<M.children.length;B++){var z=M.children[B],j=M.leaf?F(z):z;T(w,j)&&(M.leaf?k.push(z):P(w,j)?this._all(z,k):I.push(z))}M=I.pop()}return k},l.prototype.collides=function(w){var M=this.data;if(!T(w,M))return!1;for(var k=[];M;){for(var F=0;F<M.children.length;F++){var I=M.children[F],B=M.leaf?this.toBBox(I):I;if(T(w,B)){if(M.leaf||P(w,B))return!0;k.push(I)}}M=k.pop()}return!1},l.prototype.load=function(w){if(!w||!w.length)return this;if(w.length<this._minEntries){for(var M=0;M<w.length;M++)this.insert(w[M]);return this}var k=this._build(w.slice(),0,w.length-1,0);if(this.data.children.length)if(this.data.height===k.height)this._splitRoot(this.data,k);else{if(this.data.height<k.height){var F=this.data;this.data=k,k=F}this._insert(k,this.data.height-k.height-1,!0)}else this.data=k;return this},l.prototype.insert=function(w){return w&&this._insert(w,this.data.height-1),this},l.prototype.clear=function(){return this.data=O([]),this},l.prototype.remove=function(w,M){if(!w)return this;for(var k,F,I,B=this.data,z=this.toBBox(w),j=[],H=[];B||j.length;){if(B||(B=j.pop(),F=j[j.length-1],k=H.pop(),I=!0),B.leaf){var V=h(w,B.children,M);if(V!==-1)return B.children.splice(V,1),j.push(B),this._condense(j),this}I||B.leaf||!P(B,z)?F?(k++,B=F.children[k],I=!1):B=null:(j.push(B),H.push(k),k=0,F=B,B=B.children[0])}return this},l.prototype.toBBox=function(w){return w},l.prototype.compareMinX=function(w,M){return w.minX-M.minX},l.prototype.compareMinY=function(w,M){return w.minY-M.minY},l.prototype.toJSON=function(){return this.data},l.prototype.fromJSON=function(w){return this.data=w,this},l.prototype._all=function(w,M){for(var k=[];w;)w.leaf?M.push.apply(M,w.children):k.push.apply(k,w.children),w=k.pop();return M},l.prototype._build=function(w,M,k,F){var I,B=k-M+1,z=this._maxEntries;if(B<=z)return u(I=O(w.slice(M,k+1)),this.toBBox),I;F||(F=Math.ceil(Math.log(B)/Math.log(z)),z=Math.ceil(B/Math.pow(z,F-1))),(I=O([])).leaf=!1,I.height=F;var j=Math.ceil(B/z),H=j*Math.ceil(Math.sqrt(z));A(w,M,k,H,this.compareMinX);for(var V=M;V<=k;V+=H){var G=Math.min(V+H-1,k);A(w,V,G,j,this.compareMinY);for(var q=V;q<=G;q+=j){var y=Math.min(q+j-1,G);I.children.push(this._build(w,q,y,F-1))}}return u(I,this.toBBox),I},l.prototype._chooseSubtree=function(w,M,k,F){for(;F.push(M),!M.leaf&&F.length-1!==k;){for(var I=1/0,B=1/0,z=void 0,j=0;j<M.children.length;j++){var H=M.children[j],V=v(H),G=(q=w,y=H,(Math.max(y.maxX,q.maxX)-Math.min(y.minX,q.minX))*(Math.max(y.maxY,q.maxY)-Math.min(y.minY,q.minY))-V);G<B?(B=G,I=V<I?V:I,z=H):G===B&&V<I&&(I=V,z=H)}M=z||M.children[0]}var q,y;return M},l.prototype._insert=function(w,M,k){var F=k?w:this.toBBox(w),I=[],B=this._chooseSubtree(F,this.data,M,I);for(B.children.push(w),_(B,F);M>=0&&I[M].children.length>this._maxEntries;)this._split(I,M),M--;this._adjustParentBBoxes(F,I,M)},l.prototype._split=function(w,M){var k=w[M],F=k.children.length,I=this._minEntries;this._chooseSplitAxis(k,I,F);var B=this._chooseSplitIndex(k,I,F),z=O(k.children.splice(B,k.children.length-B));z.height=k.height,z.leaf=k.leaf,u(k,this.toBBox),u(z,this.toBBox),M?w[M-1].children.push(z):this._splitRoot(k,z)},l.prototype._splitRoot=function(w,M){this.data=O([w,M]),this.data.height=w.height+1,this.data.leaf=!1,u(this.data,this.toBBox)},l.prototype._chooseSplitIndex=function(w,M,k){for(var F,I,B,z,j,H,V,G=1/0,q=1/0,y=M;y<=k-M;y++){var C=d(w,0,y,this.toBBox),S=d(w,y,k,this.toBBox),Y=(I=C,B=S,z=void 0,j=void 0,H=void 0,V=void 0,z=Math.max(I.minX,B.minX),j=Math.max(I.minY,B.minY),H=Math.min(I.maxX,B.maxX),V=Math.min(I.maxY,B.maxY),Math.max(0,H-z)*Math.max(0,V-j)),Z=v(C)+v(S);Y<G?(G=Y,F=y,q=Z<q?Z:q):Y===G&&Z<q&&(q=Z,F=y)}return F||k-M},l.prototype._chooseSplitAxis=function(w,M,k){var F=w.leaf?this.compareMinX:p,I=w.leaf?this.compareMinY:m;this._allDistMargin(w,M,k,F)<this._allDistMargin(w,M,k,I)&&w.children.sort(F)},l.prototype._allDistMargin=function(w,M,k,F){w.children.sort(F);for(var I=this.toBBox,B=d(w,0,M,I),z=d(w,k-M,k,I),j=x(B)+x(z),H=M;H<k-M;H++){var V=w.children[H];_(B,w.leaf?I(V):V),j+=x(B)}for(var G=k-M-1;G>=M;G--){var q=w.children[G];_(z,w.leaf?I(q):q),j+=x(z)}return j},l.prototype._adjustParentBBoxes=function(w,M,k){for(var F=k;F>=0;F--)_(M[F],w)},l.prototype._condense=function(w){for(var M=w.length-1,k=void 0;M>=0;M--)w[M].children.length===0?M>0?(k=w[M-1].children).splice(k.indexOf(w[M]),1):this.clear():u(w[M],this.toBBox)},l})}});jt(ae());function Xe(n,e,i){return Math.min(Math.max(n,i),e)}var Qu=class extends Error{constructor(n){super(`Failed to parse color: "${n}"`)}},Ci=Qu;function Ys(n){if(typeof n!="string")throw new Ci(n);if(n.trim().toLowerCase()==="transparent")return[0,0,0,0];let e=n.trim();e=ad.test(n)?id(n):n;const i=nd.exec(e);if(i){const h=Array.from(i).slice(1);return[...h.slice(0,3).map(u=>parseInt(Ii(u,2),16)),parseInt(Ii(h[3]||"f",2),16)/255]}const o=rd.exec(e);if(o){const h=Array.from(o).slice(1);return[...h.slice(0,3).map(u=>parseInt(u,16)),parseInt(h[3]||"ff",16)/255]}const s=od.exec(e);if(s){const h=Array.from(s).slice(1);return[...h.slice(0,3).map(u=>parseInt(u,10)),parseFloat(h[3]||"1")]}const l=sd.exec(e);if(l){const[h,u,d,_]=Array.from(l).slice(1).map(parseFloat);if(Xe(0,100,u)!==u)throw new Ci(n);if(Xe(0,100,d)!==d)throw new Ci(n);return[...ld(h,u,d),Number.isNaN(_)?1:_]}throw new Ci(n)}function td(n){let e=5381,i=n.length;for(;i;)e=e*33^n.charCodeAt(--i);return(e>>>0)%2341}var Xs=n=>parseInt(n.replace(/_/g,""),36),ed="1q29ehhb 1n09sgk7 1kl1ekf_ _yl4zsno 16z9eiv3 1p29lhp8 _bd9zg04 17u0____ _iw9zhe5 _to73___ _r45e31e _7l6g016 _jh8ouiv _zn3qba8 1jy4zshs 11u87k0u 1ro9yvyo 1aj3xael 1gz9zjz0 _3w8l4xo 1bf1ekf_ _ke3v___ _4rrkb__ 13j776yz _646mbhl _nrjr4__ _le6mbhl 1n37ehkb _m75f91n _qj3bzfz 1939yygw 11i5z6x8 _1k5f8xs 1509441m 15t5lwgf _ae2th1n _tg1ugcv 1lp1ugcv 16e14up_ _h55rw7n _ny9yavn _7a11xb_ 1ih442g9 _pv442g9 1mv16xof 14e6y7tu 1oo9zkds 17d1cisi _4v9y70f _y98m8kc 1019pq0v 12o9zda8 _348j4f4 1et50i2o _8epa8__ _ts6senj 1o350i2o 1mi9eiuo 1259yrp0 1ln80gnw _632xcoy 1cn9zldc _f29edu4 1n490c8q _9f9ziet 1b94vk74 _m49zkct 1kz6s73a 1eu9dtog _q58s1rz 1dy9sjiq __u89jo3 _aj5nkwg _ld89jo3 13h9z6wx _qa9z2ii _l119xgq _bs5arju 1hj4nwk9 1qt4nwk9 1ge6wau6 14j9zlcw 11p1edc_ _ms1zcxe _439shk6 _jt9y70f _754zsow 1la40eju _oq5p___ _x279qkz 1fa5r3rv _yd2d9ip _424tcku _8y1di2_ _zi2uabw _yy7rn9h 12yz980_ __39ljp6 1b59zg0x _n39zfzp 1fy9zest _b33k___ _hp9wq92 1il50hz4 _io472ub _lj9z3eo 19z9ykg0 _8t8iu3a 12b9bl4a 1ak5yw0o _896v4ku _tb8k8lv _s59zi6t _c09ze0p 1lg80oqn 1id9z8wb _238nba5 1kq6wgdi _154zssg _tn3zk49 _da9y6tc 1sg7cv4f _r12jvtt 1gq5fmkz 1cs9rvci _lp9jn1c _xw1tdnb 13f9zje6 16f6973h _vo7ir40 _bt5arjf _rc45e4t _hr4e100 10v4e100 _hc9zke2 _w91egv_ _sj2r1kk 13c87yx8 _vqpds__ _ni8ggk8 _tj9yqfb 1ia2j4r4 _7x9b10u 1fc9ld4j 1eq9zldr _5j9lhpx _ez9zl6o _md61fzm".split(" ").reduce((n,e)=>{const i=Xs(e.substring(0,3)),o=Xs(e.substring(3)).toString(16);let s="";for(let l=0;l<6-o.length;l++)s+="0";return n[i]=`${s}${o}`,n},{});function id(n){const e=n.toLowerCase().trim(),i=ed[td(e)];if(!i)throw new Ci(n);return`#${i}`}var Ii=(n,e)=>Array.from(Array(e)).map(()=>n).join(""),nd=new RegExp(`^#${Ii("([a-f0-9])",3)}([a-f0-9])?$`,"i"),rd=new RegExp(`^#${Ii("([a-f0-9]{2})",3)}([a-f0-9]{2})?$`,"i"),od=new RegExp(`^rgba?\\(\\s*(\\d+)\\s*${Ii(",\\s*(\\d+)\\s*",2)}(?:,\\s*([\\d.]+))?\\s*\\)$`,"i"),sd=/^hsla?\(\s*([\d.]+)\s*,\s*([\d.]+)%\s*,\s*([\d.]+)%(?:\s*,\s*([\d.]+))?\s*\)$/i,ad=/^[a-z]+$/i,Gs=n=>Math.round(n*255),ld=(n,e,i)=>{let o=i/100;if(e===0)return[o,o,o].map(Gs);const s=(n%360+360)%360/60,l=(1-Math.abs(2*o-1))*(e/100),h=l*(1-Math.abs(s%2-1));let u=0,d=0,_=0;s>=0&&s<1?(u=l,d=h):s>=1&&s<2?(u=h,d=l):s>=2&&s<3?(d=l,_=h):s>=3&&s<4?(d=h,_=l):s>=4&&s<5?(u=h,_=l):s>=5&&s<6&&(u=l,_=h);const p=o-l/2,m=u+p,v=d+p,x=_+p;return[m,v,x].map(Gs)};function hd(n,e,i,o){return`rgba(${Xe(0,255,n).toFixed()}, ${Xe(0,255,e).toFixed()}, ${Xe(0,255,i).toFixed()}, ${parseFloat(Xe(0,1,o).toFixed(3))})`}function gr(n,e,i){const o=(F,I)=>I===3?F:F/255,[s,l,h,u]=Ys(n).map(o),[d,_,p,m]=Ys(e).map(o),v=m-u,x=i*2-1,T=((x*v===-1?x:x+v/(1+x*v))+1)/2,O=1-T,A=(s*O+d*T)*255,w=(l*O+_*T)*255,M=(h*O+p*T)*255,k=m*i+u*(1-i);return hd(A,w,M,k)}var ke=jt(ae());jt(Xu());var Zt=class{constructor(n,e){this.str=n??e,this.perFeature=typeof this.str=="function"&&this.str.length===2}get(n,e){return typeof this.str=="function"?this.str(n,e):this.str}},wt=class{constructor(n,e=1){this.value=n??e,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(n,e){return typeof this.value=="function"?this.value(n,e):this.value}},Qa=class{constructor(n){var e;this.labelProps=(e=n==null?void 0:n.labelProps)!=null?e:["name"],this.textTransform=n==null?void 0:n.textTransform}get(n,e){let i,o;typeof this.labelProps=="function"?o=this.labelProps(n,e):o=this.labelProps;for(const l of o)if(Object.prototype.hasOwnProperty.call(e.props,l)&&typeof e.props[l]=="string"){i=e.props[l];break}let s;return typeof this.textTransform=="function"?s=this.textTransform(n,e):s=this.textTransform,i&&s==="uppercase"?i=i.toUpperCase():i&&s==="lowercase"?i=i.toLowerCase():i&&s==="capitalize"&&(i=i.toLowerCase().split(" ").map(u=>u[0].toUpperCase()+u.slice(1)).join(" ")),i}},tl=class{constructor(n){var e,i;n!=null&&n.font?this.font=n.font:(this.family=(e=n==null?void 0:n.fontFamily)!=null?e:"sans-serif",this.size=(i=n==null?void 0:n.fontSize)!=null?i:12,this.weight=n==null?void 0:n.fontWeight,this.style=n==null?void 0:n.fontStyle)}get(n,e){if(this.font)return typeof this.font=="function"?this.font(n,e):this.font;let i="";this.style&&(typeof this.style=="function"?i=`${this.style(n,e)} `:i=`${this.style} `);let o="";this.weight&&(typeof this.weight=="function"?o=`${this.weight(n,e)} `:o=`${this.weight} `);let s;typeof this.size=="function"?s=this.size(n,e):s=this.size;let l;return typeof this.family=="function"?l=this.family(n,e):l=this.family,`${i}${o}${s}px ${l}`}},cd=class{constructor(n,e=[]){this.value=n??e,this.perFeature=typeof this.value=="function"&&this.value.length===2}get(n,e){return typeof this.value=="function"?this.value(n,e):this.value}},qs=jt(ae()),ud=(n,e,i)=>{const o=[];let s,l,h,u=0,d=0,_=0,p=0,m=0,v=0,x=0,P=0,T=0,O=0,A=0,w=0;if(n.length<2)return[];if(n.length===2)return _=Math.sqrt(Rt(n[1].x-n[0].x,2)+Rt(n[1].y-n[0].y,2)),[{length:_,beginIndex:0,beginDistance:0,endIndex:2,endDistance:_}];for(p=Math.sqrt(Rt(n[1].x-n[0].x,2)+Rt(n[1].y-n[0].y,2)),u=1,d=n.length-1;u<d;u++)s=n[u-1],l=n[u],h=n[u+1],v=l.x-s.x,x=l.y-s.y,P=h.x-l.x,T=h.y-l.y,m=Math.sqrt(P*P+T*T),_+=p,O=Math.acos((v*P+x*T)/(p*m)),(O>e||_-w>i)&&(o.push({length:_-w,beginDistance:w,beginIndex:A,endIndex:u+1,endDistance:_}),A=u,w=_),p=m;return u-A>0&&o.push({length:_-w+m,beginIndex:A,beginDistance:w,endIndex:u+1,endDistance:_+m}),o};function dd(n,e,i,o){const s=[];for(const l of n){const h=ud(l,Math.PI/45,e);for(const u of h)if(u.length>=e+o){const d=new qs.default(l[u.beginIndex].x,l[u.beginIndex].y),_=l[u.endIndex-1],p=new qs.default((_.x-d.x)/u.length,(_.y-d.y)/u.length);for(let m=o;m<u.length-e;m+=i)s.push({start:d.add(p.mult(m)),end:d.add(p.mult(m+e))})}}return s}function fd(n,e,i,o){const s=e.x-n.x,l=e.y-n.y,h=Math.sqrt(Rt(e.x-n.x,2)+Rt(e.y-n.y,2)),u=[];for(let d=0;d<i+o;d+=2*o){const _=d*1/h;u.push({x:n.x+_*s,y:n.y+_*l})}return u}function el(n,e){if(n.length<=e)return[n];const i=e-1,o=n.lastIndexOf(" ",i),s=n.indexOf(" ",i);if(o===-1&&s===-1)return[n];let l,h;return s===-1||o>=0&&i-o<s-i?(l=n.substring(0,o),h=n.substring(o+1,n.length)):(l=n.substring(0,s),h=n.substring(s+1,n.length)),[l,...el(h,e)]}var pd=jt(ae()),_d=jt(qu()),gd=jt($u()),Mt=(n,e,i)=>new Promise((o,s)=>{var l=d=>{try{u(i.next(d))}catch(_){s(_)}},h=d=>{try{u(i.throw(d))}catch(_){s(_)}},u=d=>d.done?o(d.value):Promise.resolve(d.value).then(l,h);u((i=i.apply(n,e)).next())}),zt=Uint8Array,$e=Uint16Array,il=Uint32Array,nl=new zt([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),rl=new zt([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),md=new zt([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ol=function(n,e){for(var i=new $e(31),o=0;o<31;++o)i[o]=e+=1<<n[o-1];for(var s=new il(i[30]),o=1;o<30;++o)for(var l=i[o];l<i[o+1];++l)s[l]=l-i[o]<<5|o;return[i,s]},sl=ol(nl,2),al=sl[0],yd=sl[1];al[28]=258,yd[258]=28;var vd=ol(rl,0),wd=vd[0],ll=new $e(32768);for(at=0;at<32768;++at)re=(at&43690)>>>1|(at&21845)<<1,re=(re&52428)>>>2|(re&13107)<<2,re=(re&61680)>>>4|(re&3855)<<4,ll[at]=((re&65280)>>>8|(re&255)<<8)>>>1;var re,at,Si=function(n,e,i){for(var o=n.length,s=0,l=new $e(e);s<o;++s)n[s]&&++l[n[s]-1];var h=new $e(e);for(s=0;s<e;++s)h[s]=h[s-1]+l[s-1]<<1;var u;{u=new $e(1<<e);var d=15-e;for(s=0;s<o;++s)if(n[s])for(var _=s<<4|n[s],p=e-n[s],m=h[n[s]-1]++<<p,v=m|(1<<p)-1;m<=v;++m)u[ll[m]>>>d]=_}return u},Bi=new zt(288);for(at=0;at<144;++at)Bi[at]=8;var at;for(at=144;at<256;++at)Bi[at]=9;var at;for(at=256;at<280;++at)Bi[at]=7;var at;for(at=280;at<288;++at)Bi[at]=8;var at,hl=new zt(32);for(at=0;at<32;++at)hl[at]=5;var at,xd=Si(Bi,9),bd=Si(hl,5),mr=function(n){for(var e=n[0],i=1;i<n.length;++i)n[i]>e&&(e=n[i]);return e},Vt=function(n,e,i){var o=e/8|0;return(n[o]|n[o+1]<<8)>>(e&7)&i},yr=function(n,e){var i=e/8|0;return(n[i]|n[i+1]<<8|n[i+2]<<16)>>(e&7)},Pd=function(n){return(n+7)/8|0},Cd=function(n,e,i){(i==null||i>n.length)&&(i=n.length);var o=new(n.BYTES_PER_ELEMENT==2?$e:n.BYTES_PER_ELEMENT==4?il:zt)(i-e);return o.set(n.subarray(e,i)),o},Md=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Xt=function(n,e,i){var o=new Error(e||Md[n]);if(o.code=n,Error.captureStackTrace&&Error.captureStackTrace(o,Xt),!i)throw o;return o},Xr=function(n,e,i){var o=n.length;if(!o||i&&i.f&&!i.l)return e||new zt(0);var s=!e||i,l=!i||i.i;i||(i={}),e||(e=new zt(o*3));var h=function(lt){var Dt=e.length;if(lt>Dt){var Nt=new zt(Math.max(Dt*2,lt));Nt.set(e),e=Nt}},u=i.f||0,d=i.p||0,_=i.b||0,p=i.l,m=i.d,v=i.m,x=i.n,P=o*8;do{if(!p){u=Vt(n,d,1);var T=Vt(n,d+1,3);if(d+=3,T)if(T==1)p=xd,m=bd,v=9,x=5;else if(T==2){var M=Vt(n,d,31)+257,k=Vt(n,d+10,15)+4,F=M+Vt(n,d+5,31)+1;d+=14;for(var I=new zt(F),B=new zt(19),z=0;z<k;++z)B[md[z]]=Vt(n,d+z*3,7);d+=k*3;for(var j=mr(B),H=(1<<j)-1,V=Si(B,j),z=0;z<F;){var G=V[Vt(n,d,H)];d+=G&15;var O=G>>>4;if(O<16)I[z++]=O;else{var q=0,y=0;for(O==16?(y=3+Vt(n,d,3),d+=2,q=I[z-1]):O==17?(y=3+Vt(n,d,7),d+=3):O==18&&(y=11+Vt(n,d,127),d+=7);y--;)I[z++]=q}}var C=I.subarray(0,M),S=I.subarray(M);v=mr(C),x=mr(S),p=Si(C,v),m=Si(S,x)}else Xt(1);else{var O=Pd(d)+4,A=n[O-4]|n[O-3]<<8,w=O+A;if(w>o){l&&Xt(0);break}s&&h(_+A),e.set(n.subarray(O,w),_),i.b=_+=A,i.p=d=w*8,i.f=u;continue}if(d>P){l&&Xt(0);break}}s&&h(_+131072);for(var Y=(1<<v)-1,Z=(1<<x)-1,K=d;;K=d){var q=p[yr(n,d)&Y],N=q>>>4;if(d+=q&15,d>P){l&&Xt(0);break}if(q||Xt(2),N<256)e[_++]=N;else if(N==256){K=d,p=null;break}else{var et=N-254;if(N>264){var z=N-257,Q=nl[z];et=Vt(n,d,(1<<Q)-1)+al[z],d+=Q}var ft=m[yr(n,d)&Z],ct=ft>>>4;ft||Xt(3),d+=ft&15;var S=wd[ct];if(ct>3){var Q=rl[ct];S+=yr(n,d)&(1<<Q)-1,d+=Q}if(d>P){l&&Xt(0);break}s&&h(_+131072);for(var st=_+et;_<st;_+=4)e[_]=e[_-S],e[_+1]=e[_+1-S],e[_+2]=e[_+2-S],e[_+3]=e[_+3-S];_=st}}i.l=p,i.p=K,i.b=_,i.f=u,p&&(u=1,i.m=v,i.d=m,i.n=x)}while(!u);return _==e.length?e:Cd(e,0,_)},kd=new zt(0),Ld=function(n){(n[0]!=31||n[1]!=139||n[2]!=8)&&Xt(6,"invalid gzip data");var e=n[3],i=10;e&4&&(i+=n[10]|(n[11]<<8)+2);for(var o=(e>>3&1)+(e>>4&1);o>0;o-=!n[i++]);return i+(e&2)},Sd=function(n){var e=n.length;return(n[e-4]|n[e-3]<<8|n[e-2]<<16|n[e-1]<<24)>>>0},Ed=function(n){((n[0]&15)!=8||n[0]>>>4>7||(n[0]<<8|n[1])%31)&&Xt(6,"invalid zlib data"),n[1]&32&&Xt(6,"invalid zlib data: preset dictionaries not supported")};function Td(n,e){return Xr(n,e)}function zd(n,e){return Xr(n.subarray(Ld(n),-8),new zt(Sd(n)))}function Id(n,e){return Xr((Ed(n),n.subarray(2,-4)),e)}function Er(n,e){return n[0]==31&&n[1]==139&&n[2]==8?zd(n):(n[0]&15)!=8||n[0]>>4>7||(n[0]<<8|n[1])%31?Td(n,e):Id(n,e)}var Dd=typeof TextDecoder<"u"&&new TextDecoder,Od=0;try{Dd.decode(kd,{stream:!0}),Od=1}catch{}var cl=(n,e)=>n*Math.pow(2,e),vi=(n,e)=>Math.floor(n/Math.pow(2,e)),kn=(n,e)=>cl(n.getUint16(e+1,!0),8)+n.getUint8(e),ul=(n,e)=>cl(n.getUint32(e+2,!0),16)+n.getUint16(e,!0),Ad=(n,e,i,o,s)=>{if(n!=o.getUint8(s))return n-o.getUint8(s);const l=kn(o,s+1);if(e!=l)return e-l;const h=kn(o,s+4);return i!=h?i-h:0},Bd=(n,e,i,o)=>{const s=dl(n,e|128,i,o);return s?{z:e,x:i,y:o,offset:s[0],length:s[1],is_dir:!0}:null},Ks=(n,e,i,o)=>{const s=dl(n,e,i,o);return s?{z:e,x:i,y:o,offset:s[0],length:s[1],is_dir:!1}:null},dl=(n,e,i,o)=>{let s=0,l=n.byteLength/17-1;for(;s<=l;){const h=l+s>>1,u=Ad(e,i,o,n,h*17);if(u>0)s=h+1;else if(u<0)l=h-1;else return[ul(n,h*17+7),n.getUint32(h*17+13,!0)]}return null},Fd=(n,e)=>n.is_dir&&!e.is_dir?1:!n.is_dir&&e.is_dir?-1:n.z!==e.z?n.z-e.z:n.x!==e.x?n.x-e.x:n.y-e.y,fl=(n,e)=>{const i=n.getUint8(e*17);return{z:i&127,x:kn(n,e*17+1),y:kn(n,e*17+4),offset:ul(n,e*17+7),length:n.getUint32(e*17+13,!0),is_dir:i>>7===1}},$s=n=>{const e=[],i=new DataView(n);for(let o=0;o<i.byteLength/17;o++)e.push(fl(i,o));return Rd(e)},Rd=n=>{n.sort(Fd);const e=new ArrayBuffer(17*n.length),i=new Uint8Array(e);for(let o=0;o<n.length;o++){const s=n[o];let l=s.z;s.is_dir&&(l=l|128),i[o*17]=l,i[o*17+1]=s.x&255,i[o*17+2]=s.x>>8&255,i[o*17+3]=s.x>>16&255,i[o*17+4]=s.y&255,i[o*17+5]=s.y>>8&255,i[o*17+6]=s.y>>16&255,i[o*17+7]=s.offset&255,i[o*17+8]=vi(s.offset,8)&255,i[o*17+9]=vi(s.offset,16)&255,i[o*17+10]=vi(s.offset,24)&255,i[o*17+11]=vi(s.offset,32)&255,i[o*17+12]=vi(s.offset,48)&255,i[o*17+13]=s.length&255,i[o*17+14]=s.length>>8&255,i[o*17+15]=s.length>>16&255,i[o*17+16]=s.length>>24&255}return e},Zd=(n,e)=>{if(n.byteLength<17)return null;const i=n.byteLength/17,o=fl(n,i-1);if(o.is_dir){const s=o.z,l=e.z-s,h=Math.trunc(e.x/(1<<l)),u=Math.trunc(e.y/(1<<l));return{z:s,x:h,y:u}}return null};function jd(n){return Mt(this,null,function*(){const e=yield n.getBytes(0,512e3),i=new DataView(e.data),o=i.getUint32(4,!0),s=i.getUint16(8,!0),l=new TextDecoder("utf-8"),h=JSON.parse(l.decode(new DataView(e.data,10,o)));let u=0;h.compression==="gzip"&&(u=2);let d=0;"minzoom"in h&&(d=+h.minzoom);let _=0;"maxzoom"in h&&(_=+h.maxzoom);let p=0,m=0,v=0,x=-180,P=-85,T=180,O=85;if(h.bounds){const w=h.bounds.split(",");x=+w[0],P=+w[1],T=+w[2],O=+w[3]}if(h.center){const w=h.center.split(",");p=+w[0],m=+w[1],v=+w[2]}return{specVersion:i.getUint16(2,!0),rootDirectoryOffset:10+o,rootDirectoryLength:s*17,jsonMetadataOffset:10,jsonMetadataLength:o,leafDirectoryOffset:0,leafDirectoryLength:void 0,tileDataOffset:0,tileDataLength:void 0,numAddressedTiles:0,numTileEntries:0,numTileContents:0,clustered:!1,internalCompression:1,tileCompression:u,tileType:1,minZoom:d,maxZoom:_,minLon:x,minLat:P,maxLon:T,maxLat:O,centerZoom:v,centerLon:p,centerLat:m,etag:e.etag}})}function Nd(n,e,i,o,s,l,h){return Mt(this,null,function*(){let u=yield i.getArrayBuffer(e,n.rootDirectoryOffset,n.rootDirectoryLength,n);n.specVersion===1&&(u=$s(u));const d=Ks(new DataView(u),o,s,l);if(d){let m=(yield e.getBytes(d.offset,d.length,h)).data;const v=new DataView(m);return v.getUint8(0)==31&&v.getUint8(1)==139&&(m=Er(new Uint8Array(m))),{data:m}}const _=Zd(new DataView(u),{z:o,x:s,y:l});if(_){const p=Bd(new DataView(u),_.z,_.x,_.y);if(p){let m=yield i.getArrayBuffer(e,p.offset,p.length,n);n.specVersion===1&&(m=$s(m));const v=Ks(new DataView(m),o,s,l);if(v){let P=(yield e.getBytes(v.offset,v.length,h)).data;const T=new DataView(P);return T.getUint8(0)==31&&T.getUint8(1)==139&&(P=Er(new Uint8Array(P))),{data:P}}}}})}var pl={getHeader:jd,getZxy:Nd};function je(n,e){return(e>>>0)*4294967296+(n>>>0)}function Wd(n,e){const i=e.buf;let o,s;if(s=i[e.pos++],o=(s&112)>>4,s<128||(s=i[e.pos++],o|=(s&127)<<3,s<128)||(s=i[e.pos++],o|=(s&127)<<10,s<128)||(s=i[e.pos++],o|=(s&127)<<17,s<128)||(s=i[e.pos++],o|=(s&127)<<24,s<128)||(s=i[e.pos++],o|=(s&1)<<31,s<128))return je(n,o);throw new Error("Expected varint not more than 10 bytes")}function wi(n){const e=n.buf;let i,o;return o=e[n.pos++],i=o&127,o<128||(o=e[n.pos++],i|=(o&127)<<7,o<128)||(o=e[n.pos++],i|=(o&127)<<14,o<128)||(o=e[n.pos++],i|=(o&127)<<21,o<128)?i:(o=e[n.pos],i|=(o&15)<<28,Wd(i,n))}function Ud(n,e,i,o){if(o==0){i==1&&(e[0]=n-1-e[0],e[1]=n-1-e[1]);const s=e[0];e[0]=e[1],e[1]=s}}function Vd(n,e,i){if(n>26)throw Error("Tile zoom level exceeds max safe number limit (26)");if(e>Math.pow(2,n)-1||i>Math.pow(2,n)-1)throw Error("tile x/y outside zoom level bounds");let o=0,s=0;for(;s<n;)o+=Math.pow(2,s)*Math.pow(2,s),s++;const l=Math.pow(2,n);let h=0,u=0,d=0;const _=[e,i];let p=l/2;for(;p>0;)h=(_[0]&p)>0?1:0,u=(_[1]&p)>0?1:0,d+=p*p*(3*h^u),Ud(p,_,h,u),p=p/2;return o+d}function _l(n,e){return Mt(this,null,function*(){if(e===1||e===0)return n;if(e===2)return Er(new Uint8Array(n));throw Error("Compression method not supported")})}var Hd=127;function Yd(n,e){let i=0,o=n.length-1;for(;i<=o;){const s=o+i>>1,l=e-n[s].tileId;if(l>0)i=s+1;else if(l<0)o=s-1;else return n[s]}return o>=0&&(n[o].runLength===0||e-n[o].tileId<n[o].runLength)?n[o]:null}var Xd=class{constructor(n){this.url=n}getKey(){return this.url}getBytes(n,e,i){return Mt(this,null,function*(){let o;i||(o=new AbortController,i=o.signal);let s=yield fetch(this.url,{signal:i,headers:{Range:"bytes="+n+"-"+(n+e-1)}});if(s.status===416&&n===0){const u=s.headers.get("Content-Range");if(!u||!u.startsWith("bytes */"))throw Error("Missing content-length on 416 response");const d=+u.substr(8);s=yield fetch(this.url,{signal:i,headers:{Range:"bytes=0-"+(d-1)}})}if(s.status>=300)throw Error("Bad response code: "+s.status);const l=s.headers.get("Content-Length");if(s.status===200&&(!l||+l>e))throw o&&o.abort(),Error("Server returned no content-length header or content-length exceeding request. Check that your storage backend supports HTTP Byte Serving.");return{data:yield s.arrayBuffer(),etag:s.headers.get("ETag")||void 0,cacheControl:s.headers.get("Cache-Control")||void 0,expires:s.headers.get("Expires")||void 0}})}};function Ht(n,e){const i=n.getUint32(e+4,!0),o=n.getUint32(e+0,!0);return i*Math.pow(2,32)+o}function Gd(n,e){const i=new DataView(n),o=i.getUint8(7);if(o>3)throw Error(`Archive is spec version ${o} but this library supports up to spec version 3`);return{specVersion:o,rootDirectoryOffset:Ht(i,8),rootDirectoryLength:Ht(i,16),jsonMetadataOffset:Ht(i,24),jsonMetadataLength:Ht(i,32),leafDirectoryOffset:Ht(i,40),leafDirectoryLength:Ht(i,48),tileDataOffset:Ht(i,56),tileDataLength:Ht(i,64),numAddressedTiles:Ht(i,72),numTileEntries:Ht(i,80),numTileContents:Ht(i,88),clustered:i.getUint8(96)===1,internalCompression:i.getUint8(97),tileCompression:i.getUint8(98),tileType:i.getUint8(99),minZoom:i.getUint8(100),maxZoom:i.getUint8(101),minLon:i.getInt32(102,!0)/1e7,minLat:i.getInt32(106,!0)/1e7,maxLon:i.getInt32(110,!0)/1e7,maxLat:i.getInt32(114,!0)/1e7,centerZoom:i.getUint8(118),centerLon:i.getInt32(119,!0)/1e7,centerLat:i.getInt32(123,!0)/1e7,etag:e}}function gl(n){const e={buf:new Uint8Array(n),pos:0},i=wi(e),o=[];let s=0;for(let l=0;l<i;l++){const h=wi(e);o.push({tileId:s+h,offset:0,length:0,runLength:1}),s+=h}for(let l=0;l<i;l++)o[l].runLength=wi(e);for(let l=0;l<i;l++)o[l].length=wi(e);for(let l=0;l<i;l++){const h=wi(e);h===0&&l>0?o[l].offset=o[l-1].offset+o[l-1].length:o[l].offset=h-1}return o}function qd(n){const e=new DataView(n);return e.getUint16(2,!0)===2?(console.warn("PMTiles spec version 2 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),2):e.getUint16(2,!0)===1?(console.warn("PMTiles spec version 1 has been deprecated; please see github.com/protomaps/PMTiles for tools to upgrade"),1):3}var Ge=class extends Error{};function Kd(n,e,i,o){return Mt(this,null,function*(){const s=yield n.getBytes(0,16384);if(new DataView(s.data).getUint16(0,!0)!==19792)throw new Error("Wrong magic number for PMTiles archive");if(qd(s.data)<3)return[yield pl.getHeader(n)];const h=s.data.slice(0,Hd);let u=s.etag;o&&s.etag!=o&&(console.warn("ETag conflict detected; your HTTP server might not support content-based ETag headers. ETags disabled for "+n.getKey()),u=void 0);const d=Gd(h,u);if(i){const _=s.data.slice(d.rootDirectoryOffset,d.rootDirectoryOffset+d.rootDirectoryLength),p=n.getKey()+"|"+(d.etag||"")+"|"+d.rootDirectoryOffset+"|"+d.rootDirectoryLength,m=gl(yield e(_,d.internalCompression));return[d,[p,m.length,m]]}return[d,void 0]})}function $d(n,e,i,o,s){return Mt(this,null,function*(){const l=yield n.getBytes(i,o);if(s.etag&&s.etag!==l.etag)throw new Ge(l.etag);const h=yield e(l.data,s.internalCompression),u=gl(h);if(u.length===0)throw new Error("Empty directory is invalid");return u})}var Jd=class{constructor(n=100,e=!0,i=_l){this.cache=new Map,this.maxCacheEntries=n,this.counter=1,this.prefetch=e,this.decompress=i}getHeader(n,e){return Mt(this,null,function*(){const i=n.getKey();if(this.cache.has(i))return this.cache.get(i).lastUsed=this.counter++,yield this.cache.get(i).data;const o=new Promise((s,l)=>{Kd(n,this.decompress,this.prefetch,e).then(h=>{h[1]&&this.cache.set(h[1][0],{lastUsed:this.counter++,data:Promise.resolve(h[1][2])}),s(h[0]),this.prune()}).catch(h=>{l(h)})});return this.cache.set(i,{lastUsed:this.counter++,data:o}),o})}getDirectory(n,e,i,o){return Mt(this,null,function*(){const s=n.getKey()+"|"+(o.etag||"")+"|"+e+"|"+i;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const l=new Promise((h,u)=>{$d(n,this.decompress,e,i,o).then(d=>{h(d),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:l}),l})}getArrayBuffer(n,e,i,o){return Mt(this,null,function*(){const s=n.getKey()+"|"+(o.etag||"")+"|"+e+"|"+i;if(this.cache.has(s))return this.cache.get(s).lastUsed=this.counter++,yield this.cache.get(s).data;const l=new Promise((h,u)=>{n.getBytes(e,i).then(d=>{if(o.etag&&o.etag!==d.etag)throw new Ge(d.etag);h(d.data),this.cache.has(s),this.prune()}).catch(d=>{u(d)})});return this.cache.set(s,{lastUsed:this.counter++,data:l}),l})}prune(){if(this.cache.size>=this.maxCacheEntries){let n=1/0,e;this.cache.forEach((i,o)=>{i.lastUsed<n&&(n=i.lastUsed,e=o)}),e&&this.cache.delete(e)}}invalidate(n,e){return Mt(this,null,function*(){this.cache.delete(n.getKey()),yield this.getHeader(n,e)})}},Qd=class{constructor(n,e,i){typeof n=="string"?this.source=new Xd(n):this.source=n,i?this.decompress=i:this.decompress=_l,e?this.cache=e:this.cache=new Jd}getHeader(){return Mt(this,null,function*(){return yield this.cache.getHeader(this.source)})}getZxyAttempt(n,e,i,o){return Mt(this,null,function*(){const s=Vd(n,e,i),l=yield this.cache.getHeader(this.source);if(l.specVersion<3)return pl.getZxy(l,this.source,this.cache,n,e,i,o);if(n<l.minZoom||n>l.maxZoom)return;let h=l.rootDirectoryOffset,u=l.rootDirectoryLength;for(let d=0;d<=3;d++){const _=yield this.cache.getDirectory(this.source,h,u,l),p=Yd(_,s);if(p)if(p.runLength>0){const m=yield this.source.getBytes(l.tileDataOffset+p.offset,p.length,o);if(l.etag&&l.etag!==m.etag)throw new Ge(m.etag);return{data:yield this.decompress(m.data,l.tileCompression),cacheControl:m.cacheControl,expires:m.expires}}else h=l.leafDirectoryOffset+p.offset,u=p.length;else return}throw Error("Maximum directory depth exceeded")})}getZxy(n,e,i,o){return Mt(this,null,function*(){try{return yield this.getZxyAttempt(n,e,i,o)}catch(s){if(s instanceof Ge)return this.cache.invalidate(this.source,s.message),yield this.getZxyAttempt(n,e,i,o);throw s}})}getMetadataAttempt(){return Mt(this,null,function*(){const n=yield this.cache.getHeader(this.source),e=yield this.source.getBytes(n.jsonMetadataOffset,n.jsonMetadataLength);if(n.etag&&n.etag!==e.etag)throw new Ge(e.etag);const i=yield this.decompress(e.data,n.internalCompression),o=new TextDecoder("utf-8");return JSON.parse(o.decode(i))})}getMetadata(){return Mt(this,null,function*(){try{return yield this.getMetadataAttempt()}catch(n){if(n instanceof Ge)return this.cache.invalidate(this.source,n.message),yield this.getMetadataAttempt();throw n}})}};function Je(n){return`${n.x}:${n.y}:${n.z}`}var tf=(n,e,i)=>{n.pos=e;const o=n.readVarint()+n.pos;let s=1,l=0,h=0,u=0,d=1/0,_=-1/0,p=1/0,m=-1/0;const v=[];let x=[];for(;n.pos<o;){if(l<=0){const P=n.readVarint();s=P&7,l=P>>3}if(l--,s===1||s===2)h+=n.readSVarint()*i,u+=n.readSVarint()*i,h<d&&(d=h),h>_&&(_=h),u<p&&(p=u),u>m&&(m=u),s===1&&(x.length>0&&v.push(x),x=[]),x.push(new pd.default(h,u));else if(s===7)x&&x.push(x[0].clone());else throw new Error(`unknown command ${s}`)}return x&&v.push(x),{geom:v,bbox:{minX:d,minY:p,maxX:_,maxY:m}}};function ml(n,e){const i=new _d.VectorTile(new gd.default(n)),o=new Map;for(const[s,l]of Object.entries(i.layers)){const h=[],u=l;for(let d=0;d<u.length;d++){const _=tf(u.feature(d)._pbf,u.feature(d)._geometry,e/u.extent);let p=0;for(const m of _.geom)p+=m.length;h.push({id:u.feature(d).id,geomType:u.feature(d).type,geom:_.geom,numVertices:p,bbox:_.bbox,props:u.feature(d).properties})}o.set(s,h)}return o}var Js=class{constructor(n,e){typeof n=="string"?this.p=new Qd(n):this.p=n,this.zoomaborts=[],this.shouldCancelZooms=e}get(n,e){return ni(this,null,function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter(l=>l.z!==n.z?(l.controller.abort(),!1):!0));const i=new AbortController;this.zoomaborts.push({z:n.z,controller:i});const o=i.signal,s=yield this.p.getZxy(n.z,n.x,n.y,o);return s?ml(s.data,e):new Map})}},ef=class{constructor(n,e){this.url=n,this.zoomaborts=[],this.shouldCancelZooms=e}get(n,e){return ni(this,null,function*(){this.shouldCancelZooms&&(this.zoomaborts=this.zoomaborts.filter(l=>l.z!==n.z?(l.controller.abort(),!1):!0));const i=this.url.replace("{z}",n.z.toString()).replace("{x}",n.x.toString()).replace("{y}",n.y.toString()),o=new AbortController;this.zoomaborts.push({z:n.z,controller:o});const s=o.signal;return new Promise((l,h)=>{fetch(i,{signal:s}).then(u=>u.arrayBuffer()).then(u=>{const d=ml(u,e);l(d)}).catch(u=>{h(u)})})})}},nf=class{constructor(n,e){this.source=n,this.cache=new Map,this.inflight=new Map,this.tileSize=e}get(n){return ni(this,null,function*(){const e=Je(n);return new Promise((i,o)=>{const s=this.cache.get(e);if(s)s.used=performance.now(),i(s.data);else{const l=this.inflight.get(e);l?l.push({resolve:i,reject:o}):(this.inflight.set(e,[]),this.source.get(n,this.tileSize).then(h=>{this.cache.set(e,{used:performance.now(),data:h});const u=this.inflight.get(e);if(u)for(const d of u)d.resolve(h);if(this.inflight.delete(e),i(h),this.cache.size>=64){let d=1/0,_;this.cache.forEach((p,m)=>{p.used<d&&(d=p.used,_=m)}),_&&this.cache.delete(_)}}).catch(h=>{const u=this.inflight.get(e);if(u)for(const d of u)d.reject(h);this.inflight.delete(e),o(h)}))}})})}},bt=class{constructor(n){var e;this.pattern=n.pattern,this.fill=new Zt(n.fill,"black"),this.opacity=new wt(n.opacity,1),this.stroke=new Zt(n.stroke,"black"),this.width=new wt(n.width,0),this.perFeature=(e=this.fill.perFeature||this.opacity.perFeature||this.stroke.perFeature||this.width.perFeature||n.perFeature)!=null?e:!1,this.doStroke=!1}before(n,e){if(!this.perFeature){n.globalAlpha=this.opacity.get(e),n.fillStyle=this.fill.get(e),n.strokeStyle=this.stroke.get(e);const i=this.width.get(e);i>0&&(this.doStroke=!0),n.lineWidth=i}if(this.pattern){const i=n.createPattern(this.pattern,"repeat");i&&(n.fillStyle=i)}}draw(n,e,i,o){let s=!1;if(this.perFeature){n.globalAlpha=this.opacity.get(i,o),n.fillStyle=this.fill.get(i,o);const h=this.width.get(i,o);h&&(s=!0,n.strokeStyle=this.stroke.get(i,o),n.lineWidth=h)}const l=()=>{n.fill(),(s||this.doStroke)&&n.stroke()};n.beginPath();for(const h of e)for(let u=0;u<h.length;u++){const d=h[u];u===0?n.moveTo(d.x,d.y):n.lineTo(d.x,d.y)}l()}};function rf(n,e){let i=0;for(;e[i+1][0]<n;)i++;return i}function of(n,e,i){return n*(i-e)+e}function sf(n,e,i,o){const s=o[e+1][0]-o[e][0],l=n-o[e][0];return s===0?0:i===1?l/s:(Rt(i,l)-1)/(Rt(i,s)-1)}function Yt(n,e){return i=>{if(e.length<1)return 0;if(i<=e[0][0])return e[0][1];if(i>=e[e.length-1][0])return e[e.length-1][1];const o=rf(i,e),s=sf(i,o,n,e);return of(s,e[o][1],e[o+1][1])}}function Qs(n){return Yt(1,n)}var St=class{constructor(n){var e;this.color=new Zt(n.color,"black"),this.width=new wt(n.width),this.opacity=new wt(n.opacity),this.dash=n.dash?new cd(n.dash):null,this.dashColor=new Zt(n.dashColor,"black"),this.dashWidth=new wt(n.dashWidth,1),this.lineCap=new Zt(n.lineCap,"butt"),this.lineJoin=new Zt(n.lineJoin,"miter"),this.skip=!1,this.perFeature=!!((e=this.dash)!=null&&e.perFeature||this.color.perFeature||this.opacity.perFeature||this.width.perFeature||this.lineCap.perFeature||this.lineJoin.perFeature||n.perFeature)}before(n,e){this.perFeature||(n.strokeStyle=this.color.get(e),n.lineWidth=this.width.get(e),n.globalAlpha=this.opacity.get(e),n.lineCap=this.lineCap.get(e),n.lineJoin=this.lineJoin.get(e))}draw(n,e,i,o){if(this.skip)return;const s=()=>{this.perFeature&&(n.globalAlpha=this.opacity.get(i,o),n.lineCap=this.lineCap.get(i,o),n.lineJoin=this.lineJoin.get(i,o)),this.dash?(n.save(),this.perFeature?(n.lineWidth=this.dashWidth.get(i,o),n.strokeStyle=this.dashColor.get(i,o),n.setLineDash(this.dash.get(i,o))):n.setLineDash(this.dash.get(i)),n.stroke(),n.restore()):(n.save(),this.perFeature&&(n.lineWidth=this.width.get(i,o),n.strokeStyle=this.color.get(i,o)),n.stroke(),n.restore())};n.beginPath();for(const l of e)for(let h=0;h<l.length;h++){const u=l[h];h===0?n.moveTo(u.x,u.y):n.lineTo(u.x,u.y)}s()}},af=class{constructor(n){this.radius=new wt(n.radius,3),this.fill=new Zt(n.fill,"black"),this.stroke=new Zt(n.stroke,"white"),this.width=new wt(n.width,0),this.opacity=new wt(n.opacity)}draw(n,e,i,o){n.globalAlpha=this.opacity.get(i,o);const s=this.radius.get(i,o),l=this.width.get(i,o);l>0&&(n.strokeStyle=this.stroke.get(i,o),n.lineWidth=l,n.beginPath(),n.arc(e[0][0].x,e[0][0].y,s+l/2,0,2*Math.PI),n.stroke()),n.fillStyle=this.fill.get(i,o),n.beginPath(),n.arc(e[0][0].x,e[0][0].y,s,0,2*Math.PI),n.fill()}place(n,e,i){e[0];const o=new ke.default(e[0][0].x,e[0][0].y),s=this.radius.get(n.zoom,i),l={minX:o.x-s,minY:o.y-s,maxX:o.x+s,maxY:o.y+s};return[{anchor:o,bboxes:[l],draw:u=>{this.draw(u,[[new ke.default(0,0)]],n.zoom,i)}}]}},lf=(n,e)=>({minX:Math.min(n.minX,e.minX),minY:Math.min(n.minY,e.minY),maxX:Math.max(n.maxX,e.maxX),maxY:Math.max(n.maxY,e.maxY)}),hf=class{constructor(n){this.list=n}place(n,e,i){const o=this.list[0];if(!o)return;let s=o.place(n,e,i);if(!s)return;let l=s[0];const h=l.anchor;let u=l.bboxes[0];const d=[l.draw];for(let p=1;p<this.list.length;p++){if(s=this.list[p].place(n,e,i),!s)return;l=s[0],u=lf(u,l.bboxes[0]),d.push(l.draw)}return[{anchor:h,bboxes:[u],draw:p=>{for(const m of d)m(p)}}]}},cf=class{constructor(n){this.symbolizer=n}place(n,e,i){const o=e[0][0],s=this.symbolizer.place(n,[[new ke.default(0,0)]],i);if(!s||s.length===0)return;const l=s[0],h=l.bboxes[0],u=h.maxX-h.minX,d=h.maxY-h.minY,_={minX:o.x-u/2,maxX:o.x+u/2,minY:o.y-d/2,maxY:o.y+d/2};return[{anchor:o,bboxes:[_],draw:m=>{m.translate(-u/2,d/2-h.maxY),l.draw(m,{justify:2})}}]}},yl=class{constructor(n){this.font=new tl(n),this.text=new Qa(n),this.fill=new Zt(n.fill,"black"),this.stroke=new Zt(n.stroke,"black"),this.width=new wt(n.width,0),this.lineHeight=new wt(n.lineHeight,1),this.letterSpacing=new wt(n.letterSpacing,0),this.maxLineCodeUnits=new wt(n.maxLineChars,15),this.justify=n.justify}place(n,e,i){const o=this.text.get(n.zoom,i);if(!o)return;const s=this.font.get(n.zoom,i);n.scratch.font=s;const l=this.letterSpacing.get(n.zoom,i),h=el(o,this.maxLineCodeUnits.get(n.zoom,i));let u="",d=0;for(const A of h)A.length>d&&(d=A.length,u=A);const _=n.scratch.measureText(u),p=_.width+l*(d-1),m=_.actualBoundingBoxAscent,v=_.actualBoundingBoxDescent,x=(m+v)*this.lineHeight.get(n.zoom,i),P=new ke.default(e[0][0].x,e[0][0].y),T={minX:P.x,minY:P.y-m,maxX:P.x+p,maxY:P.y+v+(h.length-1)*x};return[{anchor:P,bboxes:[T],draw:(A,w)=>{A.globalAlpha=1,A.font=s,A.fillStyle=this.fill.get(n.zoom,i);const M=this.width.get(n.zoom,i);let k=0;for(const F of h){let I=0;if(this.justify===2||w&&w.justify===2?I=(p-A.measureText(F).width)/2:(this.justify===3||w&&w.justify===3)&&(I=p-A.measureText(F).width),M)if(A.lineWidth=M*2,A.strokeStyle=this.stroke.get(n.zoom,i),l>0){let B=I;for(const z of F)A.strokeText(z,B,k),B+=A.measureText(z).width+l}else A.strokeText(F,I,k);if(l>0){let B=I;for(const z of F)A.fillText(z,B,k),B+=A.measureText(z).width+l}else A.fillText(F,I,k);k+=x}}}]}},xi=class{constructor(n){this.centered=new cf(new yl(n))}place(n,e,i){return this.centered.place(n,e,i)}},uf=class{constructor(n,e){var i,o,s;this.symbolizer=n,this.offsetX=new wt(e.offsetX,0),this.offsetY=new wt(e.offsetY,0),this.justify=(i=e.justify)!=null?i:void 0,this.placements=(o=e.placements)!=null?o:[2,6,8,4,1,3,5,7],this.ddValues=(s=e.ddValues)!=null?s:()=>({})}place(n,e,i){if(i.geomType!==1)return;const o=e[0][0],s=this.symbolizer.place(n,[[new ke.default(0,0)]],i);if(!s||s.length===0)return;const l=s[0],h=l.bboxes[0];let u=this.offsetX,d=this.offsetY,_=this.justify,p=this.placements;const{offsetX:m,offsetY:v,justify:x,placements:P}=this.ddValues(n.zoom,i)||{};m&&(u=new wt(m,0)),v&&(d=new wt(v,0)),x&&(_=x),P&&(p=P);const T=u.get(n.zoom,i),O=d.get(n.zoom,i),A=(I,B)=>({minX:I.x+B.x+h.minX,minY:I.y+B.y+h.minY,maxX:I.x+B.x+h.maxX,maxY:I.y+B.y+h.maxY});let w=new ke.default(T,O),M;const k=I=>{I.translate(w.x,w.y),l.draw(I,{justify:M})},F=(I,B)=>{const z=A(I,B);if(!n.index.bboxCollides(z,n.order))return[{anchor:o,bboxes:[z],draw:k}]};for(const I of p){const B=this.computeXaxisOffset(T,h,I),z=this.computeYaxisOffset(O,h,I);return M=this.computeJustify(_,I),w=new ke.default(B,z),F(o,w)}}computeXaxisOffset(n,e,i){const o=e.maxX,s=o/2;return[1,5].includes(i)?n-s:[8,7,6].includes(i)?n-o:n}computeYaxisOffset(n,e,i){const o=Math.abs(e.minY),s=e.maxY,l=(e.minY+e.maxY)/2;return[3,7].includes(i)?n-l:[8,2,1].includes(i)?n-s:[6,4,5].includes(i)?n+o:n}computeJustify(n,e){return n||([1,5].includes(e)?2:[2,3,4].includes(e)?1:3)}},df=class{constructor(n){this.symbolizer=new uf(new yl(n),n)}place(n,e,i){return this.symbolizer.place(n,e,i)}},vr=class{constructor(n){var e;this.font=new tl(n),this.text=new Qa(n),this.fill=new Zt(n.fill,"black"),this.stroke=new Zt(n.stroke,"black"),this.width=new wt(n.width,0),this.offset=new wt(n.offset,0),this.position=(e=n.position)!=null?e:1,this.maxLabelCodeUnits=new wt(n.maxLabelChars,40),this.repeatDistance=new wt(n.repeatDistance,250)}place(n,e,i){const o=this.text.get(n.zoom,i);if(!o||o.length>this.maxLabelCodeUnits.get(n.zoom,i))return;const s=20,l=i.bbox;if(l.maxY-l.minY<s&&l.maxX-l.minX<s)return;const h=this.font.get(n.zoom,i);n.scratch.font=h;const u=n.scratch.measureText(o),d=u.width,_=u.actualBoundingBoxAscent+u.actualBoundingBoxDescent;let p=this.repeatDistance.get(n.zoom,i);n.overzoom>4&&(p*=1<<n.overzoom-4);const m=_*2,v=dd(e,d,p,m);if(v.length===0)return;const x=[];for(const P of v){const T=P.end.x-P.start.x,O=P.end.y-P.start.y,w=fd(P.start,P.end,d,m/2).map(k=>({minX:k.x-m/2,minY:k.y-m/2,maxX:k.x+m/2,maxY:k.y+m/2})),M=k=>{k.globalAlpha=1,k.rotate(Math.atan2(O,T)),T<0&&(k.scale(-1,-1),k.translate(-d,0));let F=0;this.position===3?F+=_:this.position===2&&(F+=_/2),k.translate(0,F-this.offset.get(n.zoom,i)),k.font=h;const I=this.width.get(n.zoom,i);I&&(k.lineWidth=I,k.strokeStyle=this.stroke.get(n.zoom,i),k.strokeText(o,0,0)),k.fillStyle=this.fill.get(n.zoom,i),k.fillText(o,0,0)};x.push({anchor:P.start,bboxes:w,draw:M,deduplicationKey:o,deduplicationDistance:p})}return x}},Et=(n,e)=>{const i=n[e];return typeof i=="string"?i:""},ta=(n,e)=>{const i=n[e];return typeof i=="number"?i:0},ff=n=>[{dataLayer:"earth",symbolizer:new bt({fill:n.earth})},{dataLayer:"landuse",symbolizer:new bt({fill:(e,i)=>gr(n.park_a,n.park_b,Math.min(Math.max(e/12,12),0))}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["allotments","village_green","playground"].includes(o)}},{dataLayer:"landuse",symbolizer:new bt({fill:n.park_b,opacity:.7}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["national_park","park","cemetery","protected_area","nature_reserve","forest","golf_course"].includes(o)}},{dataLayer:"landuse",symbolizer:new bt({fill:n.hospital}),filter:(e,i)=>i.props["pmap:kind"]==="hospital"},{dataLayer:"landuse",symbolizer:new bt({fill:n.industrial}),filter:(e,i)=>i.props["pmap:kind"]==="industrial"},{dataLayer:"landuse",symbolizer:new bt({fill:n.school}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["school","university","college"].includes(o)}},{dataLayer:"landuse",symbolizer:new bt({fill:n.beach}),filter:(e,i)=>i.props["pmap:kind"]==="beach"},{dataLayer:"landuse",symbolizer:new bt({fill:n.zoo}),filter:(e,i)=>i.props["pmap:kind"]==="zoo"},{dataLayer:"landuse",symbolizer:new bt({fill:n.zoo}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["military","naval_base","airfield"].includes(o)}},{dataLayer:"natural",symbolizer:new bt({fill:(e,i)=>gr(n.wood_a,n.wood_b,Math.min(Math.max(e/12,12),0))}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["wood","nature_reserve","forest"].includes(o)}},{dataLayer:"natural",symbolizer:new bt({fill:(e,i)=>gr(n.scrub_a,n.scrub_b,Math.min(Math.max(e/12,12),0))}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["scrub","grassland","grass"].includes(o)}},{dataLayer:"natural",symbolizer:new bt({fill:n.scrub_b}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["scrub","grassland","grass"].includes(o)}},{dataLayer:"natural",symbolizer:new bt({fill:n.glacier}),filter:(e,i)=>i.props["pmap:kind"]==="glacier"},{dataLayer:"natural",symbolizer:new bt({fill:n.sand}),filter:(e,i)=>i.props["pmap:kind"]==="sand"},{dataLayer:"landuse",symbolizer:new bt({fill:n.aerodrome}),filter:(e,i)=>i.props["pmap:kind"]==="aerodrome"},{dataLayer:"water",symbolizer:new bt({fill:n.water})},{dataLayer:"transit",symbolizer:new St({color:n.runway,width:(e,i)=>Yt(1.6,[[11,0],[13,4],[19,30]])(e)}),filter:(e,i)=>i.props["pmap:kind_detail"]==="runway"},{dataLayer:"transit",symbolizer:new St({color:n.runway,width:(e,i)=>Yt(1.6,[[14,0],[14.5,1],[16,6]])(e)}),filter:(e,i)=>i.props["pmap:kind_detail"]==="taxiway"},{dataLayer:"transit",symbolizer:new St({color:n.pier,width:(e,i)=>Yt(1.6,[[13,0],[13.5,0,5],[21,16]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="pier"},{dataLayer:"physical_line",minzoom:14,symbolizer:new St({color:n.water,width:(e,i)=>Yt(1.6,[[9,0],[9.5,1],[18,12]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="river"},{dataLayer:"physical_line",minzoom:14,symbolizer:new St({color:n.water,width:.5}),filter:(e,i)=>i.props["pmap:kind"]==="stream"},{dataLayer:"landuse",symbolizer:new bt({fill:n.pedestrian}),filter:(e,i)=>i.props["pmap:kind"]==="pedestrian"},{dataLayer:"landuse",symbolizer:new bt({fill:n.pier}),filter:(e,i)=>i.props["pmap:kind"]==="pier"},{dataLayer:"buildings",symbolizer:new bt({fill:n.buildings,opacity:.5})},{dataLayer:"roads",symbolizer:new St({color:n.major,width:(e,i)=>Yt(1.6,[[14,0],[20,7]])(e)}),filter:(e,i)=>{const o=Et(i.props,"pmap:kind");return["other","path"].includes(o)}},{dataLayer:"roads",symbolizer:new St({color:n.major,width:(e,i)=>Yt(1.6,[[13,0],[18,8]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="minor_road"},{dataLayer:"roads",symbolizer:new St({color:n.major,width:(e,i)=>Yt(1.6,[[7,0],[12,1.2],[15,3],[18,13]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="medium_road"},{dataLayer:"roads",symbolizer:new St({color:n.major,width:(e,i)=>Yt(1.6,[[6,0],[12,1.6],[15,3],[18,13]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="major_road"},{dataLayer:"roads",symbolizer:new St({color:n.major,width:(e,i)=>Yt(1.6,[[3,0],[6,1.1],[12,1.6],[15,5],[18,15]])(e)}),filter:(e,i)=>i.props["pmap:kind"]==="highway"},{dataLayer:"boundaries",symbolizer:new St({dash:[3,2],color:n.boundaries,width:1}),filter:(e,i)=>{const o=i.props["pmap:min_admin_level"];return typeof o=="number"&&o<=2}},{dataLayer:"transit",symbolizer:new St({dash:[.3,.75],color:n.railway,dashWidth:(e,i)=>Yt(1.6,[[4,0],[7,.15],[19,9]])(e),opacity:.5}),filter:(e,i)=>i.props["pmap:kind"]==="rail"},{dataLayer:"boundaries",symbolizer:new St({dash:[3,2],color:n.boundaries,width:.5}),filter:(e,i)=>{const o=i.props["pmap:min_admin_level"];return typeof o=="number"&&o>2}}],pf=n=>{const e=["name"];return[{dataLayer:"roads",symbolizer:new vr({labelProps:e,fill:n.roads_label_minor,font:"400 12px sans-serif",width:2,stroke:n.roads_label_minor_halo}),minzoom:16,filter:(i,o)=>{const s=Et(o.props,"pmap:kind");return["minor_road","other","path"].includes(s)}},{dataLayer:"roads",symbolizer:new vr({labelProps:e,fill:n.roads_label_major,font:"400 12px sans-serif",width:2,stroke:n.roads_label_major_halo}),minzoom:12,filter:(i,o)=>{const s=Et(o.props,"pmap:kind");return["highway","major_road","medium_road"].includes(s)}},{dataLayer:"roads",symbolizer:new vr({labelProps:e,fill:n.roads_label_major,font:"400 12px sans-serif",width:2,stroke:n.roads_label_major_halo}),minzoom:12,filter:(i,o)=>{const s=Et(o.props,"pmap:kind");return["highway","major_road","medium_road"].includes(s)}},{dataLayer:"physical_point",symbolizer:new xi({labelProps:e,fill:n.ocean_label,lineHeight:1.5,letterSpacing:1,font:(i,o)=>`400 ${Qs([[3,10],[10,12]])(i)}px sans-serif`,textTransform:"uppercase"}),filter:(i,o)=>{const s=Et(o.props,"pmap:kind");return["ocean","bay","strait","fjord"].includes(s)}},{dataLayer:"physical_point",symbolizer:new xi({labelProps:e,fill:n.ocean_label,lineHeight:1.5,letterSpacing:1,font:(i,o)=>`400 ${Qs([[3,0],[6,12],[10,12]])(i)}px sans-serif`}),filter:(i,o)=>{const s=Et(o.props,"pmap:kind");return["sea","lake","water"].includes(s)}},{dataLayer:"places",symbolizer:new xi({labelProps:(i,o)=>i<6?["name:short"]:e,fill:n.state_label,stroke:n.state_label_halo,width:1,lineHeight:1.5,font:(i,o)=>i<6?"400 16px sans-serif":"400 12px sans-serif",textTransform:"uppercase"}),filter:(i,o)=>o.props["pmap:kind"]==="region"},{dataLayer:"places",symbolizer:new xi({labelProps:e,fill:n.country_label,lineHeight:1.5,font:(i,o)=>(i<6,"600 12px sans-serif"),textTransform:"uppercase"}),filter:(i,o)=>o.props["pmap:kind"]==="country"},{dataLayer:"places",minzoom:9,symbolizer:new xi({labelProps:e,fill:n.city_label,lineHeight:1.5,font:(i,o)=>{if(!o)return"400 12px sans-serif";const s=o.props["pmap:min_zoom"];let l=400;s&&s<=5&&(l=600);let h=12;const u=o.props["pmap:population_rank"];return u&&u>9&&(h=16),`${l} ${h}px sans-serif`}}),sort:(i,o)=>{const s=ta(i,"pmap:population_rank"),l=ta(o,"pmap:population_rank");return s-l},filter:(i,o)=>o.props["pmap:kind"]==="locality"},{dataLayer:"places",maxzoom:8,symbolizer:new hf([new af({radius:2,fill:n.city_circle,stroke:n.city_circle_stroke,width:1.5}),new df({labelProps:e,fill:n.city_label,stroke:n.city_label_halo,width:1,offsetX:6,offsetY:4.5,font:(i,o)=>"400 12px sans-serif"})]),filter:(i,o)=>o.props["pmap:kind"]==="locality"}]},_f={background:"#cccccc",earth:"#e0e0e0",park_a:"#cfddd5",park_b:"#9cd3b4",hospital:"#e4dad9",industrial:"#d1dde1",school:"#e4ded7",wood_a:"#d0ded0",wood_b:"#a0d9a0",pedestrian:"#e3e0d4",scrub_a:"#cedcd7",scrub_b:"#99d2bb",glacier:"#e7e7e7",sand:"#e2e0d7",beach:"#e8e4d0",aerodrome:"#dadbdf",runway:"#e9e9ed",water:"#80deea",pier:"#e0e0e0",zoo:"#c6dcdc",military:"#dcdcdc",tunnel_other_casing:"#e0e0e0",tunnel_minor_casing:"#e0e0e0",tunnel_link_casing:"#e0e0e0",tunnel_medium_casing:"#e0e0e0",tunnel_major_casing:"#e0e0e0",tunnel_highway_casing:"#e0e0e0",tunnel_other:"#d5d5d5",tunnel_minor:"#d5d5d5",tunnel_link:"#d5d5d5",tunnel_medium:"#d5d5d5",tunnel_major:"#d5d5d5",tunnel_highway:"#d5d5d5",transit_pier:"#e0e0e0",buildings:"#cccccc",minor_service_casing:"#e0e0e0",minor_casing:"#e0e0e0",link_casing:"#e0e0e0",medium_casing:"#e0e0e0",major_casing_late:"#e0e0e0",highway_casing_late:"#e0e0e0",other:"#ebebeb",minor_service:"#ebebeb",minor_a:"#ebebeb",minor_b:"#ffffff",link:"#ffffff",medium:"#f5f5f5",major_casing_early:"#e0e0e0",major:"#ffffff",highway_casing_early:"#e0e0e0",highway:"#ffffff",railway:"#a7b1b3",boundaries:"#adadad",waterway_label:"#ffffff",bridges_other_casing:"#e0e0e0",bridges_minor_casing:"#e0e0e0",bridges_link_casing:"#e0e0e0",bridges_medium_casing:"#e0e0e0",bridges_major_casing:"#e0e0e0",bridges_highway_casing:"#e0e0e0",bridges_other:"#ebebeb",bridges_minor:"#ffffff",bridges_link:"#ffffff",bridges_medium:"#f0eded",bridges_major:"#f5f5f5",bridges_highway:"#ffffff",roads_label_minor:"#91888b",roads_label_minor_halo:"#ffffff",roads_label_major:"#938a8d",roads_label_major_halo:"#ffffff",ocean_label:"#ffffff",peak_label:"#7e9aa0",subplace_label:"#8f8f8f",subplace_label_halo:"#e0e0e0",city_circle:"#ffffff",city_circle_stroke:"#a3a3a3",city_label:"#5c5c5c",city_label_halo:"#e0e0e0",state_label:"#b3b3b3",state_label_halo:"#e0e0e0",country_label:"#a3a3a3"},gf={background:"#34373d",earth:"#1f1f1f",park_a:"#232325",park_b:"#232325",hospital:"#252424",industrial:"#222222",school:"#262323",wood_a:"#202121",wood_b:"#202121",pedestrian:"#1e1e1e",scrub_a:"#222323",scrub_b:"#222323",glacier:"#1c1c1c",sand:"#212123",beach:"#28282a",aerodrome:"#1e1e1e",runway:"#333333",water:"#34373d",pier:"#222222",zoo:"#222323",military:"#242323",tunnel_other_casing:"#141414",tunnel_minor_casing:"#141414",tunnel_link_casing:"#141414",tunnel_medium_casing:"#141414",tunnel_major_casing:"#141414",tunnel_highway_casing:"#141414",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#333333",buildings:"#111111",minor_service_casing:"#1f1f1f",minor_casing:"#1f1f1f",link_casing:"#1f1f1f",medium_casing:"#1f1f1f",major_casing_late:"#1f1f1f",highway_casing_late:"#1f1f1f",other:"#333333",minor_service:"#333333",minor_a:"#3d3d3d",minor_b:"#333333",link:"#3d3d3d",medium:"#3d3d3d",major_casing_early:"#1f1f1f",major:"#3d3d3d",highway_casing_early:"#1f1f1f",highway:"#474747",railway:"#000000",boundaries:"#5b6374",waterway_label:"#717784",bridges_other_casing:"#2b2b2b",bridges_minor_casing:"#1f1f1f",bridges_link_casing:"#1f1f1f",bridges_medium_casing:"#1f1f1f",bridges_major_casing:"#1f1f1f",bridges_highway_casing:"#1f1f1f",bridges_other:"#333333",bridges_minor:"#333333",bridges_link:"#3d3d3d",bridges_medium:"#3d3d3d",bridges_major:"#3d3d3d",bridges_highway:"#474747",roads_label_minor:"#525252",roads_label_minor_halo:"#1f1f1f",roads_label_major:"#666666",roads_label_major_halo:"#1f1f1f",ocean_label:"#717784",peak_label:"#898080",subplace_label:"#525252",subplace_label_halo:"#1f1f1f",city_circle:"#000000",city_circle_stroke:"#7a7a7a",city_label:"#7a7a7a",city_label_halo:"#212121",state_label:"#3d3d3d",state_label_halo:"#1f1f1f",country_label:"#5c5c5c"},mf={background:"#ffffff",earth:"#ffffff",park_a:"#fcfcfc",park_b:"#fcfcfc",hospital:"#f8f8f8",industrial:"#fcfcfc",school:"#f8f8f8",wood_a:"#fafafa",wood_b:"#fafafa",pedestrian:"#fdfdfd",scrub_a:"#fafafa",scrub_b:"#fafafa",glacier:"#fcfcfc",sand:"#fafafa",beach:"#f6f6f6",aerodrome:"#fdfdfd",runway:"#efefef",water:"#dcdcdc",pier:"#f5f5f5",zoo:"#f7f7f7",military:"#fcfcfc",tunnel_other_casing:"#d6d6d6",tunnel_minor_casing:"#fcfcfc",tunnel_link_casing:"#fcfcfc",tunnel_medium_casing:"#fcfcfc",tunnel_major_casing:"#fcfcfc",tunnel_highway_casing:"#fcfcfc",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#efefef",buildings:"#efefef",minor_service_casing:"#ffffff",minor_casing:"#ffffff",link_casing:"#ffffff",medium_casing:"#ffffff",major_casing_late:"#ffffff",highway_casing_late:"#ffffff",other:"#f5f5f5",minor_service:"#f5f5f5",minor_a:"#ebebeb",minor_b:"#f5f5f5",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#ffffff",major:"#ebebeb",highway_casing_early:"#ffffff",highway:"#ebebeb",railway:"#d6d6d6",boundaries:"#adadad",waterway_label:"#adadad",bridges_other_casing:"#ffffff",bridges_minor_casing:"#ffffff",bridges_link_casing:"#ffffff",bridges_medium_casing:"#ffffff",bridges_major_casing:"#ffffff",bridges_highway_casing:"#ffffff",bridges_other:"#f5f5f5",bridges_minor:"#f5f5f5",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#adadad",roads_label_minor_halo:"#ffffff",roads_label_major:"#999999",roads_label_major_halo:"#ffffff",ocean_label:"#adadad",peak_label:"#adadad",subplace_label:"#8f8f8f",subplace_label_halo:"#ffffff",city_circle:"#ffffff",city_circle_stroke:"#adadad",city_label:"#5c5c5c",city_label_halo:"#ffffff",state_label:"#b3b3b3",state_label_halo:"#ffffff",country_label:"#b8b8b8"},yf={background:"#a3a3a3",earth:"#cccccc",park_a:"#c2c2c2",park_b:"#c2c2c2",hospital:"#d0d0d0",industrial:"#c6c6c6",school:"#d0d0d0",wood_a:"#c2c2c2",wood_b:"#c2c2c2",pedestrian:"#c4c4c4",scrub_a:"#c2c2c2",scrub_b:"#c2c2c2",glacier:"#d2d2d2",sand:"#d2d2d2",beach:"#d2d2d2",aerodrome:"#c9c9c9",runway:"#f5f5f5",water:"#a3a3a3",pier:"#b8b8b8",zoo:"#c7c7c7",military:"#bfbfbf",tunnel_other_casing:"#b8b8b8",tunnel_minor_casing:"#b8b8b8",tunnel_link_casing:"#b8b8b8",tunnel_medium_casing:"#b8b8b8",tunnel_major_casing:"#b8b8b8",tunnel_highway_casing:"#b8b8b8",tunnel_other:"#d6d6d6",tunnel_minor:"#d6d6d6",tunnel_link:"#d6d6d6",tunnel_medium:"#d6d6d6",tunnel_major:"#d6d6d6",tunnel_highway:"#d6d6d6",transit_pier:"#b8b8b8",buildings:"#e0e0e0",minor_service_casing:"#cccccc",minor_casing:"#cccccc",link_casing:"#cccccc",medium_casing:"#cccccc",major_casing_late:"#cccccc",highway_casing_late:"#cccccc",other:"#e0e0e0",minor_service:"#e0e0e0",minor_a:"#ebebeb",minor_b:"#e0e0e0",link:"#ebebeb",medium:"#ebebeb",major_casing_early:"#cccccc",major:"#ebebeb",highway_casing_early:"#cccccc",highway:"#ebebeb",railway:"#f5f5f5",boundaries:"#5c5c5c",waterway_label:"#7a7a7a",bridges_other_casing:"#cccccc",bridges_minor_casing:"#cccccc",bridges_link_casing:"#cccccc",bridges_medium_casing:"#cccccc",bridges_major_casing:"#cccccc",bridges_highway_casing:"#cccccc",bridges_other:"#e0e0e0",bridges_minor:"#e0e0e0",bridges_link:"#ebebeb",bridges_medium:"#ebebeb",bridges_major:"#ebebeb",bridges_highway:"#ebebeb",roads_label_minor:"#999999",roads_label_minor_halo:"#e0e0e0",roads_label_major:"#8f8f8f",roads_label_major_halo:"#ebebeb",ocean_label:"#7a7a7a",peak_label:"#5c5c5c",subplace_label:"#7a7a7a",subplace_label_halo:"#cccccc",city_circle:"#c2c2c2",city_circle_stroke:"#7a7a7a",city_label:"#474747",city_label_halo:"#cccccc",state_label:"#999999",state_label_halo:"#cccccc",country_label:"#858585"},vf={background:"#2b2b2b",earth:"#141414",park_a:"#181818",park_b:"#181818",hospital:"#1d1d1d",industrial:"#101010",school:"#111111",wood_a:"#1a1a1a",wood_b:"#1a1a1a",pedestrian:"#191919",scrub_a:"#1c1c1c",scrub_b:"#1c1c1c",glacier:"#191919",sand:"#161616",beach:"#1f1f1f",aerodrome:"#191919",runway:"#323232",water:"#333333",pier:"#0a0a0a",zoo:"#191919",military:"#121212",tunnel_other_casing:"#101010",tunnel_minor_casing:"#101010",tunnel_link_casing:"#101010",tunnel_medium_casing:"#101010",tunnel_major_casing:"#101010",tunnel_highway_casing:"#101010",tunnel_other:"#292929",tunnel_minor:"#292929",tunnel_link:"#292929",tunnel_medium:"#292929",tunnel_major:"#292929",tunnel_highway:"#292929",transit_pier:"#0a0a0a",buildings:"#0a0a0a",minor_service_casing:"#141414",minor_casing:"#141414",link_casing:"#141414",medium_casing:"#141414",major_casing_late:"#141414",highway_casing_late:"#141414",other:"#1f1f1f",minor_service:"#1f1f1f",minor_a:"#292929",minor_b:"#1f1f1f",link:"#1f1f1f",medium:"#292929",major_casing_early:"#141414",major:"#292929",highway_casing_early:"#141414",highway:"#292929",railway:"#292929",boundaries:"#707070",waterway_label:"#707070",bridges_other_casing:"#141414",bridges_minor_casing:"#141414",bridges_link_casing:"#141414",bridges_medium_casing:"#141414",bridges_major_casing:"#141414",bridges_highway_casing:"#141414",bridges_other:"#1f1f1f",bridges_minor:"#1f1f1f",bridges_link:"#292929",bridges_medium:"#292929",bridges_major:"#292929",bridges_highway:"#292929",roads_label_minor:"#525252",roads_label_minor_halo:"#141414",roads_label_major:"#5c5c5c",roads_label_major_halo:"#141414",ocean_label:"#707070",peak_label:"#707070",subplace_label:"#5c5c5c",subplace_label_halo:"#141414",city_circle:"#000000",city_circle_stroke:"#666666",city_label:"#999999",city_label_halo:"#141414",state_label:"#3d3d3d",state_label_halo:"#141414",country_label:"#707070"},wf={light:_f,dark:gf,white:mf,grayscale:yf,black:vf},xf=wf,bf=jt(ae()),Pf=jt(Ju()),Ne=jt(ae()),vl=(n,e,i)=>{const o=[];for(const s of n){const l=[];for(const h of s)l.push(h.clone().mult(e).add(i));o.push(l)}return o},hn=(n,e)=>{const i=1<<e;return n<0?i+n:n>=i?n%i:n},Cf=class{constructor(n,e,i){this.tileCache=n,this.maxDataLevel=e,this.levelDiff=i}dataTilesForBounds(n,e){const i=Rt(2,n)/Rt(2,Math.ceil(n)),o=[];let s=1;const l=this.tileCache.tileSize;if(n<this.levelDiff)s=1/(1<<this.levelDiff-n)*i,o.push({dataTile:{z:0,x:0,y:0},origin:new Ne.default(0,0),scale:s,dim:l*s});else if(n<=this.levelDiff+this.maxDataLevel){const h=1<<this.levelDiff,u=256*i,d=Math.ceil(n)-this.levelDiff,_=Math.floor(e.minX/h/u),p=Math.floor(e.minY/h/u),m=Math.floor(e.maxX/h/u),v=Math.floor(e.maxY/h/u);for(let x=_;x<=m;x++)for(let P=p;P<=v;P++){const T=new Ne.default(x*h*u,P*h*u);o.push({dataTile:{z:d,x:hn(x,d),y:hn(P,d)},origin:T,scale:i,dim:l*i})}}else{const h=1<<this.levelDiff;s=(1<<Math.ceil(n)-this.maxDataLevel-this.levelDiff)*i;const u=Math.floor(e.minX/h/256/s),d=Math.floor(e.minY/h/256/s),_=Math.floor(e.maxX/h/256/s),p=Math.floor(e.maxY/h/256/s);for(let m=u;m<=_;m++)for(let v=d;v<=p;v++){const x=new Ne.default(m*h*256*s,v*h*256*s);o.push({dataTile:{z:this.maxDataLevel,x:hn(m,this.maxDataLevel),y:hn(v,this.maxDataLevel)},origin:x,scale:s,dim:l*s})}}return o}dataTileForDisplayTile(n){let e,i=1,o=this.tileCache.tileSize,s;if(n.z<this.levelDiff)e={z:0,x:0,y:0},i=1/(1<<this.levelDiff-n.z),s=new Ne.default(0,0),o=o*i;else if(n.z<=this.levelDiff+this.maxDataLevel){const l=1<<this.levelDiff;e={z:n.z-this.levelDiff,x:Math.floor(n.x/l),y:Math.floor(n.y/l)},s=new Ne.default(e.x*l*256,e.y*l*256)}else{i=1<<n.z-this.maxDataLevel-this.levelDiff;const l=1<<this.levelDiff;e={z:this.maxDataLevel,x:Math.floor(n.x/l/i),y:Math.floor(n.y/l/i)},s=new Ne.default(e.x*l*i*256,e.y*l*i*256),o=o*i}return{dataTile:e,scale:i,origin:s,dim:o}}getBbox(n,e){return ni(this,null,function*(){const i=this.dataTilesForBounds(n,e);return(yield Promise.all(i.map(s=>this.tileCache.get(s.dataTile)))).map((s,l)=>{const h=i[l];return{data:s,z:n,dataTile:h.dataTile,scale:h.scale,dim:h.dim,origin:h.origin}})})}getDisplayTile(n){return ni(this,null,function*(){const e=this.dataTileForDisplayTile(n);return{data:yield this.tileCache.get(e.dataTile),z:n.z,dataTile:e.dataTile,scale:e.scale,origin:e.origin,dim:e.dim}})}},Mf=n=>{const e=o=>{const s=o.levelDiff===void 0?1:o.levelDiff,l=o.maxDataZoom||15;let h;if(typeof o.url=="string")o.url.endsWith(".pmtiles")?h=new Js(o.url,!0):h=new ef(o.url,!0);else if(o.url)h=new Js(o.url,!0);else throw new Error(`Invalid source ${o.url}`);const u=new nf(h,256*1<<s);return new Cf(u,l,s)},i=new Map;if(n.sources)for(const o in n.sources)i.set(o,e(n.sources[o]));else i.set("",e(n));return i},kf=(n,e,i)=>{const s=e/256,l=Math.floor(i.minX/256),h=Math.floor(i.minY/256),u=Math.floor(i.maxX/256),d=Math.floor(i.maxY/256),_=Math.log2(s),p=[];for(let m=l;m<=u;m++){const v=m%(1<<n);for(let x=h;x<=d;x++)p.push({display:Je({z:n,x:v,y:x}),key:Je({z:n-_,x:Math.floor(v/s),y:Math.floor(x/s)})})}return p},Lf=class{constructor(n,e){this.tree=new Pf.default,this.current=new Map,this.dim=n,this.maxLabeledTiles=e}hasPrefix(n){for(const e of this.current.keys())if(e.startsWith(n))return!0;return!1}has(n){return this.current.has(n)}size(){return this.current.size}keys(){return this.current.keys()}searchBbox(n,e){const i=new Set;for(const o of this.tree.search(n))o.indexedLabel.order<=e&&i.add(o.indexedLabel);return i}searchLabel(n,e){const i=new Set;for(const o of n.bboxes)for(const s of this.tree.search(o))s.indexedLabel.order<=e&&i.add(s.indexedLabel);return i}bboxCollides(n,e){for(const i of this.tree.search(n))if(i.indexedLabel.order<=e)return!0;return!1}labelCollides(n,e){for(const i of n.bboxes)for(const o of this.tree.search(i))if(o.indexedLabel.order<=e)return!0;return!1}deduplicationCollides(n){if(!n.deduplicationKey||!n.deduplicationDistance)return!1;const e=n.deduplicationDistance,i={minX:n.anchor.x-e,minY:n.anchor.y-e,maxX:n.anchor.x+e,maxY:n.anchor.y+e};for(const o of this.tree.search(i))if(o.indexedLabel.deduplicationKey===n.deduplicationKey&&o.indexedLabel.anchor.dist(n.anchor)<e)return!0;return!1}makeEntry(n){this.current.get(n)&&console.log("consistency error 1");const e=new Set;this.current.set(n,e)}insert(n,e,i){const o={anchor:n.anchor,bboxes:n.bboxes,draw:n.draw,order:e,tileKey:i,deduplicationKey:n.deduplicationKey,deduplicationDistance:n.deduplicationDistance};let s=this.current.get(i);if(!s){const u=new Set;this.current.set(i,u),s=u}s.add(o);let l=!1,h=!1;for(const u of n.bboxes)this.tree.insert({minX:u.minX,minY:u.minY,maxX:u.maxX,maxY:u.maxY,indexedLabel:o}),u.minX<0&&(l=!0),u.maxX>this.dim&&(h=!0);if(l||h){const u=l?this.dim:-this.dim,d=[];for(const m of n.bboxes)d.push({minX:m.minX+u,minY:m.minY,maxX:m.maxX+u,maxY:m.maxY});const _={anchor:new bf.default(n.anchor.x+u,n.anchor.y),bboxes:d,draw:n.draw,order:e,tileKey:i},p=this.current.get(i);p&&p.add(_);for(const m of d)this.tree.insert({minX:m.minX,minY:m.minY,maxX:m.maxX,maxY:m.maxY,indexedLabel:_})}}pruneOrNoop(n){const e=n.split(":");let i,o=0,s=0;for(const l of this.current.keys()){const h=l.split(":");if(h[3]===e[3]){s++;const u=Math.sqrt(Rt(+h[0]-+e[0],2)+Rt(+h[1]-+e[1],2));u>o&&(o=u,i=l)}i&&s>this.maxLabeledTiles&&this.pruneKey(i)}}pruneKey(n){const e=this.current.get(n);if(!e)return;const i=[];for(const o of this.tree.all())e.has(o.indexedLabel)&&i.push(o);for(const o of i)this.tree.remove(o);this.current.delete(n)}removeLabel(n){const e=[];for(const o of this.tree.all())n===o.indexedLabel&&e.push(o);for(const o of e)this.tree.remove(o);const i=this.current.get(n.tileKey);i&&i.delete(n)}},Sf=class{constructor(n,e,i,o,s){this.index=new Lf(256*1<<n,o),this.z=n,this.scratch=e,this.labelRules=i,this.callback=s}layout(n){const e=performance.now(),i=new Set;for(const[s,l]of n)for(const h of l){const u=`${Je(h.dataTile)}:${s}`;this.index.has(u)||(this.index.makeEntry(u),i.add(u))}const o=new Set;for(const[s,l]of this.labelRules.entries()){if(l.visible===!1||l.minzoom&&this.z<l.minzoom||l.maxzoom&&this.z>l.maxzoom)continue;const h=l.dataSource||"",u=n.get(h);if(u)for(const d of u){const _=`${Je(d.dataTile)}:${h}`;if(!i.has(_))continue;const p=d.data.get(l.dataLayer);if(p===void 0)continue;const m=p;l.sort&&m.sort((x,P)=>l.sort?l.sort(x.props,P.props):0);const v={index:this.index,zoom:this.z,scratch:this.scratch,order:s,overzoom:this.z-d.dataTile.z};for(const x of m){if(l.filter&&!l.filter(this.z,x))continue;const P=vl(x.geom,d.scale,d.origin),T=l.symbolizer.place(v,P,x);if(T)for(const O of T){let A=!1;if(!(O.deduplicationKey&&this.index.deduplicationCollides(O))){if(this.index.labelCollides(O,1/0)){if(!this.index.labelCollides(O,s)){const w=this.index.searchLabel(O,1/0);for(const M of w){this.index.removeLabel(M);for(const k of M.bboxes)this.findInvalidatedTiles(o,d.dim,k,_)}this.index.insert(O,s,_),A=!0}}else this.index.insert(O,s,_),A=!0;if(A)for(const w of O.bboxes)(w.maxX>d.origin.x+d.dim||w.minX<d.origin.x||w.minY<d.origin.y||w.maxY>d.origin.y+d.dim)&&this.findInvalidatedTiles(o,d.dim,w,_)}}}}}for(const s of i)this.index.pruneOrNoop(s);return o.size>0&&this.callback&&this.callback(o),performance.now()-e}findInvalidatedTiles(n,e,i,o){const s=kf(this.z,e,i);for(const l of s)l.key!==o&&this.index.hasPrefix(l.key)&&n.add(l.display)}add(n){let e=!0;for(const[o,s]of n)for(const l of s)this.index.has(`${Je(l.dataTile)}:${o}`)||(e=!1);return e?0:this.layout(n)}},ea=class{constructor(n,e,i,o){this.labelers=new Map,this.scratch=n,this.labelRules=e,this.maxLabeledTiles=i,this.callback=o}add(n,e){let i=this.labelers.get(n);return i||(i=new Sf(n,this.scratch,this.labelRules,this.maxLabeledTiles,this.callback),this.labelers.set(n,i)),i.add(e)}getIndex(n){const e=this.labelers.get(n);if(e)return e.index}},Ef=jt(ae());function Tf(n,e,i,o,s,l,h,u,d){const _=performance.now();n.save(),n.miterLimit=2;for(const p of s){if(p.minzoom&&e<p.minzoom||p.maxzoom&&e>p.maxzoom)continue;const m=i.get(p.dataSource||"");if(m)for(const v of m){const x=v.data.get(p.dataLayer);if(x===void 0)continue;p.symbolizer.before&&p.symbolizer.before(n,v.z);const P=v.origin;v.dim;const T=v.scale;n.save(),n.translate(P.x-h.x,P.y-h.y);for(const O of x){let A=O.geom;const w=O.bbox;w.maxX*T+P.x<l.minX||w.minX*T+P.x>l.maxX||w.minY*T+P.y>l.maxY||w.maxY*T+P.y<l.minY||p.filter&&!p.filter(v.z,O)||(T!==1&&(A=vl(A,T,new Ef.default(0,0))),p.symbolizer.draw(n,A,v.z,O))}n.restore()}}if(o){const p=o.searchBbox(l,1/0);for(const m of p)if(n.save(),n.translate(m.anchor.x-h.x,m.anchor.y-h.y),m.draw(n),n.restore(),d){n.lineWidth=.5,n.strokeStyle=d,n.fillStyle=d,n.globalAlpha=1,n.fillRect(m.anchor.x-h.x-2,m.anchor.y-h.y-2,4,4);for(const v of m.bboxes)n.strokeRect(v.minX-h.x,v.minY-h.y,v.maxX-v.minX,v.maxY-v.minY)}}return n.restore(),performance.now()-_}var zf=jt(ae()),If=n=>new Promise(e=>{setTimeout(()=>{e()},n)}),Df=n=>n.then(e=>({status:"fulfilled",value:e}),e=>({status:"rejected",reason:e})),Of=(n={})=>{class e extends L.GridLayer{constructor(o={}){if(o.noWrap&&!o.bounds&&(o.bounds=[[-90,-180],[90,180]]),o.attribution==null&&(o.attribution='<a href="https://protomaps.com">Protomaps</a> © <a href="https://openstreetmap.org/copyright">OpenStreetMap</a>'),super(o),o.theme){const l=xf[o.theme];this.paintRules=ff(l),this.labelRules=pf(l),this.backgroundColor=l.background}else this.paintRules=o.paintRules||[],this.labelRules=o.labelRules||[],this.backgroundColor=o.backgroundColor;this.lastRequestedZ=void 0,this.tasks=o.tasks||[],this.views=Mf(o),this.debug=o.debug;const s=document.createElement("canvas").getContext("2d");this.scratch=s,this.onTilesInvalidated=l=>{for(const h of l)this.rerenderTile(h)},this.labelers=new ea(this.scratch,this.labelRules,16,this.onTilesInvalidated),this.tileSize=256*window.devicePixelRatio,this.tileDelay=o.tileDelay||3,this.lang=o.lang}renderTile(o,s,l,h=()=>{}){return ni(this,null,function*(){this.lastRequestedZ=o.z;const u=[];for(const[B,z]of this.views){const j=z.getDisplayTile(o);u.push({key:B,promise:j})}const d=yield Promise.all(u.map(B=>B.promise.then(z=>({status:"fulfilled",value:z,key:B.key}),z=>({status:"rejected",reason:z,key:B.key})))),_=new Map;for(const B of d)B.status==="fulfilled"?_.set(B.key,[B.value]):B.reason.name==="AbortError"||console.error(B.reason);if(s.key!==l||this.lastRequestedZ!==o.z||(yield Promise.all(this.tasks.map(Df)),s.key!==l)||this.lastRequestedZ!==o.z)return;const p=this.labelers.add(o.z,_);if(s.key!==l||this.lastRequestedZ!==o.z)return;const m=this.labelers.getIndex(o.z);if(!this._map)return;const v=this._map.getCenter().wrap(),x=this._getTiledPixelBounds(v),T=this._pxBoundsToTileRange(x).getCenter(),O=o.distanceTo(T)*this.tileDelay;if(yield If(O),s.key!==l||this.lastRequestedZ!==o.z)return;const A=16,w={minX:256*o.x-A,minY:256*o.y-A,maxX:256*(o.x+1)+A,maxY:256*(o.y+1)+A},M=new zf.default(256*o.x,256*o.y);s.width=this.tileSize,s.height=this.tileSize;const k=s.getContext("2d");if(!k){console.error("Failed to get Canvas context");return}k.setTransform(this.tileSize/256,0,0,this.tileSize/256,0,0),k.clearRect(0,0,256,256),this.backgroundColor&&(k.save(),k.fillStyle=this.backgroundColor,k.fillRect(0,0,256,256),k.restore());let F=0;const I=this.paintRules;if(F=Tf(k,o.z,_,this.xray?null:m,I,w,M,!1,this.debug),this.debug){k.save(),k.fillStyle=this.debug,k.font="600 12px sans-serif",k.fillText(`${o.z} ${o.x} ${o.y}`,4,14),k.font="12px sans-serif";let B=28;for(const[z,j]of _){const H=j[0].dataTile;k.fillText(`${z+(z?" ":"")+H.z} ${H.x} ${H.y}`,4,B),B+=14}k.font="600 10px sans-serif",F>8&&(k.fillText(`${F.toFixed()} ms paint`,4,B),B+=14),p>8&&k.fillText(`${p.toFixed()} ms layout`,4,B),k.strokeStyle=this.debug,k.lineWidth=.5,k.beginPath(),k.moveTo(0,0),k.lineTo(0,256),k.stroke(),k.lineWidth=.5,k.beginPath(),k.moveTo(0,0),k.lineTo(256,0),k.stroke(),k.restore()}h()})}rerenderTile(o){for(const s in this._tiles){const l=this._wrapCoords(this._keyToTileCoords(s));o===this._tileCoordsToKey(l)&&this.renderTile(l,this._tiles[s].el,o)}}clearLayout(){this.labelers=new ea(this.scratch,this.labelRules,16,this.onTilesInvalidated)}rerenderTiles(){for(const o in this._tiles){const s=this._wrapCoords(this._keyToTileCoords(o)),l=this._tileCoordsToKey(s);this.renderTile(s,this._tiles[o].el,l)}}createTile(o,s){const l=L.DomUtil.create("canvas","leaflet-tile");l.lang=this.lang;const h=this._tileCoordsToKey(o);return l.key=h,this.renderTile(o,l,h,()=>{s(void 0,l)}),l}_removeTile(o){const s=this._tiles[o];s&&(s.el.removed=!0,s.el.key=void 0,L.DomUtil.removeClass(s.el,"leaflet-tile-loaded"),s.el.width=s.el.height=0,L.DomUtil.remove(s.el),delete this._tiles[o],this.fire("tileunload",{tile:s.el,coords:this._keyToTileCoords(o)}))}}return new e(n)};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function Af({L:n,id:e,lat:i,lng:o,zoom:s}){const l=n.map(e,{center:[i,o],zoom:s,minZoom:3,maxZoom:20,tapTolerance:10});return Of({url:"https://api.protomaps.com/tiles/v3/{z}/{x}/{y}.mvt?key=d23c43b7c56e123d",theme:"white"}).addTo(l),l}var Tr={exports:{}};/* @preserve
 * Leaflet 1.9.3, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2022 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(i,o){o(e)})(vc,function(i){var o="1.9.3";function s(t){var r,a,c,f;for(a=1,c=arguments.length;a<c;a++){f=arguments[a];for(r in f)t[r]=f[r]}return t}var l=Object.create||function(){function t(){}return function(r){return t.prototype=r,new t}}();function h(t,r){var a=Array.prototype.slice;if(t.bind)return t.bind.apply(t,a.call(arguments,1));var c=a.call(arguments,2);return function(){return t.apply(r,c.length?c.concat(a.call(arguments)):arguments)}}var u=0;function d(t){return"_leaflet_id"in t||(t._leaflet_id=++u),t._leaflet_id}function _(t,r,a){var c,f,g,b;return b=function(){c=!1,f&&(g.apply(a,f),f=!1)},g=function(){c?f=arguments:(t.apply(a,arguments),setTimeout(b,r),c=!0)},g}function p(t,r,a){var c=r[1],f=r[0],g=c-f;return t===c&&a?t:((t-f)%g+g)%g+f}function m(){return!1}function v(t,r){if(r===!1)return t;var a=Math.pow(10,r===void 0?6:r);return Math.round(t*a)/a}function x(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function P(t){return x(t).split(/\s+/)}function T(t,r){Object.prototype.hasOwnProperty.call(t,"options")||(t.options=t.options?l(t.options):{});for(var a in r)t.options[a]=r[a];return t.options}function O(t,r,a){var c=[];for(var f in t)c.push(encodeURIComponent(a?f.toUpperCase():f)+"="+encodeURIComponent(t[f]));return(!r||r.indexOf("?")===-1?"?":"&")+c.join("&")}var A=/\{ *([\w_ -]+) *\}/g;function w(t,r){return t.replace(A,function(a,c){var f=r[c];if(f===void 0)throw new Error("No value provided for variable "+a);return typeof f=="function"&&(f=f(r)),f})}var M=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function k(t,r){for(var a=0;a<t.length;a++)if(t[a]===r)return a;return-1}var F="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var B=0;function z(t){var r=+new Date,a=Math.max(0,16-(r-B));return B=r+a,window.setTimeout(t,a)}var j=window.requestAnimationFrame||I("RequestAnimationFrame")||z,H=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(t){window.clearTimeout(t)};function V(t,r,a){if(a&&j===z)t.call(r);else return j.call(window,h(t,r))}function G(t){t&&H.call(window,t)}var q={__proto__:null,extend:s,create:l,bind:h,get lastId(){return u},stamp:d,throttle:_,wrapNum:p,falseFn:m,formatNum:v,trim:x,splitWords:P,setOptions:T,getParamString:O,template:w,isArray:M,indexOf:k,emptyImageUrl:F,requestFn:j,cancelFn:H,requestAnimFrame:V,cancelAnimFrame:G};function y(){}y.extend=function(t){var r=function(){T(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},a=r.__super__=this.prototype,c=l(a);c.constructor=r,r.prototype=c;for(var f in this)Object.prototype.hasOwnProperty.call(this,f)&&f!=="prototype"&&f!=="__super__"&&(r[f]=this[f]);return t.statics&&s(r,t.statics),t.includes&&(C(t.includes),s.apply(null,[c].concat(t.includes))),s(c,t),delete c.statics,delete c.includes,c.options&&(c.options=a.options?l(a.options):{},s(c.options,t.options)),c._initHooks=[],c.callInitHooks=function(){if(!this._initHooksCalled){a.callInitHooks&&a.callInitHooks.call(this),this._initHooksCalled=!0;for(var g=0,b=c._initHooks.length;g<b;g++)c._initHooks[g].call(this)}},r},y.include=function(t){var r=this.prototype.options;return s(this.prototype,t),t.options&&(this.prototype.options=r,this.mergeOptions(t.options)),this},y.mergeOptions=function(t){return s(this.prototype.options,t),this},y.addInitHook=function(t){var r=Array.prototype.slice.call(arguments,1),a=typeof t=="function"?t:function(){this[t].apply(this,r)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(a),this};function C(t){if(!(typeof L>"u"||!L||!L.Mixin)){t=M(t)?t:[t];for(var r=0;r<t.length;r++)t[r]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var S={on:function(t,r,a){if(typeof t=="object")for(var c in t)this._on(c,t[c],r);else{t=P(t);for(var f=0,g=t.length;f<g;f++)this._on(t[f],r,a)}return this},off:function(t,r,a){if(!arguments.length)delete this._events;else if(typeof t=="object")for(var c in t)this._off(c,t[c],r);else{t=P(t);for(var f=arguments.length===1,g=0,b=t.length;g<b;g++)f?this._off(t[g]):this._off(t[g],r,a)}return this},_on:function(t,r,a,c){if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}if(this._listens(t,r,a)===!1){a===this&&(a=void 0);var f={fn:r,ctx:a};c&&(f.once=!0),this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(f)}},_off:function(t,r,a){var c,f,g;if(this._events&&(c=this._events[t],!!c)){if(arguments.length===1){if(this._firingCount)for(f=0,g=c.length;f<g;f++)c[f].fn=m;delete this._events[t];return}if(typeof r!="function"){console.warn("wrong listener type: "+typeof r);return}var b=this._listens(t,r,a);if(b!==!1){var E=c[b];this._firingCount&&(E.fn=m,this._events[t]=c=c.slice()),c.splice(b,1)}}},fire:function(t,r,a){if(!this.listens(t,a))return this;var c=s({},r,{type:t,target:this,sourceTarget:r&&r.sourceTarget||this});if(this._events){var f=this._events[t];if(f){this._firingCount=this._firingCount+1||1;for(var g=0,b=f.length;g<b;g++){var E=f[g],D=E.fn;E.once&&this.off(t,D,E.ctx),D.call(E.ctx||this,c)}this._firingCount--}}return a&&this._propagateEvent(c),this},listens:function(t,r,a,c){typeof t!="string"&&console.warn('"string" type argument expected');var f=r;typeof r!="function"&&(c=!!r,f=void 0,a=void 0);var g=this._events&&this._events[t];if(g&&g.length&&this._listens(t,f,a)!==!1)return!0;if(c){for(var b in this._eventParents)if(this._eventParents[b].listens(t,r,a,c))return!0}return!1},_listens:function(t,r,a){if(!this._events)return!1;var c=this._events[t]||[];if(!r)return!!c.length;a===this&&(a=void 0);for(var f=0,g=c.length;f<g;f++)if(c[f].fn===r&&c[f].ctx===a)return f;return!1},once:function(t,r,a){if(typeof t=="object")for(var c in t)this._on(c,t[c],r,!0);else{t=P(t);for(var f=0,g=t.length;f<g;f++)this._on(t[f],r,a,!0)}return this},addEventParent:function(t){return this._eventParents=this._eventParents||{},this._eventParents[d(t)]=t,this},removeEventParent:function(t){return this._eventParents&&delete this._eventParents[d(t)],this},_propagateEvent:function(t){for(var r in this._eventParents)this._eventParents[r].fire(t.type,s({layer:t.target,propagatedFrom:t.target},t),!0)}};S.addEventListener=S.on,S.removeEventListener=S.clearAllEventListeners=S.off,S.addOneTimeEventListener=S.once,S.fireEvent=S.fire,S.hasEventListeners=S.listens;var Y=y.extend(S);function Z(t,r,a){this.x=a?Math.round(t):t,this.y=a?Math.round(r):r}var K=Math.trunc||function(t){return t>0?Math.floor(t):Math.ceil(t)};Z.prototype={clone:function(){return new Z(this.x,this.y)},add:function(t){return this.clone()._add(N(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(N(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},scaleBy:function(t){return new Z(this.x*t.x,this.y*t.y)},unscaleBy:function(t){return new Z(this.x/t.x,this.y/t.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(t){t=N(t);var r=t.x-this.x,a=t.y-this.y;return Math.sqrt(r*r+a*a)},equals:function(t){return t=N(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=N(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+v(this.x)+", "+v(this.y)+")"}};function N(t,r,a){return t instanceof Z?t:M(t)?new Z(t[0],t[1]):t==null?t:typeof t=="object"&&"x"in t&&"y"in t?new Z(t.x,t.y):new Z(t,r,a)}function et(t,r){if(t)for(var a=r?[t,r]:t,c=0,f=a.length;c<f;c++)this.extend(a[c])}et.prototype={extend:function(t){var r,a;if(!t)return this;if(t instanceof Z||typeof t[0]=="number"||"x"in t)r=a=N(t);else if(t=Q(t),r=t.min,a=t.max,!r||!a)return this;return!this.min&&!this.max?(this.min=r.clone(),this.max=a.clone()):(this.min.x=Math.min(r.x,this.min.x),this.max.x=Math.max(a.x,this.max.x),this.min.y=Math.min(r.y,this.min.y),this.max.y=Math.max(a.y,this.max.y)),this},getCenter:function(t){return N((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return N(this.min.x,this.max.y)},getTopRight:function(){return N(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var r,a;return typeof t[0]=="number"||t instanceof Z?t=N(t):t=Q(t),t instanceof et?(r=t.min,a=t.max):r=a=t,r.x>=this.min.x&&a.x<=this.max.x&&r.y>=this.min.y&&a.y<=this.max.y},intersects:function(t){t=Q(t);var r=this.min,a=this.max,c=t.min,f=t.max,g=f.x>=r.x&&c.x<=a.x,b=f.y>=r.y&&c.y<=a.y;return g&&b},overlaps:function(t){t=Q(t);var r=this.min,a=this.max,c=t.min,f=t.max,g=f.x>r.x&&c.x<a.x,b=f.y>r.y&&c.y<a.y;return g&&b},isValid:function(){return!!(this.min&&this.max)},pad:function(t){var r=this.min,a=this.max,c=Math.abs(r.x-a.x)*t,f=Math.abs(r.y-a.y)*t;return Q(N(r.x-c,r.y-f),N(a.x+c,a.y+f))},equals:function(t){return t?(t=Q(t),this.min.equals(t.getTopLeft())&&this.max.equals(t.getBottomRight())):!1}};function Q(t,r){return!t||t instanceof et?t:new et(t,r)}function ft(t,r){if(t)for(var a=r?[t,r]:t,c=0,f=a.length;c<f;c++)this.extend(a[c])}ft.prototype={extend:function(t){var r=this._southWest,a=this._northEast,c,f;if(t instanceof st)c=t,f=t;else if(t instanceof ft){if(c=t._southWest,f=t._northEast,!c||!f)return this}else return t?this.extend(lt(t)||ct(t)):this;return!r&&!a?(this._southWest=new st(c.lat,c.lng),this._northEast=new st(f.lat,f.lng)):(r.lat=Math.min(c.lat,r.lat),r.lng=Math.min(c.lng,r.lng),a.lat=Math.max(f.lat,a.lat),a.lng=Math.max(f.lng,a.lng)),this},pad:function(t){var r=this._southWest,a=this._northEast,c=Math.abs(r.lat-a.lat)*t,f=Math.abs(r.lng-a.lng)*t;return new ft(new st(r.lat-c,r.lng-f),new st(a.lat+c,a.lng+f))},getCenter:function(){return new st((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new st(this.getNorth(),this.getWest())},getSouthEast:function(){return new st(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){typeof t[0]=="number"||t instanceof st||"lat"in t?t=lt(t):t=ct(t);var r=this._southWest,a=this._northEast,c,f;return t instanceof ft?(c=t.getSouthWest(),f=t.getNorthEast()):c=f=t,c.lat>=r.lat&&f.lat<=a.lat&&c.lng>=r.lng&&f.lng<=a.lng},intersects:function(t){t=ct(t);var r=this._southWest,a=this._northEast,c=t.getSouthWest(),f=t.getNorthEast(),g=f.lat>=r.lat&&c.lat<=a.lat,b=f.lng>=r.lng&&c.lng<=a.lng;return g&&b},overlaps:function(t){t=ct(t);var r=this._southWest,a=this._northEast,c=t.getSouthWest(),f=t.getNorthEast(),g=f.lat>r.lat&&c.lat<a.lat,b=f.lng>r.lng&&c.lng<a.lng;return g&&b},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t,r){return t?(t=ct(t),this._southWest.equals(t.getSouthWest(),r)&&this._northEast.equals(t.getNorthEast(),r)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ct(t,r){return t instanceof ft?t:new ft(t,r)}function st(t,r,a){if(isNaN(t)||isNaN(r))throw new Error("Invalid LatLng object: ("+t+", "+r+")");this.lat=+t,this.lng=+r,a!==void 0&&(this.alt=+a)}st.prototype={equals:function(t,r){if(!t)return!1;t=lt(t);var a=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return a<=(r===void 0?1e-9:r)},toString:function(t){return"LatLng("+v(this.lat,t)+", "+v(this.lng,t)+")"},distanceTo:function(t){return Nt.distance(this,lt(t))},wrap:function(){return Nt.wrapLatLng(this)},toBounds:function(t){var r=180*t/40075017,a=r/Math.cos(Math.PI/180*this.lat);return ct([this.lat-r,this.lng-a],[this.lat+r,this.lng+a])},clone:function(){return new st(this.lat,this.lng,this.alt)}};function lt(t,r,a){return t instanceof st?t:M(t)&&typeof t[0]!="object"?t.length===3?new st(t[0],t[1],t[2]):t.length===2?new st(t[0],t[1]):null:t==null?t:typeof t=="object"&&"lat"in t?new st(t.lat,"lng"in t?t.lng:t.lon,t.alt):r===void 0?null:new st(t,r,a)}var Dt={latLngToPoint:function(t,r){var a=this.projection.project(t),c=this.scale(r);return this.transformation._transform(a,c)},pointToLatLng:function(t,r){var a=this.scale(r),c=this.transformation.untransform(t,a);return this.projection.unproject(c)},project:function(t){return this.projection.project(t)},unproject:function(t){return this.projection.unproject(t)},scale:function(t){return 256*Math.pow(2,t)},zoom:function(t){return Math.log(t/256)/Math.LN2},getProjectedBounds:function(t){if(this.infinite)return null;var r=this.projection.bounds,a=this.scale(t),c=this.transformation.transform(r.min,a),f=this.transformation.transform(r.max,a);return new et(c,f)},infinite:!1,wrapLatLng:function(t){var r=this.wrapLng?p(t.lng,this.wrapLng,!0):t.lng,a=this.wrapLat?p(t.lat,this.wrapLat,!0):t.lat,c=t.alt;return new st(a,r,c)},wrapLatLngBounds:function(t){var r=t.getCenter(),a=this.wrapLatLng(r),c=r.lat-a.lat,f=r.lng-a.lng;if(c===0&&f===0)return t;var g=t.getSouthWest(),b=t.getNorthEast(),E=new st(g.lat-c,g.lng-f),D=new st(b.lat-c,b.lng-f);return new ft(E,D)}},Nt=s({},Dt,{wrapLng:[-180,180],R:6371e3,distance:function(t,r){var a=Math.PI/180,c=t.lat*a,f=r.lat*a,g=Math.sin((r.lat-t.lat)*a/2),b=Math.sin((r.lng-t.lng)*a/2),E=g*g+Math.cos(c)*Math.cos(f)*b*b,D=2*Math.atan2(Math.sqrt(E),Math.sqrt(1-E));return this.R*D}}),Gr=6378137,En={R:Gr,MAX_LATITUDE:85.0511287798,project:function(t){var r=Math.PI/180,a=this.MAX_LATITUDE,c=Math.max(Math.min(a,t.lat),-a),f=Math.sin(c*r);return new Z(this.R*t.lng*r,this.R*Math.log((1+f)/(1-f))/2)},unproject:function(t){var r=180/Math.PI;return new st((2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*r,t.x*r/this.R)},bounds:function(){var t=Gr*Math.PI;return new et([-t,-t],[t,t])}()};function Tn(t,r,a,c){if(M(t)){this._a=t[0],this._b=t[1],this._c=t[2],this._d=t[3];return}this._a=t,this._b=r,this._c=a,this._d=c}Tn.prototype={transform:function(t,r){return this._transform(t.clone(),r)},_transform:function(t,r){return r=r||1,t.x=r*(this._a*t.x+this._b),t.y=r*(this._c*t.y+this._d),t},untransform:function(t,r){return r=r||1,new Z((t.x/r-this._b)/this._a,(t.y/r-this._d)/this._c)}};function ri(t,r,a,c){return new Tn(t,r,a,c)}var zn=s({},Nt,{code:"EPSG:3857",projection:En,transformation:function(){var t=.5/(Math.PI*En.R);return ri(t,.5,-t,.5)}()}),Cl=s({},zn,{code:"EPSG:900913"});function qr(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Kr(t,r){var a="",c,f,g,b,E,D;for(c=0,g=t.length;c<g;c++){for(E=t[c],f=0,b=E.length;f<b;f++)D=E[f],a+=(f?"L":"M")+D.x+" "+D.y;a+=r?X.svg?"z":"x":""}return a||"M0 0"}var In=document.documentElement.style,Fi="ActiveXObject"in window,Ml=Fi&&!document.addEventListener,$r="msLaunchUri"in navigator&&!("documentMode"in document),Dn=Kt("webkit"),Jr=Kt("android"),Qr=Kt("android 2")||Kt("android 3"),kl=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),Ll=Jr&&Kt("Google")&&kl<537&&!("AudioNode"in window),On=!!window.opera,to=!$r&&Kt("chrome"),eo=Kt("gecko")&&!Dn&&!On&&!Fi,Sl=!to&&Kt("safari"),io=Kt("phantom"),no="OTransition"in In,El=navigator.platform.indexOf("Win")===0,ro=Fi&&"transition"in In,An="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Qr,oo="MozPerspective"in In,Tl=!window.L_DISABLE_3D&&(ro||An||oo)&&!no&&!io,oi=typeof orientation<"u"||Kt("mobile"),zl=oi&&Dn,Il=oi&&An,so=!window.PointerEvent&&window.MSPointerEvent,ao=!!(window.PointerEvent||so),lo="ontouchstart"in window||!!window.TouchEvent,Dl=!window.L_NO_TOUCH&&(lo||ao),Ol=oi&&On,Al=oi&&eo,Bl=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Fl=function(){var t=!1;try{var r=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("testPassiveEventSupport",m,r),window.removeEventListener("testPassiveEventSupport",m,r)}catch{}return t}(),Rl=function(){return!!document.createElement("canvas").getContext}(),Bn=!!(document.createElementNS&&qr("svg").createSVGRect),Zl=!!Bn&&function(){var t=document.createElement("div");return t.innerHTML="<svg/>",(t.firstChild&&t.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),jl=!Bn&&function(){try{var t=document.createElement("div");t.innerHTML='<v:shape adj="1"/>';var r=t.firstChild;return r.style.behavior="url(#default#VML)",r&&typeof r.adj=="object"}catch{return!1}}(),Nl=navigator.platform.indexOf("Mac")===0,Wl=navigator.platform.indexOf("Linux")===0;function Kt(t){return navigator.userAgent.toLowerCase().indexOf(t)>=0}var X={ie:Fi,ielt9:Ml,edge:$r,webkit:Dn,android:Jr,android23:Qr,androidStock:Ll,opera:On,chrome:to,gecko:eo,safari:Sl,phantom:io,opera12:no,win:El,ie3d:ro,webkit3d:An,gecko3d:oo,any3d:Tl,mobile:oi,mobileWebkit:zl,mobileWebkit3d:Il,msPointer:so,pointer:ao,touch:Dl,touchNative:lo,mobileOpera:Ol,mobileGecko:Al,retina:Bl,passiveEvents:Fl,canvas:Rl,svg:Bn,vml:jl,inlineSvg:Zl,mac:Nl,linux:Wl},ho=X.msPointer?"MSPointerDown":"pointerdown",co=X.msPointer?"MSPointerMove":"pointermove",uo=X.msPointer?"MSPointerUp":"pointerup",fo=X.msPointer?"MSPointerCancel":"pointercancel",Fn={touchstart:ho,touchmove:co,touchend:uo,touchcancel:fo},po={touchstart:Gl,touchmove:Ri,touchend:Ri,touchcancel:Ri},Se={},_o=!1;function Ul(t,r,a){return r==="touchstart"&&Xl(),po[r]?(a=po[r].bind(this,a),t.addEventListener(Fn[r],a,!1),a):(console.warn("wrong event specified:",r),m)}function Vl(t,r,a){if(!Fn[r]){console.warn("wrong event specified:",r);return}t.removeEventListener(Fn[r],a,!1)}function Hl(t){Se[t.pointerId]=t}function Yl(t){Se[t.pointerId]&&(Se[t.pointerId]=t)}function go(t){delete Se[t.pointerId]}function Xl(){_o||(document.addEventListener(ho,Hl,!0),document.addEventListener(co,Yl,!0),document.addEventListener(uo,go,!0),document.addEventListener(fo,go,!0),_o=!0)}function Ri(t,r){if(r.pointerType!==(r.MSPOINTER_TYPE_MOUSE||"mouse")){r.touches=[];for(var a in Se)r.touches.push(Se[a]);r.changedTouches=[r],t(r)}}function Gl(t,r){r.MSPOINTER_TYPE_TOUCH&&r.pointerType===r.MSPOINTER_TYPE_TOUCH&&Ct(r),Ri(t,r)}function ql(t){var r={},a,c;for(c in t)a=t[c],r[c]=a&&a.bind?a.bind(t):a;return t=r,r.type="dblclick",r.detail=2,r.isTrusted=!1,r._simulated=!0,r}var Kl=200;function $l(t,r){t.addEventListener("dblclick",r);var a=0,c;function f(g){if(g.detail!==1){c=g.detail;return}if(!(g.pointerType==="mouse"||g.sourceCapabilities&&!g.sourceCapabilities.firesTouchEvents)){var b=xo(g);if(!(b.some(function(D){return D instanceof HTMLLabelElement&&D.attributes.for})&&!b.some(function(D){return D instanceof HTMLInputElement||D instanceof HTMLSelectElement}))){var E=Date.now();E-a<=Kl?(c++,c===2&&r(ql(g))):c=1,a=E}}}return t.addEventListener("click",f),{dblclick:r,simDblclick:f}}function Jl(t,r){t.removeEventListener("dblclick",r.dblclick),t.removeEventListener("click",r.simDblclick)}var Rn=Ni(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),si=Ni(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),mo=si==="webkitTransition"||si==="OTransition"?si+"End":"transitionend";function yo(t){return typeof t=="string"?document.getElementById(t):t}function ai(t,r){var a=t.style[r]||t.currentStyle&&t.currentStyle[r];if((!a||a==="auto")&&document.defaultView){var c=document.defaultView.getComputedStyle(t,null);a=c?c[r]:null}return a==="auto"?null:a}function ot(t,r,a){var c=document.createElement(t);return c.className=r||"",a&&a.appendChild(c),c}function _t(t){var r=t.parentNode;r&&r.removeChild(t)}function Zi(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function Ee(t){var r=t.parentNode;r&&r.lastChild!==t&&r.appendChild(t)}function Te(t){var r=t.parentNode;r&&r.firstChild!==t&&r.insertBefore(t,r.firstChild)}function Zn(t,r){if(t.classList!==void 0)return t.classList.contains(r);var a=ji(t);return a.length>0&&new RegExp("(^|\\s)"+r+"(\\s|$)").test(a)}function it(t,r){if(t.classList!==void 0)for(var a=P(r),c=0,f=a.length;c<f;c++)t.classList.add(a[c]);else if(!Zn(t,r)){var g=ji(t);jn(t,(g?g+" ":"")+r)}}function gt(t,r){t.classList!==void 0?t.classList.remove(r):jn(t,x((" "+ji(t)+" ").replace(" "+r+" "," ")))}function jn(t,r){t.className.baseVal===void 0?t.className=r:t.className.baseVal=r}function ji(t){return t.correspondingElement&&(t=t.correspondingElement),t.className.baseVal===void 0?t.className:t.className.baseVal}function Ot(t,r){"opacity"in t.style?t.style.opacity=r:"filter"in t.style&&Ql(t,r)}function Ql(t,r){var a=!1,c="DXImageTransform.Microsoft.Alpha";try{a=t.filters.item(c)}catch{if(r===1)return}r=Math.round(r*100),a?(a.Enabled=r!==100,a.Opacity=r):t.style.filter+=" progid:"+c+"(opacity="+r+")"}function Ni(t){for(var r=document.documentElement.style,a=0;a<t.length;a++)if(t[a]in r)return t[a];return!1}function pe(t,r,a){var c=r||new Z(0,0);t.style[Rn]=(X.ie3d?"translate("+c.x+"px,"+c.y+"px)":"translate3d("+c.x+"px,"+c.y+"px,0)")+(a?" scale("+a+")":"")}function mt(t,r){t._leaflet_pos=r,X.any3d?pe(t,r):(t.style.left=r.x+"px",t.style.top=r.y+"px")}function _e(t){return t._leaflet_pos||new Z(0,0)}var li,hi,Nn;if("onselectstart"in document)li=function(){tt(window,"selectstart",Ct)},hi=function(){ut(window,"selectstart",Ct)};else{var ci=Ni(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);li=function(){if(ci){var t=document.documentElement.style;Nn=t[ci],t[ci]="none"}},hi=function(){ci&&(document.documentElement.style[ci]=Nn,Nn=void 0)}}function Wn(){tt(window,"dragstart",Ct)}function Un(){ut(window,"dragstart",Ct)}var Wi,Vn;function Hn(t){for(;t.tabIndex===-1;)t=t.parentNode;t.style&&(Ui(),Wi=t,Vn=t.style.outline,t.style.outline="none",tt(window,"keydown",Ui))}function Ui(){Wi&&(Wi.style.outline=Vn,Wi=void 0,Vn=void 0,ut(window,"keydown",Ui))}function vo(t){do t=t.parentNode;while((!t.offsetWidth||!t.offsetHeight)&&t!==document.body);return t}function Yn(t){var r=t.getBoundingClientRect();return{x:r.width/t.offsetWidth||1,y:r.height/t.offsetHeight||1,boundingClientRect:r}}var th={__proto__:null,TRANSFORM:Rn,TRANSITION:si,TRANSITION_END:mo,get:yo,getStyle:ai,create:ot,remove:_t,empty:Zi,toFront:Ee,toBack:Te,hasClass:Zn,addClass:it,removeClass:gt,setClass:jn,getClass:ji,setOpacity:Ot,testProp:Ni,setTransform:pe,setPosition:mt,getPosition:_e,get disableTextSelection(){return li},get enableTextSelection(){return hi},disableImageDrag:Wn,enableImageDrag:Un,preventOutline:Hn,restoreOutline:Ui,getSizedParentNode:vo,getScale:Yn};function tt(t,r,a,c){if(r&&typeof r=="object")for(var f in r)Gn(t,f,r[f],a);else{r=P(r);for(var g=0,b=r.length;g<b;g++)Gn(t,r[g],a,c)}return this}var $t="_leaflet_events";function ut(t,r,a,c){if(arguments.length===1)wo(t),delete t[$t];else if(r&&typeof r=="object")for(var f in r)qn(t,f,r[f],a);else if(r=P(r),arguments.length===2)wo(t,function(E){return k(r,E)!==-1});else for(var g=0,b=r.length;g<b;g++)qn(t,r[g],a,c);return this}function wo(t,r){for(var a in t[$t]){var c=a.split(/\d/)[0];(!r||r(c))&&qn(t,c,null,null,a)}}var Xn={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Gn(t,r,a,c){var f=r+d(a)+(c?"_"+d(c):"");if(t[$t]&&t[$t][f])return this;var g=function(E){return a.call(c||t,E||window.event)},b=g;!X.touchNative&&X.pointer&&r.indexOf("touch")===0?g=Ul(t,r,g):X.touch&&r==="dblclick"?g=$l(t,g):"addEventListener"in t?r==="touchstart"||r==="touchmove"||r==="wheel"||r==="mousewheel"?t.addEventListener(Xn[r]||r,g,X.passiveEvents?{passive:!1}:!1):r==="mouseenter"||r==="mouseleave"?(g=function(E){E=E||window.event,$n(t,E)&&b(E)},t.addEventListener(Xn[r],g,!1)):t.addEventListener(r,b,!1):t.attachEvent("on"+r,g),t[$t]=t[$t]||{},t[$t][f]=g}function qn(t,r,a,c,f){f=f||r+d(a)+(c?"_"+d(c):"");var g=t[$t]&&t[$t][f];if(!g)return this;!X.touchNative&&X.pointer&&r.indexOf("touch")===0?Vl(t,r,g):X.touch&&r==="dblclick"?Jl(t,g):"removeEventListener"in t?t.removeEventListener(Xn[r]||r,g,!1):t.detachEvent("on"+r,g),t[$t][f]=null}function ge(t){return t.stopPropagation?t.stopPropagation():t.originalEvent?t.originalEvent._stopped=!0:t.cancelBubble=!0,this}function Kn(t){return Gn(t,"wheel",ge),this}function ui(t){return tt(t,"mousedown touchstart dblclick contextmenu",ge),t._leaflet_disable_click=!0,this}function Ct(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this}function me(t){return Ct(t),ge(t),this}function xo(t){if(t.composedPath)return t.composedPath();for(var r=[],a=t.target;a;)r.push(a),a=a.parentNode;return r}function bo(t,r){if(!r)return new Z(t.clientX,t.clientY);var a=Yn(r),c=a.boundingClientRect;return new Z((t.clientX-c.left)/a.x-r.clientLeft,(t.clientY-c.top)/a.y-r.clientTop)}var eh=X.linux&&X.chrome?window.devicePixelRatio:X.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Po(t){return X.edge?t.wheelDeltaY/2:t.deltaY&&t.deltaMode===0?-t.deltaY/eh:t.deltaY&&t.deltaMode===1?-t.deltaY*20:t.deltaY&&t.deltaMode===2?-t.deltaY*60:t.deltaX||t.deltaZ?0:t.wheelDelta?(t.wheelDeltaY||t.wheelDelta)/2:t.detail&&Math.abs(t.detail)<32765?-t.detail*20:t.detail?t.detail/-32765*60:0}function $n(t,r){var a=r.relatedTarget;if(!a)return!0;try{for(;a&&a!==t;)a=a.parentNode}catch{return!1}return a!==t}var ih={__proto__:null,on:tt,off:ut,stopPropagation:ge,disableScrollPropagation:Kn,disableClickPropagation:ui,preventDefault:Ct,stop:me,getPropagationPath:xo,getMousePosition:bo,getWheelDelta:Po,isExternalTarget:$n,addListener:tt,removeListener:ut},Co=Y.extend({run:function(t,r,a,c){this.stop(),this._el=t,this._inProgress=!0,this._duration=a||.25,this._easeOutPower=1/Math.max(c||.5,.2),this._startPos=_e(t),this._offset=r.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=V(this._animate,this),this._step()},_step:function(t){var r=+new Date-this._startTime,a=this._duration*1e3;r<a?this._runFrame(this._easeOut(r/a),t):(this._runFrame(1),this._complete())},_runFrame:function(t,r){var a=this._startPos.add(this._offset.multiplyBy(t));r&&a._round(),mt(this._el,a),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),rt=Y.extend({options:{crs:zn,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(t,r){r=T(this,r),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(t),this._initLayout(),this._onResize=h(this._onResize,this),this._initEvents(),r.maxBounds&&this.setMaxBounds(r.maxBounds),r.zoom!==void 0&&(this._zoom=this._limitZoom(r.zoom)),r.center&&r.zoom!==void 0&&this.setView(lt(r.center),r.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=si&&X.any3d&&!X.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),tt(this._proxy,mo,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(t,r,a){if(r=r===void 0?this._zoom:this._limitZoom(r),t=this._limitCenter(lt(t),r,this.options.maxBounds),a=a||{},this._stop(),this._loaded&&!a.reset&&a!==!0){a.animate!==void 0&&(a.zoom=s({animate:a.animate},a.zoom),a.pan=s({animate:a.animate,duration:a.duration},a.pan));var c=this._zoom!==r?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,r,a.zoom):this._tryAnimatedPan(t,a.pan);if(c)return clearTimeout(this._sizeTimer),this}return this._resetView(t,r,a.pan&&a.pan.noMoveStart),this},setZoom:function(t,r){return this._loaded?this.setView(this.getCenter(),t,{zoom:r}):(this._zoom=t,this)},zoomIn:function(t,r){return t=t||(X.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+t,r)},zoomOut:function(t,r){return t=t||(X.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-t,r)},setZoomAround:function(t,r,a){var c=this.getZoomScale(r),f=this.getSize().divideBy(2),g=t instanceof Z?t:this.latLngToContainerPoint(t),b=g.subtract(f).multiplyBy(1-1/c),E=this.containerPointToLatLng(f.add(b));return this.setView(E,r,{zoom:a})},_getBoundsCenterZoom:function(t,r){r=r||{},t=t.getBounds?t.getBounds():ct(t);var a=N(r.paddingTopLeft||r.padding||[0,0]),c=N(r.paddingBottomRight||r.padding||[0,0]),f=this.getBoundsZoom(t,!1,a.add(c));if(f=typeof r.maxZoom=="number"?Math.min(r.maxZoom,f):f,f===1/0)return{center:t.getCenter(),zoom:f};var g=c.subtract(a).divideBy(2),b=this.project(t.getSouthWest(),f),E=this.project(t.getNorthEast(),f),D=this.unproject(b.add(E).divideBy(2).add(g),f);return{center:D,zoom:f}},fitBounds:function(t,r){if(t=ct(t),!t.isValid())throw new Error("Bounds are not valid.");var a=this._getBoundsCenterZoom(t,r);return this.setView(a.center,a.zoom,r)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,r){return this.setView(t,this._zoom,{pan:r})},panBy:function(t,r){if(t=N(t).round(),r=r||{},!t.x&&!t.y)return this.fire("moveend");if(r.animate!==!0&&!this.getSize().contains(t))return this._resetView(this.unproject(this.project(this.getCenter()).add(t)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Co,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),r.noMoveStart||this.fire("movestart"),r.animate!==!1){it(this._mapPane,"leaflet-pan-anim");var a=this._getMapPanePos().subtract(t).round();this._panAnim.run(this._mapPane,a,r.duration||.25,r.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},flyTo:function(t,r,a){if(a=a||{},a.animate===!1||!X.any3d)return this.setView(t,r,a);this._stop();var c=this.project(this.getCenter()),f=this.project(t),g=this.getSize(),b=this._zoom;t=lt(t),r=r===void 0?b:r;var E=Math.max(g.x,g.y),D=E*this.getZoomScale(b,r),R=f.distanceTo(c)||1,U=1.42,$=U*U;function nt(yt){var nn=yt?-1:1,Vh=yt?D:E,Hh=D*D-E*E+nn*$*$*R*R,Yh=2*Vh*$*R,lr=Hh/Yh,rs=Math.sqrt(lr*lr+1)-lr,Xh=rs<1e-9?-18:Math.log(rs);return Xh}function Bt(yt){return(Math.exp(yt)-Math.exp(-yt))/2}function ve(yt){return(Math.exp(yt)+Math.exp(-yt))/2}function en(yt){return Bt(yt)/ve(yt)}var ce=nt(0);function ar(yt){return E*(ve(ce)/ve(ce+U*yt))}function jh(yt){return E*(ve(ce)*en(ce+U*yt)-Bt(ce))/$}function Nh(yt){return 1-Math.pow(1-yt,1.5)}var Wh=Date.now(),is=(nt(1)-ce)/U,Uh=a.duration?1e3*a.duration:1e3*is*.8;function ns(){var yt=(Date.now()-Wh)/Uh,nn=Nh(yt)*is;yt<=1?(this._flyToFrame=V(ns,this),this._move(this.unproject(c.add(f.subtract(c).multiplyBy(jh(nn)/R)),b),this.getScaleZoom(E/ar(nn),b),{flyTo:!0})):this._move(t,r)._moveEnd(!0)}return this._moveStart(!0,a.noMoveStart),ns.call(this),this},flyToBounds:function(t,r){var a=this._getBoundsCenterZoom(t,r);return this.flyTo(a.center,a.zoom,r)},setMaxBounds:function(t){return t=ct(t),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),t.isValid()?(this.options.maxBounds=t,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(t){var r=this.options.minZoom;return this.options.minZoom=t,this._loaded&&r!==t&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(t):this},setMaxZoom:function(t){var r=this.options.maxZoom;return this.options.maxZoom=t,this._loaded&&r!==t&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(t):this},panInsideBounds:function(t,r){this._enforcingBounds=!0;var a=this.getCenter(),c=this._limitCenter(a,this._zoom,ct(t));return a.equals(c)||this.panTo(c,r),this._enforcingBounds=!1,this},panInside:function(t,r){r=r||{};var a=N(r.paddingTopLeft||r.padding||[0,0]),c=N(r.paddingBottomRight||r.padding||[0,0]),f=this.project(this.getCenter()),g=this.project(t),b=this.getPixelBounds(),E=Q([b.min.add(a),b.max.subtract(c)]),D=E.getSize();if(!E.contains(g)){this._enforcingBounds=!0;var R=g.subtract(E.getCenter()),U=E.extend(g).getSize().subtract(D);f.x+=R.x<0?-U.x:U.x,f.y+=R.y<0?-U.y:U.y,this.panTo(this.unproject(f),r),this._enforcingBounds=!1}return this},invalidateSize:function(t){if(!this._loaded)return this;t=s({animate:!1,pan:!0},t===!0?{animate:!0}:t);var r=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var a=this.getSize(),c=r.divideBy(2).round(),f=a.divideBy(2).round(),g=c.subtract(f);return!g.x&&!g.y?this:(t.animate&&t.pan?this.panBy(g):(t.pan&&this._rawPanBy(g),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(h(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:r,newSize:a}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(t){if(t=this._locateOptions=s({timeout:1e4,watch:!1},t),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var r=h(this._handleGeolocationResponse,this),a=h(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(r,a,t):navigator.geolocation.getCurrentPosition(r,a,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){if(this._container._leaflet_id){var r=t.code,a=t.message||(r===1?"permission denied":r===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:r,message:"Geolocation error: "+a+"."})}},_handleGeolocationResponse:function(t){if(this._container._leaflet_id){var r=t.coords.latitude,a=t.coords.longitude,c=new st(r,a),f=c.toBounds(t.coords.accuracy*2),g=this._locateOptions;if(g.setView){var b=this.getBoundsZoom(f);this.setView(c,g.maxZoom?Math.min(b,g.maxZoom):b)}var E={latlng:c,bounds:f,timestamp:t.timestamp};for(var D in t.coords)typeof t.coords[D]=="number"&&(E[D]=t.coords[D]);this.fire("locationfound",E)}},addHandler:function(t,r){if(!r)return this;var a=this[t]=new r(this);return this._handlers.push(a),this.options[t]&&a.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),_t(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var t;for(t in this._layers)this._layers[t].remove();for(t in this._panes)_t(this._panes[t]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(t,r){var a="leaflet-pane"+(t?" leaflet-"+t.replace("Pane","")+"-pane":""),c=ot("div",a,r||this._mapPane);return t&&(this._panes[t]=c),c},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),r=this.unproject(t.getBottomLeft()),a=this.unproject(t.getTopRight());return new ft(r,a)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,r,a){t=ct(t),a=N(a||[0,0]);var c=this.getZoom()||0,f=this.getMinZoom(),g=this.getMaxZoom(),b=t.getNorthWest(),E=t.getSouthEast(),D=this.getSize().subtract(a),R=Q(this.project(E,c),this.project(b,c)).getSize(),U=X.any3d?this.options.zoomSnap:1,$=D.x/R.x,nt=D.y/R.y,Bt=r?Math.max($,nt):Math.min($,nt);return c=this.getScaleZoom(Bt,c),U&&(c=Math.round(c/(U/100))*(U/100),c=r?Math.ceil(c/U)*U:Math.floor(c/U)*U),Math.max(f,Math.min(g,c))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new Z(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(t,r){var a=this._getTopLeftPoint(t,r);return new et(a,a.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(t){return this.options.crs.getProjectedBounds(t===void 0?this.getZoom():t)},getPane:function(t){return typeof t=="string"?this._panes[t]:t},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t,r){var a=this.options.crs;return r=r===void 0?this._zoom:r,a.scale(t)/a.scale(r)},getScaleZoom:function(t,r){var a=this.options.crs;r=r===void 0?this._zoom:r;var c=a.zoom(t*a.scale(r));return isNaN(c)?1/0:c},project:function(t,r){return r=r===void 0?this._zoom:r,this.options.crs.latLngToPoint(lt(t),r)},unproject:function(t,r){return r=r===void 0?this._zoom:r,this.options.crs.pointToLatLng(N(t),r)},layerPointToLatLng:function(t){var r=N(t).add(this.getPixelOrigin());return this.unproject(r)},latLngToLayerPoint:function(t){var r=this.project(lt(t))._round();return r._subtract(this.getPixelOrigin())},wrapLatLng:function(t){return this.options.crs.wrapLatLng(lt(t))},wrapLatLngBounds:function(t){return this.options.crs.wrapLatLngBounds(ct(t))},distance:function(t,r){return this.options.crs.distance(lt(t),lt(r))},containerPointToLayerPoint:function(t){return N(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return N(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var r=this.containerPointToLayerPoint(N(t));return this.layerPointToLatLng(r)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(lt(t)))},mouseEventToContainerPoint:function(t){return bo(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var r=this._container=yo(t);if(r){if(r._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");tt(r,"scroll",this._onScroll,this),this._containerId=d(r)},_initLayout:function(){var t=this._container;this._fadeAnimated=this.options.fadeAnimation&&X.any3d,it(t,"leaflet-container"+(X.touch?" leaflet-touch":"")+(X.retina?" leaflet-retina":"")+(X.ielt9?" leaflet-oldie":"")+(X.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var r=ai(t,"position");r!=="absolute"&&r!=="relative"&&r!=="fixed"&&r!=="sticky"&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),mt(this._mapPane,new Z(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(it(t.markerPane,"leaflet-zoom-hide"),it(t.shadowPane,"leaflet-zoom-hide"))},_resetView:function(t,r,a){mt(this._mapPane,new Z(0,0));var c=!this._loaded;this._loaded=!0,r=this._limitZoom(r),this.fire("viewprereset");var f=this._zoom!==r;this._moveStart(f,a)._move(t,r)._moveEnd(f),this.fire("viewreset"),c&&this.fire("load")},_moveStart:function(t,r){return t&&this.fire("zoomstart"),r||this.fire("movestart"),this},_move:function(t,r,a,c){r===void 0&&(r=this._zoom);var f=this._zoom!==r;return this._zoom=r,this._lastCenter=t,this._pixelOrigin=this._getNewPixelOrigin(t),c?a&&a.pinch&&this.fire("zoom",a):((f||a&&a.pinch)&&this.fire("zoom",a),this.fire("move",a)),this},_moveEnd:function(t){return t&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(t){mt(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(t){this._targets={},this._targets[d(this._container)]=this;var r=t?ut:tt;r(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&r(window,"resize",this._onResize,this),X.any3d&&this.options.transform3DLimit&&(t?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=V(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var t=this._getMapPanePos();Math.max(Math.abs(t.x),Math.abs(t.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(t,r){for(var a=[],c,f=r==="mouseout"||r==="mouseover",g=t.target||t.srcElement,b=!1;g;){if(c=this._targets[d(g)],c&&(r==="click"||r==="preclick")&&this._draggableMoved(c)){b=!0;break}if(c&&c.listens(r,!0)&&(f&&!$n(g,t)||(a.push(c),f))||g===this._container)break;g=g.parentNode}return!a.length&&!b&&!f&&this.listens(r,!0)&&(a=[this]),a},_isClickDisabled:function(t){for(;t&&t!==this._container;){if(t._leaflet_disable_click)return!0;t=t.parentNode}},_handleDOMEvent:function(t){var r=t.target||t.srcElement;if(!(!this._loaded||r._leaflet_disable_events||t.type==="click"&&this._isClickDisabled(r))){var a=t.type;a==="mousedown"&&Hn(r),this._fireDOMEvent(t,a)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(t,r,a){if(t.type==="click"){var c=s({},t);c.type="preclick",this._fireDOMEvent(c,c.type,a)}var f=this._findEventTargets(t,r);if(a){for(var g=[],b=0;b<a.length;b++)a[b].listens(r,!0)&&g.push(a[b]);f=g.concat(f)}if(f.length){r==="contextmenu"&&Ct(t);var E=f[0],D={originalEvent:t};if(t.type!=="keypress"&&t.type!=="keydown"&&t.type!=="keyup"){var R=E.getLatLng&&(!E._radius||E._radius<=10);D.containerPoint=R?this.latLngToContainerPoint(E.getLatLng()):this.mouseEventToContainerPoint(t),D.layerPoint=this.containerPointToLayerPoint(D.containerPoint),D.latlng=R?E.getLatLng():this.layerPointToLatLng(D.layerPoint)}for(b=0;b<f.length;b++)if(f[b].fire(r,D,!0),D.originalEvent._stopped||f[b].options.bubblingMouseEvents===!1&&k(this._mouseEvents,r)!==-1)return}},_draggableMoved:function(t){return t=t.dragging&&t.dragging.enabled()?t:this,t.dragging&&t.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var t=0,r=this._handlers.length;t<r;t++)this._handlers[t].disable()},whenReady:function(t,r){return this._loaded?t.call(r||this,{target:this}):this.on("load",t,r),this},_getMapPanePos:function(){return _e(this._mapPane)||new Z(0,0)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(t,r){var a=t&&r!==void 0?this._getNewPixelOrigin(t,r):this.getPixelOrigin();return a.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(t,r){var a=this.getSize()._divideBy(2);return this.project(t,r)._subtract(a)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(t,r,a){var c=this._getNewPixelOrigin(a,r);return this.project(t,r)._subtract(c)},_latLngBoundsToNewLayerBounds:function(t,r,a){var c=this._getNewPixelOrigin(a,r);return Q([this.project(t.getSouthWest(),r)._subtract(c),this.project(t.getNorthWest(),r)._subtract(c),this.project(t.getSouthEast(),r)._subtract(c),this.project(t.getNorthEast(),r)._subtract(c)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,r,a){if(!a)return t;var c=this.project(t,r),f=this.getSize().divideBy(2),g=new et(c.subtract(f),c.add(f)),b=this._getBoundsOffset(g,a,r);return Math.abs(b.x)<=1&&Math.abs(b.y)<=1?t:this.unproject(c.add(b),r)},_limitOffset:function(t,r){if(!r)return t;var a=this.getPixelBounds(),c=new et(a.min.add(t),a.max.add(t));return t.add(this._getBoundsOffset(c,r))},_getBoundsOffset:function(t,r,a){var c=Q(this.project(r.getNorthEast(),a),this.project(r.getSouthWest(),a)),f=c.min.subtract(t.min),g=c.max.subtract(t.max),b=this._rebound(f.x,-g.x),E=this._rebound(f.y,-g.y);return new Z(b,E)},_rebound:function(t,r){return t+r>0?Math.round(t-r)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(r))},_limitZoom:function(t){var r=this.getMinZoom(),a=this.getMaxZoom(),c=X.any3d?this.options.zoomSnap:1;return c&&(t=Math.round(t/c)*c),Math.max(r,Math.min(a,t))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){gt(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,r){var a=this._getCenterOffset(t)._trunc();return(r&&r.animate)!==!0&&!this.getSize().contains(a)?!1:(this.panBy(a,r),!0)},_createAnimProxy:function(){var t=this._proxy=ot("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(t),this.on("zoomanim",function(r){var a=Rn,c=this._proxy.style[a];pe(this._proxy,this.project(r.center,r.zoom),this.getZoomScale(r.zoom,1)),c===this._proxy.style[a]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){_t(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var t=this.getCenter(),r=this.getZoom();pe(this._proxy,this.project(t,r),this.getZoomScale(r,1))},_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,r,a){if(this._animatingZoom)return!0;if(a=a||{},!this._zoomAnimated||a.animate===!1||this._nothingToAnimate()||Math.abs(r-this._zoom)>this.options.zoomAnimationThreshold)return!1;var c=this.getZoomScale(r),f=this._getCenterOffset(t)._divideBy(1-1/c);return a.animate!==!0&&!this.getSize().contains(f)?!1:(V(function(){this._moveStart(!0,!1)._animateZoom(t,r,!0)},this),!0)},_animateZoom:function(t,r,a,c){this._mapPane&&(a&&(this._animatingZoom=!0,this._animateToCenter=t,this._animateToZoom=r,it(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:t,zoom:r,noUpdate:c}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(h(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&gt(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function nh(t,r){return new rt(t,r)}var Wt=y.extend({options:{position:"topright"},initialize:function(t){T(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var r=this._map;return r&&r.removeControl(this),this.options.position=t,r&&r.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this.remove(),this._map=t;var r=this._container=this.onAdd(t),a=this.getPosition(),c=t._controlCorners[a];return it(r,"leaflet-control"),a.indexOf("bottom")!==-1?c.insertBefore(r,c.firstChild):c.appendChild(r),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(_t(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(t){this._map&&t&&t.screenX>0&&t.screenY>0&&this._map.getContainer().focus()}}),di=function(t){return new Wt(t)};rt.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.remove(),this},_initControlPos:function(){var t=this._controlCorners={},r="leaflet-",a=this._controlContainer=ot("div",r+"control-container",this._container);function c(f,g){var b=r+f+" "+r+g;t[f+g]=ot("div",b,a)}c("top","left"),c("top","right"),c("bottom","left"),c("bottom","right")},_clearControlPos:function(){for(var t in this._controlCorners)_t(this._controlCorners[t]);_t(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Mo=Wt.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(t,r,a,c){return a<c?-1:c<a?1:0}},initialize:function(t,r,a){T(this,a),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1;for(var c in t)this._addLayer(t[c],c);for(c in r)this._addLayer(r[c],c,!0)},onAdd:function(t){this._initLayout(),this._update(),this._map=t,t.on("zoomend",this._checkDisabledLayers,this);for(var r=0;r<this._layers.length;r++)this._layers[r].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(t){return Wt.prototype.addTo.call(this,t),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var t=0;t<this._layers.length;t++)this._layers[t].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(t,r){return this._addLayer(t,r),this._map?this._update():this},addOverlay:function(t,r){return this._addLayer(t,r,!0),this._map?this._update():this},removeLayer:function(t){t.off("add remove",this._onLayerChange,this);var r=this._getLayer(d(t));return r&&this._layers.splice(this._layers.indexOf(r),1),this._map?this._update():this},expand:function(){it(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var t=this._map.getSize().y-(this._container.offsetTop+50);return t<this._section.clientHeight?(it(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=t+"px"):gt(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return gt(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var t="leaflet-control-layers",r=this._container=ot("div",t),a=this.options.collapsed;r.setAttribute("aria-haspopup",!0),ui(r),Kn(r);var c=this._section=ot("section",t+"-list");a&&(this._map.on("click",this.collapse,this),tt(r,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var f=this._layersLink=ot("a",t+"-toggle",r);f.href="#",f.title="Layers",f.setAttribute("role","button"),tt(f,{keydown:function(g){g.keyCode===13&&this._expandSafely()},click:function(g){Ct(g),this._expandSafely()}},this),a||this.expand(),this._baseLayersList=ot("div",t+"-base",c),this._separator=ot("div",t+"-separator",c),this._overlaysList=ot("div",t+"-overlays",c),r.appendChild(c)},_getLayer:function(t){for(var r=0;r<this._layers.length;r++)if(this._layers[r]&&d(this._layers[r].layer)===t)return this._layers[r]},_addLayer:function(t,r,a){this._map&&t.on("add remove",this._onLayerChange,this),this._layers.push({layer:t,name:r,overlay:a}),this.options.sortLayers&&this._layers.sort(h(function(c,f){return this.options.sortFunction(c.layer,f.layer,c.name,f.name)},this)),this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Zi(this._baseLayersList),Zi(this._overlaysList),this._layerControlInputs=[];var t,r,a,c,f=0;for(a=0;a<this._layers.length;a++)c=this._layers[a],this._addItem(c),r=r||c.overlay,t=t||!c.overlay,f+=c.overlay?0:1;return this.options.hideSingleBase&&(t=t&&f>1,this._baseLayersList.style.display=t?"":"none"),this._separator.style.display=r&&t?"":"none",this},_onLayerChange:function(t){this._handlingClick||this._update();var r=this._getLayer(d(t.target)),a=r.overlay?t.type==="add"?"overlayadd":"overlayremove":t.type==="add"?"baselayerchange":null;a&&this._map.fire(a,r)},_createRadioElement:function(t,r){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"'+(r?' checked="checked"':"")+"/>",c=document.createElement("div");return c.innerHTML=a,c.firstChild},_addItem:function(t){var r=document.createElement("label"),a=this._map.hasLayer(t.layer),c;t.overlay?(c=document.createElement("input"),c.type="checkbox",c.className="leaflet-control-layers-selector",c.defaultChecked=a):c=this._createRadioElement("leaflet-base-layers_"+d(this),a),this._layerControlInputs.push(c),c.layerId=d(t.layer),tt(c,"click",this._onInputClick,this);var f=document.createElement("span");f.innerHTML=" "+t.name;var g=document.createElement("span");r.appendChild(g),g.appendChild(c),g.appendChild(f);var b=t.overlay?this._overlaysList:this._baseLayersList;return b.appendChild(r),this._checkDisabledLayers(),r},_onInputClick:function(){var t=this._layerControlInputs,r,a,c=[],f=[];this._handlingClick=!0;for(var g=t.length-1;g>=0;g--)r=t[g],a=this._getLayer(r.layerId).layer,r.checked?c.push(a):r.checked||f.push(a);for(g=0;g<f.length;g++)this._map.hasLayer(f[g])&&this._map.removeLayer(f[g]);for(g=0;g<c.length;g++)this._map.hasLayer(c[g])||this._map.addLayer(c[g]);this._handlingClick=!1,this._refocusOnMap()},_checkDisabledLayers:function(){for(var t=this._layerControlInputs,r,a,c=this._map.getZoom(),f=t.length-1;f>=0;f--)r=t[f],a=this._getLayer(r.layerId).layer,r.disabled=a.options.minZoom!==void 0&&c<a.options.minZoom||a.options.maxZoom!==void 0&&c>a.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var t=this._section;tt(t,"click",Ct),this.expand(),setTimeout(function(){ut(t,"click",Ct)})}}),rh=function(t,r,a){return new Mo(t,r,a)},Jn=Wt.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(t){var r="leaflet-control-zoom",a=ot("div",r+" leaflet-bar"),c=this.options;return this._zoomInButton=this._createButton(c.zoomInText,c.zoomInTitle,r+"-in",a,this._zoomIn),this._zoomOutButton=this._createButton(c.zoomOutText,c.zoomOutTitle,r+"-out",a,this._zoomOut),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),a},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(t){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(t.shiftKey?3:1))},_zoomOut:function(t){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(t.shiftKey?3:1))},_createButton:function(t,r,a,c,f){var g=ot("a",a,c);return g.innerHTML=t,g.href="#",g.title=r,g.setAttribute("role","button"),g.setAttribute("aria-label",r),ui(g),tt(g,"click",me),tt(g,"click",f,this),tt(g,"click",this._refocusOnMap,this),g},_updateDisabled:function(){var t=this._map,r="leaflet-disabled";gt(this._zoomInButton,r),gt(this._zoomOutButton,r),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||t._zoom===t.getMinZoom())&&(it(this._zoomOutButton,r),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||t._zoom===t.getMaxZoom())&&(it(this._zoomInButton,r),this._zoomInButton.setAttribute("aria-disabled","true"))}});rt.mergeOptions({zoomControl:!0}),rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Jn,this.addControl(this.zoomControl))});var oh=function(t){return new Jn(t)},ko=Wt.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(t){var r="leaflet-control-scale",a=ot("div",r),c=this.options;return this._addScales(c,r+"-line",a),t.on(c.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),a},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,r,a){t.metric&&(this._mScale=ot("div",r,a)),t.imperial&&(this._iScale=ot("div",r,a))},_update:function(){var t=this._map,r=t.getSize().y/2,a=t.distance(t.containerPointToLatLng([0,r]),t.containerPointToLatLng([this.options.maxWidth,r]));this._updateScales(a)},_updateScales:function(t){this.options.metric&&t&&this._updateMetric(t),this.options.imperial&&t&&this._updateImperial(t)},_updateMetric:function(t){var r=this._getRoundNum(t),a=r<1e3?r+" m":r/1e3+" km";this._updateScale(this._mScale,a,r/t)},_updateImperial:function(t){var r=t*3.2808399,a,c,f;r>5280?(a=r/5280,c=this._getRoundNum(a),this._updateScale(this._iScale,c+" mi",c/a)):(f=this._getRoundNum(r),this._updateScale(this._iScale,f+" ft",f/r))},_updateScale:function(t,r,a){t.style.width=Math.round(this.options.maxWidth*a)+"px",t.innerHTML=r},_getRoundNum:function(t){var r=Math.pow(10,(Math.floor(t)+"").length-1),a=t/r;return a=a>=10?10:a>=5?5:a>=3?3:a>=2?2:1,r*a}}),sh=function(t){return new ko(t)},ah='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Qn=Wt.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(X.inlineSvg?ah+" ":"")+"Leaflet</a>"},initialize:function(t){T(this,t),this._attributions={}},onAdd:function(t){t.attributionControl=this,this._container=ot("div","leaflet-control-attribution"),ui(this._container);for(var r in t._layers)t._layers[r].getAttribution&&this.addAttribution(t._layers[r].getAttribution());return this._update(),t.on("layeradd",this._addAttribution,this),this._container},onRemove:function(t){t.off("layeradd",this._addAttribution,this)},_addAttribution:function(t){t.layer.getAttribution&&(this.addAttribution(t.layer.getAttribution()),t.layer.once("remove",function(){this.removeAttribution(t.layer.getAttribution())},this))},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):this},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):this},_update:function(){if(this._map){var t=[];for(var r in this._attributions)this._attributions[r]&&t.push(r);var a=[];this.options.prefix&&a.push(this.options.prefix),t.length&&a.push(t.join(", ")),this._container.innerHTML=a.join(' <span aria-hidden="true">|</span> ')}}});rt.mergeOptions({attributionControl:!0}),rt.addInitHook(function(){this.options.attributionControl&&new Qn().addTo(this)});var lh=function(t){return new Qn(t)};Wt.Layers=Mo,Wt.Zoom=Jn,Wt.Scale=ko,Wt.Attribution=Qn,di.layers=rh,di.zoom=oh,di.scale=sh,di.attribution=lh;var Jt=y.extend({initialize:function(t){this._map=t},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Jt.addTo=function(t,r){return t.addHandler(r,this),this};var hh={Events:S},Lo=X.touch?"touchstart mousedown":"mousedown",le=Y.extend({options:{clickTolerance:3},initialize:function(t,r,a,c){T(this,c),this._element=t,this._dragStartTarget=r||t,this._preventOutline=a},enable:function(){this._enabled||(tt(this._dragStartTarget,Lo,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(le._dragging===this&&this.finishDrag(!0),ut(this._dragStartTarget,Lo,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(t){if(this._enabled&&(this._moved=!1,!Zn(this._element,"leaflet-zoom-anim"))){if(t.touches&&t.touches.length!==1){le._dragging===this&&this.finishDrag();return}if(!(le._dragging||t.shiftKey||t.which!==1&&t.button!==1&&!t.touches)&&(le._dragging=this,this._preventOutline&&Hn(this._element),Wn(),li(),!this._moving)){this.fire("down");var r=t.touches?t.touches[0]:t,a=vo(this._element);this._startPoint=new Z(r.clientX,r.clientY),this._startPos=_e(this._element),this._parentScale=Yn(a);var c=t.type==="mousedown";tt(document,c?"mousemove":"touchmove",this._onMove,this),tt(document,c?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(t){if(this._enabled){if(t.touches&&t.touches.length>1){this._moved=!0;return}var r=t.touches&&t.touches.length===1?t.touches[0]:t,a=new Z(r.clientX,r.clientY)._subtract(this._startPoint);!a.x&&!a.y||Math.abs(a.x)+Math.abs(a.y)<this.options.clickTolerance||(a.x/=this._parentScale.x,a.y/=this._parentScale.y,Ct(t),this._moved||(this.fire("dragstart"),this._moved=!0,it(document.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),it(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(a),this._moving=!0,this._lastEvent=t,this._updatePosition())}},_updatePosition:function(){var t={originalEvent:this._lastEvent};this.fire("predrag",t),mt(this._element,this._newPos),this.fire("drag",t)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(t){gt(document.body,"leaflet-dragging"),this._lastTarget&&(gt(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),ut(document,"mousemove touchmove",this._onMove,this),ut(document,"mouseup touchend touchcancel",this._onUp,this),Un(),hi(),this._moved&&this._moving&&this.fire("dragend",{noInertia:t,distance:this._newPos.distanceTo(this._startPos)}),this._moving=!1,le._dragging=!1}});function So(t,r){if(!r||!t.length)return t.slice();var a=r*r;return t=dh(t,a),t=uh(t,a),t}function Eo(t,r,a){return Math.sqrt(fi(t,r,a,!0))}function ch(t,r,a){return fi(t,r,a)}function uh(t,r){var a=t.length,c=typeof Uint8Array<"u"?Uint8Array:Array,f=new c(a);f[0]=f[a-1]=1,tr(t,f,r,0,a-1);var g,b=[];for(g=0;g<a;g++)f[g]&&b.push(t[g]);return b}function tr(t,r,a,c,f){var g=0,b,E,D;for(E=c+1;E<=f-1;E++)D=fi(t[E],t[c],t[f],!0),D>g&&(b=E,g=D);g>a&&(r[b]=1,tr(t,r,a,c,b),tr(t,r,a,b,f))}function dh(t,r){for(var a=[t[0]],c=1,f=0,g=t.length;c<g;c++)fh(t[c],t[f])>r&&(a.push(t[c]),f=c);return f<g-1&&a.push(t[g-1]),a}var To;function zo(t,r,a,c,f){var g=c?To:ye(t,a),b=ye(r,a),E,D,R;for(To=b;;){if(!(g|b))return[t,r];if(g&b)return!1;E=g||b,D=Vi(t,r,E,a,f),R=ye(D,a),E===g?(t=D,g=R):(r=D,b=R)}}function Vi(t,r,a,c,f){var g=r.x-t.x,b=r.y-t.y,E=c.min,D=c.max,R,U;return a&8?(R=t.x+g*(D.y-t.y)/b,U=D.y):a&4?(R=t.x+g*(E.y-t.y)/b,U=E.y):a&2?(R=D.x,U=t.y+b*(D.x-t.x)/g):a&1&&(R=E.x,U=t.y+b*(E.x-t.x)/g),new Z(R,U,f)}function ye(t,r){var a=0;return t.x<r.min.x?a|=1:t.x>r.max.x&&(a|=2),t.y<r.min.y?a|=4:t.y>r.max.y&&(a|=8),a}function fh(t,r){var a=r.x-t.x,c=r.y-t.y;return a*a+c*c}function fi(t,r,a,c){var f=r.x,g=r.y,b=a.x-f,E=a.y-g,D=b*b+E*E,R;return D>0&&(R=((t.x-f)*b+(t.y-g)*E)/D,R>1?(f=a.x,g=a.y):R>0&&(f+=b*R,g+=E*R)),b=t.x-f,E=t.y-g,c?b*b+E*E:new Z(f,g)}function At(t){return!M(t[0])||typeof t[0][0]!="object"&&typeof t[0][0]<"u"}function Io(t){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),At(t)}function Do(t,r){var a,c,f,g,b,E,D,R;if(!t||t.length===0)throw new Error("latlngs not passed");At(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var U=[];for(var $ in t)U.push(r.project(lt(t[$])));var nt=U.length;for(a=0,c=0;a<nt-1;a++)c+=U[a].distanceTo(U[a+1])/2;if(c===0)R=U[0];else for(a=0,g=0;a<nt-1;a++)if(b=U[a],E=U[a+1],f=b.distanceTo(E),g+=f,g>c){D=(g-c)/f,R=[E.x-D*(E.x-b.x),E.y-D*(E.y-b.y)];break}return r.unproject(N(R))}var ph={__proto__:null,simplify:So,pointToSegmentDistance:Eo,closestPointOnSegment:ch,clipSegment:zo,_getEdgeIntersection:Vi,_getBitCode:ye,_sqClosestPointOnSegment:fi,isFlat:At,_flat:Io,polylineCenter:Do};function Oo(t,r,a){var c,f=[1,4,2,8],g,b,E,D,R,U,$,nt;for(g=0,U=t.length;g<U;g++)t[g]._code=ye(t[g],r);for(E=0;E<4;E++){for($=f[E],c=[],g=0,U=t.length,b=U-1;g<U;b=g++)D=t[g],R=t[b],D._code&$?R._code&$||(nt=Vi(R,D,$,r,a),nt._code=ye(nt,r),c.push(nt)):(R._code&$&&(nt=Vi(R,D,$,r,a),nt._code=ye(nt,r),c.push(nt)),c.push(D));t=c}return t}function Ao(t,r){var a,c,f,g,b,E,D,R,U;if(!t||t.length===0)throw new Error("latlngs not passed");At(t)||(console.warn("latlngs are not flat! Only the first ring will be used"),t=t[0]);var $=[];for(var nt in t)$.push(r.project(lt(t[nt])));var Bt=$.length;for(E=D=R=0,a=0,c=Bt-1;a<Bt;c=a++)f=$[a],g=$[c],b=f.y*g.x-g.y*f.x,D+=(f.x+g.x)*b,R+=(f.y+g.y)*b,E+=b*3;return E===0?U=$[0]:U=[D/E,R/E],r.unproject(N(U))}var _h={__proto__:null,clipPolygon:Oo,polygonCenter:Ao},er={project:function(t){return new Z(t.lng,t.lat)},unproject:function(t){return new st(t.y,t.x)},bounds:new et([-180,-90],[180,90])},ir={R:6378137,R_MINOR:6356752314245179e-9,bounds:new et([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(t){var r=Math.PI/180,a=this.R,c=t.lat*r,f=this.R_MINOR/a,g=Math.sqrt(1-f*f),b=g*Math.sin(c),E=Math.tan(Math.PI/4-c/2)/Math.pow((1-b)/(1+b),g/2);return c=-a*Math.log(Math.max(E,1e-10)),new Z(t.lng*r*a,c)},unproject:function(t){for(var r=180/Math.PI,a=this.R,c=this.R_MINOR/a,f=Math.sqrt(1-c*c),g=Math.exp(-t.y/a),b=Math.PI/2-2*Math.atan(g),E=0,D=.1,R;E<15&&Math.abs(D)>1e-7;E++)R=f*Math.sin(b),R=Math.pow((1-R)/(1+R),f/2),D=Math.PI/2-2*Math.atan(g*R)-b,b+=D;return new st(b*r,t.x*r/a)}},gh={__proto__:null,LonLat:er,Mercator:ir,SphericalMercator:En},mh=s({},Nt,{code:"EPSG:3395",projection:ir,transformation:function(){var t=.5/(Math.PI*ir.R);return ri(t,.5,-t,.5)}()}),Bo=s({},Nt,{code:"EPSG:4326",projection:er,transformation:ri(1/180,1,-1/180,.5)}),yh=s({},Dt,{projection:er,transformation:ri(1,0,-1,0),scale:function(t){return Math.pow(2,t)},zoom:function(t){return Math.log(t)/Math.LN2},distance:function(t,r){var a=r.lng-t.lng,c=r.lat-t.lat;return Math.sqrt(a*a+c*c)},infinite:!0});Dt.Earth=Nt,Dt.EPSG3395=mh,Dt.EPSG3857=zn,Dt.EPSG900913=Cl,Dt.EPSG4326=Bo,Dt.Simple=yh;var Ut=Y.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(t){return t.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(t){return t&&t.removeLayer(this),this},getPane:function(t){return this._map.getPane(t?this.options[t]||t:this.options.pane)},addInteractiveTarget:function(t){return this._map._targets[d(t)]=this,this},removeInteractiveTarget:function(t){return delete this._map._targets[d(t)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(t){var r=t.target;if(r.hasLayer(this)){if(this._map=r,this._zoomAnimated=r._zoomAnimated,this.getEvents){var a=this.getEvents();r.on(a,this),this.once("remove",function(){r.off(a,this)},this)}this.onAdd(r),this.fire("add"),r.fire("layeradd",{layer:this})}}});rt.include({addLayer:function(t){if(!t._layerAdd)throw new Error("The provided object is not a Layer.");var r=d(t);return this._layers[r]?this:(this._layers[r]=t,t._mapToAdd=this,t.beforeAdd&&t.beforeAdd(this),this.whenReady(t._layerAdd,t),this)},removeLayer:function(t){var r=d(t);return this._layers[r]?(this._loaded&&t.onRemove(this),delete this._layers[r],this._loaded&&(this.fire("layerremove",{layer:t}),t.fire("remove")),t._map=t._mapToAdd=null,this):this},hasLayer:function(t){return d(t)in this._layers},eachLayer:function(t,r){for(var a in this._layers)t.call(r,this._layers[a]);return this},_addLayers:function(t){t=t?M(t)?t:[t]:[];for(var r=0,a=t.length;r<a;r++)this.addLayer(t[r])},_addZoomLimit:function(t){(!isNaN(t.options.maxZoom)||!isNaN(t.options.minZoom))&&(this._zoomBoundLayers[d(t)]=t,this._updateZoomLevels())},_removeZoomLimit:function(t){var r=d(t);this._zoomBoundLayers[r]&&(delete this._zoomBoundLayers[r],this._updateZoomLevels())},_updateZoomLevels:function(){var t=1/0,r=-1/0,a=this._getZoomSpan();for(var c in this._zoomBoundLayers){var f=this._zoomBoundLayers[c].options;t=f.minZoom===void 0?t:Math.min(t,f.minZoom),r=f.maxZoom===void 0?r:Math.max(r,f.maxZoom)}this._layersMaxZoom=r===-1/0?void 0:r,this._layersMinZoom=t===1/0?void 0:t,a!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var ze=Ut.extend({initialize:function(t,r){T(this,r),this._layers={};var a,c;if(t)for(a=0,c=t.length;a<c;a++)this.addLayer(t[a])},addLayer:function(t){var r=this.getLayerId(t);return this._layers[r]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var r=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[r]&&this._map.removeLayer(this._layers[r]),delete this._layers[r],this},hasLayer:function(t){var r=typeof t=="number"?t:this.getLayerId(t);return r in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(t){var r=Array.prototype.slice.call(arguments,1),a,c;for(a in this._layers)c=this._layers[a],c[t]&&c[t].apply(c,r);return this},onAdd:function(t){this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t)},eachLayer:function(t,r){for(var a in this._layers)t.call(r,this._layers[a]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];return this.eachLayer(t.push,t),t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return d(t)}}),vh=function(t,r){return new ze(t,r)},te=ze.extend({addLayer:function(t){return this.hasLayer(t)?this:(t.addEventParent(this),ze.prototype.addLayer.call(this,t),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.removeEventParent(this),ze.prototype.removeLayer.call(this,t),this.fire("layerremove",{layer:t})):this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new ft;for(var r in this._layers){var a=this._layers[r];t.extend(a.getBounds?a.getBounds():a.getLatLng())}return t}}),wh=function(t,r){return new te(t,r)},Ie=y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(t){T(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,r){var a=this._getIconUrl(t);if(!a){if(t==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var c=this._createImg(a,r&&r.tagName==="IMG"?r:null);return this._setIconStyles(c,t),(this.options.crossOrigin||this.options.crossOrigin==="")&&(c.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),c},_setIconStyles:function(t,r){var a=this.options,c=a[r+"Size"];typeof c=="number"&&(c=[c,c]);var f=N(c),g=N(r==="shadow"&&a.shadowAnchor||a.iconAnchor||f&&f.divideBy(2,!0));t.className="leaflet-marker-"+r+" "+(a.className||""),g&&(t.style.marginLeft=-g.x+"px",t.style.marginTop=-g.y+"px"),f&&(t.style.width=f.x+"px",t.style.height=f.y+"px")},_createImg:function(t,r){return r=r||document.createElement("img"),r.src=t,r},_getIconUrl:function(t){return X.retina&&this.options[t+"RetinaUrl"]||this.options[t+"Url"]}});function xh(t){return new Ie(t)}var pi=Ie.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(t){return typeof pi.imagePath!="string"&&(pi.imagePath=this._detectIconPath()),(this.options.imagePath||pi.imagePath)+Ie.prototype._getIconUrl.call(this,t)},_stripUrl:function(t){var r=function(a,c,f){var g=c.exec(a);return g&&g[f]};return t=r(t,/^url\((['"])?(.+)\1\)$/,2),t&&r(t,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var t=ot("div","leaflet-default-icon-path",document.body),r=ai(t,"background-image")||ai(t,"backgroundImage");if(document.body.removeChild(t),r=this._stripUrl(r),r)return r;var a=document.querySelector('link[href$="leaflet.css"]');return a?a.href.substring(0,a.href.length-11-1):""}}),Fo=Jt.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new le(t,t,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),it(t,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&gt(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(t){var r=this._marker,a=r._map,c=this._marker.options.autoPanSpeed,f=this._marker.options.autoPanPadding,g=_e(r._icon),b=a.getPixelBounds(),E=a.getPixelOrigin(),D=Q(b.min._subtract(E).add(f),b.max._subtract(E).subtract(f));if(!D.contains(g)){var R=N((Math.max(D.max.x,g.x)-D.max.x)/(b.max.x-D.max.x)-(Math.min(D.min.x,g.x)-D.min.x)/(b.min.x-D.min.x),(Math.max(D.max.y,g.y)-D.max.y)/(b.max.y-D.max.y)-(Math.min(D.min.y,g.y)-D.min.y)/(b.min.y-D.min.y)).multiplyBy(c);a.panBy(R,{animate:!1}),this._draggable._newPos._add(R),this._draggable._startPos._add(R),mt(r._icon,this._draggable._newPos),this._onDrag(t),this._panRequest=V(this._adjustPan.bind(this,t))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(t){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=V(this._adjustPan.bind(this,t)))},_onDrag:function(t){var r=this._marker,a=r._shadow,c=_e(r._icon),f=r._map.layerPointToLatLng(c);a&&mt(a,c),r._latlng=f,t.latlng=f,t.oldLatLng=this._oldLatLng,r.fire("move",t).fire("drag",t)},_onDragEnd:function(t){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",t)}}),Hi=Ut.extend({options:{icon:new pi,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(t,r){T(this,r),this._latlng=lt(t)},onAdd:function(t){this._zoomAnimated=this._zoomAnimated&&t.options.markerZoomAnimation,this._zoomAnimated&&t.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(t){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&t.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(t){var r=this._latlng;return this._latlng=lt(t),this.update(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update()},getIcon:function(){return this.options.icon},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,r="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),a=t.icon.createIcon(this._icon),c=!1;a!==this._icon&&(this._icon&&this._removeIcon(),c=!0,t.title&&(a.title=t.title),a.tagName==="IMG"&&(a.alt=t.alt||"")),it(a,r),t.keyboard&&(a.tabIndex="0",a.setAttribute("role","button")),this._icon=a,t.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&tt(a,"focus",this._panOnFocus,this);var f=t.icon.createShadow(this._shadow),g=!1;f!==this._shadow&&(this._removeShadow(),g=!0),f&&(it(f,r),f.alt=""),this._shadow=f,t.opacity<1&&this._updateOpacity(),c&&this.getPane().appendChild(this._icon),this._initInteraction(),f&&g&&this.getPane(t.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ut(this._icon,"focus",this._panOnFocus,this),_t(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&_t(this._shadow),this._shadow=null},_setPos:function(t){this._icon&&mt(this._icon,t),this._shadow&&mt(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon&&(this._icon.style.zIndex=this._zIndex+t)},_animateZoom:function(t){var r=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(r)},_initInteraction:function(){if(this.options.interactive&&(it(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Fo)){var t=this.options.draggable;this.dragging&&(t=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Fo(this),t&&this.dragging.enable()}},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var t=this.options.opacity;this._icon&&Ot(this._icon,t),this._shadow&&Ot(this._shadow,t)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var t=this._map;if(t){var r=this.options.icon.options,a=r.iconSize?N(r.iconSize):N(0,0),c=r.iconAnchor?N(r.iconAnchor):N(0,0);t.panInside(this._latlng,{paddingTopLeft:c,paddingBottomRight:a.subtract(c)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function bh(t,r){return new Hi(t,r)}var he=Ut.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(t){this._renderer=t.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(t){return T(this,t),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&t&&Object.prototype.hasOwnProperty.call(t,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Yi=he.extend({options:{fill:!0,radius:10},initialize:function(t,r){T(this,r),this._latlng=lt(t),this._radius=this.options.radius},setLatLng:function(t){var r=this._latlng;return this._latlng=lt(t),this.redraw(),this.fire("move",{oldLatLng:r,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius},setStyle:function(t){var r=t&&t.radius||this._radius;return he.prototype.setStyle.call(this,t),this.setRadius(r),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var t=this._radius,r=this._radiusY||t,a=this._clickTolerance(),c=[t+a,r+a];this._pxBounds=new et(this._point.subtract(c),this._point.add(c))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(t){return t.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ph(t,r){return new Yi(t,r)}var nr=Yi.extend({initialize:function(t,r,a){if(typeof r=="number"&&(r=s({},a,{radius:r})),T(this,r),this._latlng=lt(t),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(t){return this._mRadius=t,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var t=[this._radius,this._radiusY||this._radius];return new ft(this._map.layerPointToLatLng(this._point.subtract(t)),this._map.layerPointToLatLng(this._point.add(t)))},setStyle:he.prototype.setStyle,_project:function(){var t=this._latlng.lng,r=this._latlng.lat,a=this._map,c=a.options.crs;if(c.distance===Nt.distance){var f=Math.PI/180,g=this._mRadius/Nt.R/f,b=a.project([r+g,t]),E=a.project([r-g,t]),D=b.add(E).divideBy(2),R=a.unproject(D).lat,U=Math.acos((Math.cos(g*f)-Math.sin(r*f)*Math.sin(R*f))/(Math.cos(r*f)*Math.cos(R*f)))/f;(isNaN(U)||U===0)&&(U=g/Math.cos(Math.PI/180*r)),this._point=D.subtract(a.getPixelOrigin()),this._radius=isNaN(U)?0:D.x-a.project([R,t-U]).x,this._radiusY=D.y-b.y}else{var $=c.unproject(c.project(this._latlng).subtract([this._mRadius,0]));this._point=a.latLngToLayerPoint(this._latlng),this._radius=this._point.x-a.latLngToLayerPoint($).x}this._updateBounds()}});function Ch(t,r,a){return new nr(t,r,a)}var ee=he.extend({options:{smoothFactor:1,noClip:!1},initialize:function(t,r){T(this,r),this._setLatLngs(t)},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._setLatLngs(t),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(t){for(var r=1/0,a=null,c=fi,f,g,b=0,E=this._parts.length;b<E;b++)for(var D=this._parts[b],R=1,U=D.length;R<U;R++){f=D[R-1],g=D[R];var $=c(t,f,g,!0);$<r&&(r=$,a=c(t,f,g))}return a&&(a.distance=Math.sqrt(r)),a},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Do(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(t,r){return r=r||this._defaultShape(),t=lt(t),r.push(t),this._bounds.extend(t),this.redraw()},_setLatLngs:function(t){this._bounds=new ft,this._latlngs=this._convertLatLngs(t)},_defaultShape:function(){return At(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(t){for(var r=[],a=At(t),c=0,f=t.length;c<f;c++)a?(r[c]=lt(t[c]),this._bounds.extend(r[c])):r[c]=this._convertLatLngs(t[c]);return r},_project:function(){var t=new et;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,t),this._bounds.isValid()&&t.isValid()&&(this._rawPxBounds=t,this._updateBounds())},_updateBounds:function(){var t=this._clickTolerance(),r=new Z(t,t);this._rawPxBounds&&(this._pxBounds=new et([this._rawPxBounds.min.subtract(r),this._rawPxBounds.max.add(r)]))},_projectLatlngs:function(t,r,a){var c=t[0]instanceof st,f=t.length,g,b;if(c){for(b=[],g=0;g<f;g++)b[g]=this._map.latLngToLayerPoint(t[g]),a.extend(b[g]);r.push(b)}else for(g=0;g<f;g++)this._projectLatlngs(t[g],r,a)},_clipPoints:function(){var t=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}var r=this._parts,a,c,f,g,b,E,D;for(a=0,f=0,g=this._rings.length;a<g;a++)for(D=this._rings[a],c=0,b=D.length;c<b-1;c++)E=zo(D[c],D[c+1],t,c,!0),E&&(r[f]=r[f]||[],r[f].push(E[0]),(E[1]!==D[c+1]||c===b-2)&&(r[f].push(E[1]),f++))}},_simplifyPoints:function(){for(var t=this._parts,r=this.options.smoothFactor,a=0,c=t.length;a<c;a++)t[a]=So(t[a],r)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(t,r){var a,c,f,g,b,E,D=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(a=0,g=this._parts.length;a<g;a++)for(E=this._parts[a],c=0,b=E.length,f=b-1;c<b;f=c++)if(!(!r&&c===0)&&Eo(t,E[f],E[c])<=D)return!0;return!1}});function Mh(t,r){return new ee(t,r)}ee._flat=Io;var De=ee.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ao(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(t){var r=ee.prototype._convertLatLngs.call(this,t),a=r.length;return a>=2&&r[0]instanceof st&&r[0].equals(r[a-1])&&r.pop(),r},_setLatLngs:function(t){ee.prototype._setLatLngs.call(this,t),At(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return At(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var t=this._renderer._bounds,r=this.options.weight,a=new Z(r,r);if(t=new et(t.min.subtract(a),t.max.add(a)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(t))){if(this.options.noClip){this._parts=this._rings;return}for(var c=0,f=this._rings.length,g;c<f;c++)g=Oo(this._rings[c],t,!0),g.length&&this._parts.push(g)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(t){var r=!1,a,c,f,g,b,E,D,R;if(!this._pxBounds||!this._pxBounds.contains(t))return!1;for(g=0,D=this._parts.length;g<D;g++)for(a=this._parts[g],b=0,R=a.length,E=R-1;b<R;E=b++)c=a[b],f=a[E],c.y>t.y!=f.y>t.y&&t.x<(f.x-c.x)*(t.y-c.y)/(f.y-c.y)+c.x&&(r=!r);return r||ee.prototype._containsPoint.call(this,t,!0)}});function kh(t,r){return new De(t,r)}var ie=te.extend({initialize:function(t,r){T(this,r),this._layers={},t&&this.addData(t)},addData:function(t){var r=M(t)?t:t.features,a,c,f;if(r){for(a=0,c=r.length;a<c;a++)f=r[a],(f.geometries||f.geometry||f.features||f.coordinates)&&this.addData(f);return this}var g=this.options;if(g.filter&&!g.filter(t))return this;var b=Xi(t,g);return b?(b.feature=Ki(t),b.defaultOptions=b.options,this.resetStyle(b),g.onEachFeature&&g.onEachFeature(t,b),this.addLayer(b)):this},resetStyle:function(t){return t===void 0?this.eachLayer(this.resetStyle,this):(t.options=s({},t.defaultOptions),this._setLayerStyle(t,this.options.style),this)},setStyle:function(t){return this.eachLayer(function(r){this._setLayerStyle(r,t)},this)},_setLayerStyle:function(t,r){t.setStyle&&(typeof r=="function"&&(r=r(t.feature)),t.setStyle(r))}});function Xi(t,r){var a=t.type==="Feature"?t.geometry:t,c=a?a.coordinates:null,f=[],g=r&&r.pointToLayer,b=r&&r.coordsToLatLng||rr,E,D,R,U;if(!c&&!a)return null;switch(a.type){case"Point":return E=b(c),Ro(g,t,E,r);case"MultiPoint":for(R=0,U=c.length;R<U;R++)E=b(c[R]),f.push(Ro(g,t,E,r));return new te(f);case"LineString":case"MultiLineString":return D=Gi(c,a.type==="LineString"?0:1,b),new ee(D,r);case"Polygon":case"MultiPolygon":return D=Gi(c,a.type==="Polygon"?1:2,b),new De(D,r);case"GeometryCollection":for(R=0,U=a.geometries.length;R<U;R++){var $=Xi({geometry:a.geometries[R],type:"Feature",properties:t.properties},r);$&&f.push($)}return new te(f);case"FeatureCollection":for(R=0,U=a.features.length;R<U;R++){var nt=Xi(a.features[R],r);nt&&f.push(nt)}return new te(f);default:throw new Error("Invalid GeoJSON object.")}}function Ro(t,r,a,c){return t?t(r,a):new Hi(a,c&&c.markersInheritOptions&&c)}function rr(t){return new st(t[1],t[0],t[2])}function Gi(t,r,a){for(var c=[],f=0,g=t.length,b;f<g;f++)b=r?Gi(t[f],r-1,a):(a||rr)(t[f]),c.push(b);return c}function or(t,r){return t=lt(t),t.alt!==void 0?[v(t.lng,r),v(t.lat,r),v(t.alt,r)]:[v(t.lng,r),v(t.lat,r)]}function qi(t,r,a,c){for(var f=[],g=0,b=t.length;g<b;g++)f.push(r?qi(t[g],At(t[g])?0:r-1,a,c):or(t[g],c));return!r&&a&&f.push(f[0].slice()),f}function Oe(t,r){return t.feature?s({},t.feature,{geometry:r}):Ki(r)}function Ki(t){return t.type==="Feature"||t.type==="FeatureCollection"?t:{type:"Feature",properties:{},geometry:t}}var sr={toGeoJSON:function(t){return Oe(this,{type:"Point",coordinates:or(this.getLatLng(),t)})}};Hi.include(sr),nr.include(sr),Yi.include(sr),ee.include({toGeoJSON:function(t){var r=!At(this._latlngs),a=qi(this._latlngs,r?1:0,!1,t);return Oe(this,{type:(r?"Multi":"")+"LineString",coordinates:a})}}),De.include({toGeoJSON:function(t){var r=!At(this._latlngs),a=r&&!At(this._latlngs[0]),c=qi(this._latlngs,a?2:r?1:0,!0,t);return r||(c=[c]),Oe(this,{type:(a?"Multi":"")+"Polygon",coordinates:c})}}),ze.include({toMultiPoint:function(t){var r=[];return this.eachLayer(function(a){r.push(a.toGeoJSON(t).geometry.coordinates)}),Oe(this,{type:"MultiPoint",coordinates:r})},toGeoJSON:function(t){var r=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(r==="MultiPoint")return this.toMultiPoint(t);var a=r==="GeometryCollection",c=[];return this.eachLayer(function(f){if(f.toGeoJSON){var g=f.toGeoJSON(t);if(a)c.push(g.geometry);else{var b=Ki(g);b.type==="FeatureCollection"?c.push.apply(c,b.features):c.push(b)}}}),a?Oe(this,{geometries:c,type:"GeometryCollection"}):{type:"FeatureCollection",features:c}}});function Zo(t,r){return new ie(t,r)}var Lh=Zo,$i=Ut.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(t,r,a){this._url=t,this._bounds=ct(r),T(this,a)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(it(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){_t(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(t){return this.options.opacity=t,this._image&&this._updateOpacity(),this},setStyle:function(t){return t.opacity&&this.setOpacity(t.opacity),this},bringToFront:function(){return this._map&&Ee(this._image),this},bringToBack:function(){return this._map&&Te(this._image),this},setUrl:function(t){return this._url=t,this._image&&(this._image.src=t),this},setBounds:function(t){return this._bounds=ct(t),this._map&&this._reset(),this},getEvents:function(){var t={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var t=this._url.tagName==="IMG",r=this._image=t?this._url:ot("img");if(it(r,"leaflet-image-layer"),this._zoomAnimated&&it(r,"leaflet-zoom-animated"),this.options.className&&it(r,this.options.className),r.onselectstart=m,r.onmousemove=m,r.onload=h(this.fire,this,"load"),r.onerror=h(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(r.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),t){this._url=r.src;return}r.src=this._url,r.alt=this.options.alt},_animateZoom:function(t){var r=this._map.getZoomScale(t.zoom),a=this._map._latLngBoundsToNewLayerBounds(this._bounds,t.zoom,t.center).min;pe(this._image,a,r)},_reset:function(){var t=this._image,r=new et(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),a=r.getSize();mt(t,r.min),t.style.width=a.x+"px",t.style.height=a.y+"px"},_updateOpacity:function(){Ot(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var t=this.options.errorOverlayUrl;t&&this._url!==t&&(this._url=t,this._image.src=t)},getCenter:function(){return this._bounds.getCenter()}}),Sh=function(t,r,a){return new $i(t,r,a)},jo=$i.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var t=this._url.tagName==="VIDEO",r=this._image=t?this._url:ot("video");if(it(r,"leaflet-image-layer"),this._zoomAnimated&&it(r,"leaflet-zoom-animated"),this.options.className&&it(r,this.options.className),r.onselectstart=m,r.onmousemove=m,r.onloadeddata=h(this.fire,this,"load"),t){for(var a=r.getElementsByTagName("source"),c=[],f=0;f<a.length;f++)c.push(a[f].src);this._url=a.length>0?c:[r.src];return}M(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(r.style,"objectFit")&&(r.style.objectFit="fill"),r.autoplay=!!this.options.autoplay,r.loop=!!this.options.loop,r.muted=!!this.options.muted,r.playsInline=!!this.options.playsInline;for(var g=0;g<this._url.length;g++){var b=ot("source");b.src=this._url[g],r.appendChild(b)}}});function Eh(t,r,a){return new jo(t,r,a)}var No=$i.extend({_initImage:function(){var t=this._image=this._url;it(t,"leaflet-image-layer"),this._zoomAnimated&&it(t,"leaflet-zoom-animated"),this.options.className&&it(t,this.options.className),t.onselectstart=m,t.onmousemove=m}});function Th(t,r,a){return new No(t,r,a)}var Qt=Ut.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(t,r){t&&(t instanceof st||M(t))?(this._latlng=lt(t),T(this,r)):(T(this,t),this._source=r),this.options.content&&(this._content=this.options.content)},openOn:function(t){return t=arguments.length?t:this._source._map,t.hasLayer(this)||t.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(t){return this._map?this.close():(arguments.length?this._source=t:t=this._source,this._prepareOpen(),this.openOn(t._map)),this},onAdd:function(t){this._zoomAnimated=t._zoomAnimated,this._container||this._initLayout(),t._fadeAnimated&&Ot(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),t._fadeAnimated&&Ot(this._container,1),this.bringToFront(),this.options.interactive&&(it(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(t){t._fadeAnimated?(Ot(this._container,0),this._removeTimeout=setTimeout(h(_t,void 0,this._container),200)):_t(this._container),this.options.interactive&&(gt(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=lt(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var t={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ee(this._container),this},bringToBack:function(){return this._map&&Te(this._container),this},_prepareOpen:function(t){var r=this._source;if(!r._map)return!1;if(r instanceof te){r=null;var a=this._source._layers;for(var c in a)if(a[c]._map){r=a[c];break}if(!r)return!1;this._source=r}if(!t)if(r.getCenter)t=r.getCenter();else if(r.getLatLng)t=r.getLatLng();else if(r.getBounds)t=r.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(t),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var t=this._contentNode,r=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof r=="string")t.innerHTML=r;else{for(;t.hasChildNodes();)t.removeChild(t.firstChild);t.appendChild(r)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),r=N(this.options.offset),a=this._getAnchor();this._zoomAnimated?mt(this._container,t.add(a)):r=r.add(t).add(a);var c=this._containerBottom=-r.y,f=this._containerLeft=-Math.round(this._containerWidth/2)+r.x;this._container.style.bottom=c+"px",this._container.style.left=f+"px"}},_getAnchor:function(){return[0,0]}});rt.include({_initOverlay:function(t,r,a,c){var f=r;return f instanceof t||(f=new t(c).setContent(r)),a&&f.setLatLng(a),f}}),Ut.include({_initOverlay:function(t,r,a,c){var f=a;return f instanceof t?(T(f,c),f._source=this):(f=r&&!c?r:new t(c,this),f.setContent(a)),f}});var Ji=Qt.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(t){return t=arguments.length?t:this._source._map,!t.hasLayer(this)&&t._popup&&t._popup.options.autoClose&&t.removeLayer(t._popup),t._popup=this,Qt.prototype.openOn.call(this,t)},onAdd:function(t){Qt.prototype.onAdd.call(this,t),t.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof he||this._source.on("preclick",ge))},onRemove:function(t){Qt.prototype.onRemove.call(this,t),t.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof he||this._source.off("preclick",ge))},getEvents:function(){var t=Qt.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this.close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_initLayout:function(){var t="leaflet-popup",r=this._container=ot("div",t+" "+(this.options.className||"")+" leaflet-zoom-animated"),a=this._wrapper=ot("div",t+"-content-wrapper",r);if(this._contentNode=ot("div",t+"-content",a),ui(r),Kn(this._contentNode),tt(r,"contextmenu",ge),this._tipContainer=ot("div",t+"-tip-container",r),this._tip=ot("div",t+"-tip",this._tipContainer),this.options.closeButton){var c=this._closeButton=ot("a",t+"-close-button",r);c.setAttribute("role","button"),c.setAttribute("aria-label","Close popup"),c.href="#close",c.innerHTML='<span aria-hidden="true">&#215;</span>',tt(c,"click",function(f){Ct(f),this.close()},this)}},_updateLayout:function(){var t=this._contentNode,r=t.style;r.width="",r.whiteSpace="nowrap";var a=t.offsetWidth;a=Math.min(a,this.options.maxWidth),a=Math.max(a,this.options.minWidth),r.width=a+1+"px",r.whiteSpace="",r.height="";var c=t.offsetHeight,f=this.options.maxHeight,g="leaflet-popup-scrolled";f&&c>f?(r.height=f+"px",it(t,g)):gt(t,g),this._containerWidth=this._container.offsetWidth},_animateZoom:function(t){var r=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center),a=this._getAnchor();mt(this._container,r.add(a))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var t=this._map,r=parseInt(ai(this._container,"marginBottom"),10)||0,a=this._container.offsetHeight+r,c=this._containerWidth,f=new Z(this._containerLeft,-a-this._containerBottom);f._add(_e(this._container));var g=t.layerPointToContainerPoint(f),b=N(this.options.autoPanPadding),E=N(this.options.autoPanPaddingTopLeft||b),D=N(this.options.autoPanPaddingBottomRight||b),R=t.getSize(),U=0,$=0;g.x+c+D.x>R.x&&(U=g.x+c-R.x+D.x),g.x-U-E.x<0&&(U=g.x-E.x),g.y+a+D.y>R.y&&($=g.y+a-R.y+D.y),g.y-$-E.y<0&&($=g.y-E.y),(U||$)&&(this.options.keepInView&&(this._autopanning=!0),t.fire("autopanstart").panBy([U,$]))}},_getAnchor:function(){return N(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),zh=function(t,r){return new Ji(t,r)};rt.mergeOptions({closePopupOnClick:!0}),rt.include({openPopup:function(t,r,a){return this._initOverlay(Ji,t,r,a).openOn(this),this},closePopup:function(t){return t=arguments.length?t:this._popup,t&&t.close(),this}}),Ut.include({bindPopup:function(t,r){return this._popup=this._initOverlay(Ji,this._popup,t,r),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(t){return this._popup&&(this instanceof te||(this._popup._source=this),this._popup._prepareOpen(t||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},getPopup:function(){return this._popup},_openPopup:function(t){if(!(!this._popup||!this._map)){me(t);var r=t.layer||t.target;if(this._popup._source===r&&!(r instanceof he)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(t.latlng);return}this._popup._source=r,this.openPopup(t.latlng)}},_movePopup:function(t){this._popup.setLatLng(t.latlng)},_onKeyPress:function(t){t.originalEvent.keyCode===13&&this._openPopup(t)}});var Qi=Qt.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(t){Qt.prototype.onAdd.call(this,t),this.setOpacity(this.options.opacity),t.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(t){Qt.prototype.onRemove.call(this,t),t.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var t=Qt.prototype.getEvents.call(this);return this.options.permanent||(t.preclick=this.close),t},_initLayout:function(){var t="leaflet-tooltip",r=t+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=ot("div",r),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(t){var r,a,c=this._map,f=this._container,g=c.latLngToContainerPoint(c.getCenter()),b=c.layerPointToContainerPoint(t),E=this.options.direction,D=f.offsetWidth,R=f.offsetHeight,U=N(this.options.offset),$=this._getAnchor();E==="top"?(r=D/2,a=R):E==="bottom"?(r=D/2,a=0):E==="center"?(r=D/2,a=R/2):E==="right"?(r=0,a=R/2):E==="left"?(r=D,a=R/2):b.x<g.x?(E="right",r=0,a=R/2):(E="left",r=D+(U.x+$.x)*2,a=R/2),t=t.subtract(N(r,a,!0)).add(U).add($),gt(f,"leaflet-tooltip-right"),gt(f,"leaflet-tooltip-left"),gt(f,"leaflet-tooltip-top"),gt(f,"leaflet-tooltip-bottom"),it(f,"leaflet-tooltip-"+E),mt(f,t)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},setOpacity:function(t){this.options.opacity=t,this._container&&Ot(this._container,t)},_animateZoom:function(t){var r=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);this._setPosition(r)},_getAnchor:function(){return N(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Ih=function(t,r){return new Qi(t,r)};rt.include({openTooltip:function(t,r,a){return this._initOverlay(Qi,t,r,a).openOn(this),this},closeTooltip:function(t){return t.close(),this}}),Ut.include({bindTooltip:function(t,r){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Qi,this._tooltip,t,r),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(t){if(!(!t&&this._tooltipHandlersAdded)){var r=t?"off":"on",a={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?a.add=this._openTooltip:(a.mouseover=this._openTooltip,a.mouseout=this.closeTooltip,a.click=this._openTooltip,this._map?this._addFocusListeners():a.add=this._addFocusListeners),this._tooltip.options.sticky&&(a.mousemove=this._moveTooltip),this[r](a),this._tooltipHandlersAdded=!t}},openTooltip:function(t){return this._tooltip&&(this instanceof te||(this._tooltip._source=this),this._tooltip._prepareOpen(t)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(t){return this._tooltip&&this._tooltip.setContent(t),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(t){var r=t.getElement();r&&(tt(r,"focus",function(){this._tooltip._source=t,this.openTooltip()},this),tt(r,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(t){var r=t.getElement();r&&r.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(t){!this._tooltip||!this._map||this._map.dragging&&this._map.dragging.moving()||(this._tooltip._source=t.layer||t.target,this.openTooltip(this._tooltip.options.sticky?t.latlng:void 0))},_moveTooltip:function(t){var r=t.latlng,a,c;this._tooltip.options.sticky&&t.originalEvent&&(a=this._map.mouseEventToContainerPoint(t.originalEvent),c=this._map.containerPointToLayerPoint(a),r=this._map.layerPointToLatLng(c)),this._tooltip.setLatLng(r)}});var Wo=Ie.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(t){var r=t&&t.tagName==="DIV"?t:document.createElement("div"),a=this.options;if(a.html instanceof Element?(Zi(r),r.appendChild(a.html)):r.innerHTML=a.html!==!1?a.html:"",a.bgPos){var c=N(a.bgPos);r.style.backgroundPosition=-c.x+"px "+-c.y+"px"}return this._setIconStyles(r,"icon"),r},createShadow:function(){return null}});function Dh(t){return new Wo(t)}Ie.Default=pi;var _i=Ut.extend({options:{tileSize:256,opacity:1,updateWhenIdle:X.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(t){T(this,t)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(t){t._addZoomLimit(this)},onRemove:function(t){this._removeAllTiles(),_t(this._container),t._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ee(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Te(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var t=this._clampZoom(this._map.getZoom());t!==this._tileZoom&&(this._tileZoom=t,this._updateLevels()),this._update()}return this},getEvents:function(){var t={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=_(this._onMoveEnd,this.options.updateInterval,this)),t.move=this._onMove),this._zoomAnimated&&(t.zoomanim=this._animateZoom),t},createTile:function(){return document.createElement("div")},getTileSize:function(){var t=this.options.tileSize;return t instanceof Z?t:new Z(t,t)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t){for(var r=this.getPane().children,a=-t(-1/0,1/0),c=0,f=r.length,g;c<f;c++)g=r[c].style.zIndex,r[c]!==this._container&&g&&(a=t(a,+g));isFinite(a)&&(this.options.zIndex=a+t(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!X.ielt9){Ot(this._container,this.options.opacity);var t=+new Date,r=!1,a=!1;for(var c in this._tiles){var f=this._tiles[c];if(!(!f.current||!f.loaded)){var g=Math.min(1,(t-f.loaded)/200);Ot(f.el,g),g<1?r=!0:(f.active?a=!0:this._onOpaqueTile(f),f.active=!0)}}a&&!this._noPrune&&this._pruneTiles(),r&&(G(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this))}},_onOpaqueTile:m,_initContainer:function(){this._container||(this._container=ot("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var t=this._tileZoom,r=this.options.maxZoom;if(t!==void 0){for(var a in this._levels)a=Number(a),this._levels[a].el.children.length||a===t?(this._levels[a].el.style.zIndex=r-Math.abs(t-a),this._onUpdateLevel(a)):(_t(this._levels[a].el),this._removeTilesAtZoom(a),this._onRemoveLevel(a),delete this._levels[a]);var c=this._levels[t],f=this._map;return c||(c=this._levels[t]={},c.el=ot("div","leaflet-tile-container leaflet-zoom-animated",this._container),c.el.style.zIndex=r,c.origin=f.project(f.unproject(f.getPixelOrigin()),t).round(),c.zoom=t,this._setZoomTransform(c,f.getCenter(),f.getZoom()),m(c.el.offsetWidth),this._onCreateLevel(c)),this._level=c,c}},_onUpdateLevel:m,_onRemoveLevel:m,_onCreateLevel:m,_pruneTiles:function(){if(this._map){var t,r,a=this._map.getZoom();if(a>this.options.maxZoom||a<this.options.minZoom){this._removeAllTiles();return}for(t in this._tiles)r=this._tiles[t],r.retain=r.current;for(t in this._tiles)if(r=this._tiles[t],r.current&&!r.active){var c=r.coords;this._retainParent(c.x,c.y,c.z,c.z-5)||this._retainChildren(c.x,c.y,c.z,c.z+2)}for(t in this._tiles)this._tiles[t].retain||this._removeTile(t)}},_removeTilesAtZoom:function(t){for(var r in this._tiles)this._tiles[r].coords.z===t&&this._removeTile(r)},_removeAllTiles:function(){for(var t in this._tiles)this._removeTile(t)},_invalidateAll:function(){for(var t in this._levels)_t(this._levels[t].el),this._onRemoveLevel(Number(t)),delete this._levels[t];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(t,r,a,c){var f=Math.floor(t/2),g=Math.floor(r/2),b=a-1,E=new Z(+f,+g);E.z=+b;var D=this._tileCoordsToKey(E),R=this._tiles[D];return R&&R.active?(R.retain=!0,!0):(R&&R.loaded&&(R.retain=!0),b>c?this._retainParent(f,g,b,c):!1)},_retainChildren:function(t,r,a,c){for(var f=2*t;f<2*t+2;f++)for(var g=2*r;g<2*r+2;g++){var b=new Z(f,g);b.z=a+1;var E=this._tileCoordsToKey(b),D=this._tiles[E];if(D&&D.active){D.retain=!0;continue}else D&&D.loaded&&(D.retain=!0);a+1<c&&this._retainChildren(f,g,a+1,c)}},_resetView:function(t){var r=t&&(t.pinch||t.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),r,r)},_animateZoom:function(t){this._setView(t.center,t.zoom,!0,t.noUpdate)},_clampZoom:function(t){var r=this.options;return r.minNativeZoom!==void 0&&t<r.minNativeZoom?r.minNativeZoom:r.maxNativeZoom!==void 0&&r.maxNativeZoom<t?r.maxNativeZoom:t},_setView:function(t,r,a,c){var f=Math.round(r);this.options.maxZoom!==void 0&&f>this.options.maxZoom||this.options.minZoom!==void 0&&f<this.options.minZoom?f=void 0:f=this._clampZoom(f);var g=this.options.updateWhenZooming&&f!==this._tileZoom;(!c||g)&&(this._tileZoom=f,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),f!==void 0&&this._update(t),a||this._pruneTiles(),this._noPrune=!!a),this._setZoomTransforms(t,r)},_setZoomTransforms:function(t,r){for(var a in this._levels)this._setZoomTransform(this._levels[a],t,r)},_setZoomTransform:function(t,r,a){var c=this._map.getZoomScale(a,t.zoom),f=t.origin.multiplyBy(c).subtract(this._map._getNewPixelOrigin(r,a)).round();X.any3d?pe(t.el,f,c):mt(t.el,f)},_resetGrid:function(){var t=this._map,r=t.options.crs,a=this._tileSize=this.getTileSize(),c=this._tileZoom,f=this._map.getPixelWorldBounds(this._tileZoom);f&&(this._globalTileRange=this._pxBoundsToTileRange(f)),this._wrapX=r.wrapLng&&!this.options.noWrap&&[Math.floor(t.project([0,r.wrapLng[0]],c).x/a.x),Math.ceil(t.project([0,r.wrapLng[1]],c).x/a.y)],this._wrapY=r.wrapLat&&!this.options.noWrap&&[Math.floor(t.project([r.wrapLat[0],0],c).y/a.x),Math.ceil(t.project([r.wrapLat[1],0],c).y/a.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(t){var r=this._map,a=r._animatingZoom?Math.max(r._animateToZoom,r.getZoom()):r.getZoom(),c=r.getZoomScale(a,this._tileZoom),f=r.project(t,this._tileZoom).floor(),g=r.getSize().divideBy(c*2);return new et(f.subtract(g),f.add(g))},_update:function(t){var r=this._map;if(r){var a=this._clampZoom(r.getZoom());if(t===void 0&&(t=r.getCenter()),this._tileZoom!==void 0){var c=this._getTiledPixelBounds(t),f=this._pxBoundsToTileRange(c),g=f.getCenter(),b=[],E=this.options.keepBuffer,D=new et(f.getBottomLeft().subtract([E,-E]),f.getTopRight().add([E,-E]));if(!(isFinite(f.min.x)&&isFinite(f.min.y)&&isFinite(f.max.x)&&isFinite(f.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var R in this._tiles){var U=this._tiles[R].coords;(U.z!==this._tileZoom||!D.contains(new Z(U.x,U.y)))&&(this._tiles[R].current=!1)}if(Math.abs(a-this._tileZoom)>1){this._setView(t,a);return}for(var $=f.min.y;$<=f.max.y;$++)for(var nt=f.min.x;nt<=f.max.x;nt++){var Bt=new Z(nt,$);if(Bt.z=this._tileZoom,!!this._isValidTile(Bt)){var ve=this._tiles[this._tileCoordsToKey(Bt)];ve?ve.current=!0:b.push(Bt)}}if(b.sort(function(ce,ar){return ce.distanceTo(g)-ar.distanceTo(g)}),b.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var en=document.createDocumentFragment();for(nt=0;nt<b.length;nt++)this._addTile(b[nt],en);this._level.el.appendChild(en)}}}},_isValidTile:function(t){var r=this._map.options.crs;if(!r.infinite){var a=this._globalTileRange;if(!r.wrapLng&&(t.x<a.min.x||t.x>a.max.x)||!r.wrapLat&&(t.y<a.min.y||t.y>a.max.y))return!1}if(!this.options.bounds)return!0;var c=this._tileCoordsToBounds(t);return ct(this.options.bounds).overlaps(c)},_keyToBounds:function(t){return this._tileCoordsToBounds(this._keyToTileCoords(t))},_tileCoordsToNwSe:function(t){var r=this._map,a=this.getTileSize(),c=t.scaleBy(a),f=c.add(a),g=r.unproject(c,t.z),b=r.unproject(f,t.z);return[g,b]},_tileCoordsToBounds:function(t){var r=this._tileCoordsToNwSe(t),a=new ft(r[0],r[1]);return this.options.noWrap||(a=this._map.wrapLatLngBounds(a)),a},_tileCoordsToKey:function(t){return t.x+":"+t.y+":"+t.z},_keyToTileCoords:function(t){var r=t.split(":"),a=new Z(+r[0],+r[1]);return a.z=+r[2],a},_removeTile:function(t){var r=this._tiles[t];r&&(_t(r.el),delete this._tiles[t],this.fire("tileunload",{tile:r.el,coords:this._keyToTileCoords(t)}))},_initTile:function(t){it(t,"leaflet-tile");var r=this.getTileSize();t.style.width=r.x+"px",t.style.height=r.y+"px",t.onselectstart=m,t.onmousemove=m,X.ielt9&&this.options.opacity<1&&Ot(t,this.options.opacity)},_addTile:function(t,r){var a=this._getTilePos(t),c=this._tileCoordsToKey(t),f=this.createTile(this._wrapCoords(t),h(this._tileReady,this,t));this._initTile(f),this.createTile.length<2&&V(h(this._tileReady,this,t,null,f)),mt(f,a),this._tiles[c]={el:f,coords:t,current:!0},r.appendChild(f),this.fire("tileloadstart",{tile:f,coords:t})},_tileReady:function(t,r,a){r&&this.fire("tileerror",{error:r,tile:a,coords:t});var c=this._tileCoordsToKey(t);a=this._tiles[c],a&&(a.loaded=+new Date,this._map._fadeAnimated?(Ot(a.el,0),G(this._fadeFrame),this._fadeFrame=V(this._updateOpacity,this)):(a.active=!0,this._pruneTiles()),r||(it(a.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:a.el,coords:t})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),X.ielt9||!this._map._fadeAnimated?V(this._pruneTiles,this):setTimeout(h(this._pruneTiles,this),250)))},_getTilePos:function(t){return t.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(t){var r=new Z(this._wrapX?p(t.x,this._wrapX):t.x,this._wrapY?p(t.y,this._wrapY):t.y);return r.z=t.z,r},_pxBoundsToTileRange:function(t){var r=this.getTileSize();return new et(t.min.unscaleBy(r).floor(),t.max.unscaleBy(r).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var t in this._tiles)if(!this._tiles[t].loaded)return!1;return!0}});function Oh(t){return new _i(t)}var Ae=_i.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(t,r){this._url=t,r=T(this,r),r.detectRetina&&X.retina&&r.maxZoom>0?(r.tileSize=Math.floor(r.tileSize/2),r.zoomReverse?(r.zoomOffset--,r.minZoom=Math.min(r.maxZoom,r.minZoom+1)):(r.zoomOffset++,r.maxZoom=Math.max(r.minZoom,r.maxZoom-1)),r.minZoom=Math.max(0,r.minZoom)):r.zoomReverse?r.minZoom=Math.min(r.maxZoom,r.minZoom):r.maxZoom=Math.max(r.minZoom,r.maxZoom),typeof r.subdomains=="string"&&(r.subdomains=r.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(t,r){return this._url===t&&r===void 0&&(r=!0),this._url=t,r||this.redraw(),this},createTile:function(t,r){var a=document.createElement("img");return tt(a,"load",h(this._tileOnLoad,this,r,a)),tt(a,"error",h(this._tileOnError,this,r,a)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(a.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(a.referrerPolicy=this.options.referrerPolicy),a.alt="",a.src=this.getTileUrl(t),a},getTileUrl:function(t){var r={r:X.retina?"@2x":"",s:this._getSubdomain(t),x:t.x,y:t.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var a=this._globalTileRange.max.y-t.y;this.options.tms&&(r.y=a),r["-y"]=a}return w(this._url,s(r,this.options))},_tileOnLoad:function(t,r){X.ielt9?setTimeout(h(t,this,null,r),0):t(null,r)},_tileOnError:function(t,r,a){var c=this.options.errorTileUrl;c&&r.getAttribute("src")!==c&&(r.src=c),t(a,r)},_onTileRemove:function(t){t.tile.onload=null},_getZoomForUrl:function(){var t=this._tileZoom,r=this.options.maxZoom,a=this.options.zoomReverse,c=this.options.zoomOffset;return a&&(t=r-t),t+c},_getSubdomain:function(t){var r=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[r]},_abortLoading:function(){var t,r;for(t in this._tiles)if(this._tiles[t].coords.z!==this._tileZoom&&(r=this._tiles[t].el,r.onload=m,r.onerror=m,!r.complete)){r.src=F;var a=this._tiles[t].coords;_t(r),delete this._tiles[t],this.fire("tileabort",{tile:r,coords:a})}},_removeTile:function(t){var r=this._tiles[t];if(r)return r.el.setAttribute("src",F),_i.prototype._removeTile.call(this,t)},_tileReady:function(t,r,a){if(!(!this._map||a&&a.getAttribute("src")===F))return _i.prototype._tileReady.call(this,t,r,a)}});function Uo(t,r){return new Ae(t,r)}var Vo=Ae.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(t,r){this._url=t;var a=s({},this.defaultWmsParams);for(var c in r)c in this.options||(a[c]=r[c]);r=T(this,r);var f=r.detectRetina&&X.retina?2:1,g=this.getTileSize();a.width=g.x*f,a.height=g.y*f,this.wmsParams=a},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var r=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[r]=this._crs.code,Ae.prototype.onAdd.call(this,t)},getTileUrl:function(t){var r=this._tileCoordsToNwSe(t),a=this._crs,c=Q(a.project(r[0]),a.project(r[1])),f=c.min,g=c.max,b=(this._wmsVersion>=1.3&&this._crs===Bo?[f.y,f.x,g.y,g.x]:[f.x,f.y,g.x,g.y]).join(","),E=Ae.prototype.getTileUrl.call(this,t);return E+O(this.wmsParams,E,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+b},setParams:function(t,r){return s(this.wmsParams,t),r||this.redraw(),this}});function Ah(t,r){return new Vo(t,r)}Ae.WMS=Vo,Uo.wms=Ah;var ne=Ut.extend({options:{padding:.1},initialize:function(t){T(this,t),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),this._zoomAnimated&&it(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var t={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(t.zoomanim=this._onAnimZoom),t},_onAnimZoom:function(t){this._updateTransform(t.center,t.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(t,r){var a=this._map.getZoomScale(r,this._zoom),c=this._map.getSize().multiplyBy(.5+this.options.padding),f=this._map.project(this._center,r),g=c.multiplyBy(-a).add(f).subtract(this._map._getNewPixelOrigin(t,r));X.any3d?pe(this._container,g,a):mt(this._container,g)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var t in this._layers)this._layers[t]._reset()},_onZoomEnd:function(){for(var t in this._layers)this._layers[t]._project()},_updatePaths:function(){for(var t in this._layers)this._layers[t]._update()},_update:function(){var t=this.options.padding,r=this._map.getSize(),a=this._map.containerPointToLayerPoint(r.multiplyBy(-t)).round();this._bounds=new et(a,a.add(r.multiplyBy(1+t*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Ho=ne.extend({options:{tolerance:0},getEvents:function(){var t=ne.prototype.getEvents.call(this);return t.viewprereset=this._onViewPreReset,t},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ne.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var t=this._container=document.createElement("canvas");tt(t,"mousemove",this._onMouseMove,this),tt(t,"click dblclick mousedown mouseup contextmenu",this._onClick,this),tt(t,"mouseout",this._handleMouseOut,this),t._leaflet_disable_events=!0,this._ctx=t.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,_t(this._container),ut(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var t;this._redrawBounds=null;for(var r in this._layers)t=this._layers[r],t._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ne.prototype._update.call(this);var t=this._bounds,r=this._container,a=t.getSize(),c=X.retina?2:1;mt(r,t.min),r.width=c*a.x,r.height=c*a.y,r.style.width=a.x+"px",r.style.height=a.y+"px",X.retina&&this._ctx.scale(2,2),this._ctx.translate(-t.min.x,-t.min.y),this.fire("update")}},_reset:function(){ne.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(t){this._updateDashArray(t),this._layers[d(t)]=t;var r=t._order={layer:t,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=r),this._drawLast=r,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(t){this._requestRedraw(t)},_removePath:function(t){var r=t._order,a=r.next,c=r.prev;a?a.prev=c:this._drawLast=c,c?c.next=a:this._drawFirst=a,delete t._order,delete this._layers[d(t)],this._requestRedraw(t)},_updatePath:function(t){this._extendRedrawBounds(t),t._project(),t._update(),this._requestRedraw(t)},_updateStyle:function(t){this._updateDashArray(t),this._requestRedraw(t)},_updateDashArray:function(t){if(typeof t.options.dashArray=="string"){var r=t.options.dashArray.split(/[, ]+/),a=[],c,f;for(f=0;f<r.length;f++){if(c=Number(r[f]),isNaN(c))return;a.push(c)}t.options._dashArray=a}else t.options._dashArray=t.options.dashArray},_requestRedraw:function(t){this._map&&(this._extendRedrawBounds(t),this._redrawRequest=this._redrawRequest||V(this._redraw,this))},_extendRedrawBounds:function(t){if(t._pxBounds){var r=(t.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new et,this._redrawBounds.extend(t._pxBounds.min.subtract([r,r])),this._redrawBounds.extend(t._pxBounds.max.add([r,r]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var t=this._redrawBounds;if(t){var r=t.getSize();this._ctx.clearRect(t.min.x,t.min.y,r.x,r.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var t,r=this._redrawBounds;if(this._ctx.save(),r){var a=r.getSize();this._ctx.beginPath(),this._ctx.rect(r.min.x,r.min.y,a.x,a.y),this._ctx.clip()}this._drawing=!0;for(var c=this._drawFirst;c;c=c.next)t=c.layer,(!r||t._pxBounds&&t._pxBounds.intersects(r))&&t._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(t,r){if(this._drawing){var a,c,f,g,b=t._parts,E=b.length,D=this._ctx;if(E){for(D.beginPath(),a=0;a<E;a++){for(c=0,f=b[a].length;c<f;c++)g=b[a][c],D[c?"lineTo":"moveTo"](g.x,g.y);r&&D.closePath()}this._fillStroke(D,t)}}},_updateCircle:function(t){if(!(!this._drawing||t._empty())){var r=t._point,a=this._ctx,c=Math.max(Math.round(t._radius),1),f=(Math.max(Math.round(t._radiusY),1)||c)/c;f!==1&&(a.save(),a.scale(1,f)),a.beginPath(),a.arc(r.x,r.y/f,c,0,Math.PI*2,!1),f!==1&&a.restore(),this._fillStroke(a,t)}},_fillStroke:function(t,r){var a=r.options;a.fill&&(t.globalAlpha=a.fillOpacity,t.fillStyle=a.fillColor||a.color,t.fill(a.fillRule||"evenodd")),a.stroke&&a.weight!==0&&(t.setLineDash&&t.setLineDash(r.options&&r.options._dashArray||[]),t.globalAlpha=a.opacity,t.lineWidth=a.weight,t.strokeStyle=a.color,t.lineCap=a.lineCap,t.lineJoin=a.lineJoin,t.stroke())},_onClick:function(t){for(var r=this._map.mouseEventToLayerPoint(t),a,c,f=this._drawFirst;f;f=f.next)a=f.layer,a.options.interactive&&a._containsPoint(r)&&(!(t.type==="click"||t.type==="preclick")||!this._map._draggableMoved(a))&&(c=a);this._fireEvent(c?[c]:!1,t)},_onMouseMove:function(t){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var r=this._map.mouseEventToLayerPoint(t);this._handleMouseHover(t,r)}},_handleMouseOut:function(t){var r=this._hoveredLayer;r&&(gt(this._container,"leaflet-interactive"),this._fireEvent([r],t,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(t,r){if(!this._mouseHoverThrottled){for(var a,c,f=this._drawFirst;f;f=f.next)a=f.layer,a.options.interactive&&a._containsPoint(r)&&(c=a);c!==this._hoveredLayer&&(this._handleMouseOut(t),c&&(it(this._container,"leaflet-interactive"),this._fireEvent([c],t,"mouseover"),this._hoveredLayer=c)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,t),this._mouseHoverThrottled=!0,setTimeout(h(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(t,r,a){this._map._fireDOMEvent(r,a||r.type,t)},_bringToFront:function(t){var r=t._order;if(r){var a=r.next,c=r.prev;if(a)a.prev=c;else return;c?c.next=a:a&&(this._drawFirst=a),r.prev=this._drawLast,this._drawLast.next=r,r.next=null,this._drawLast=r,this._requestRedraw(t)}},_bringToBack:function(t){var r=t._order;if(r){var a=r.next,c=r.prev;if(c)c.next=a;else return;a?a.prev=c:c&&(this._drawLast=c),r.prev=null,r.next=this._drawFirst,this._drawFirst.prev=r,this._drawFirst=r,this._requestRedraw(t)}}});function Yo(t){return X.canvas?new Ho(t):null}var gi=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return document.createElement("<lvml:"+t+' class="lvml">')}}catch{}return function(t){return document.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Bh={_initContainer:function(){this._container=ot("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ne.prototype._update.call(this),this.fire("update"))},_initPath:function(t){var r=t._container=gi("shape");it(r,"leaflet-vml-shape "+(this.options.className||"")),r.coordsize="1 1",t._path=gi("path"),r.appendChild(t._path),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){var r=t._container;this._container.appendChild(r),t.options.interactive&&t.addInteractiveTarget(r)},_removePath:function(t){var r=t._container;_t(r),t.removeInteractiveTarget(r),delete this._layers[d(t)]},_updateStyle:function(t){var r=t._stroke,a=t._fill,c=t.options,f=t._container;f.stroked=!!c.stroke,f.filled=!!c.fill,c.stroke?(r||(r=t._stroke=gi("stroke")),f.appendChild(r),r.weight=c.weight+"px",r.color=c.color,r.opacity=c.opacity,c.dashArray?r.dashStyle=M(c.dashArray)?c.dashArray.join(" "):c.dashArray.replace(/( *, *)/g," "):r.dashStyle="",r.endcap=c.lineCap.replace("butt","flat"),r.joinstyle=c.lineJoin):r&&(f.removeChild(r),t._stroke=null),c.fill?(a||(a=t._fill=gi("fill")),f.appendChild(a),a.color=c.fillColor||c.color,a.opacity=c.fillOpacity):a&&(f.removeChild(a),t._fill=null)},_updateCircle:function(t){var r=t._point.round(),a=Math.round(t._radius),c=Math.round(t._radiusY||a);this._setPath(t,t._empty()?"M0 0":"AL "+r.x+","+r.y+" "+a+","+c+" 0,"+65535*360)},_setPath:function(t,r){t._path.v=r},_bringToFront:function(t){Ee(t._container)},_bringToBack:function(t){Te(t._container)}},tn=X.vml?gi:qr,mi=ne.extend({_initContainer:function(){this._container=tn("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=tn("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){_t(this._container),ut(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ne.prototype._update.call(this);var t=this._bounds,r=t.getSize(),a=this._container;(!this._svgSize||!this._svgSize.equals(r))&&(this._svgSize=r,a.setAttribute("width",r.x),a.setAttribute("height",r.y)),mt(a,t.min),a.setAttribute("viewBox",[t.min.x,t.min.y,r.x,r.y].join(" ")),this.fire("update")}},_initPath:function(t){var r=t._path=tn("path");t.options.className&&it(r,t.options.className),t.options.interactive&&it(r,"leaflet-interactive"),this._updateStyle(t),this._layers[d(t)]=t},_addPath:function(t){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(t._path),t.addInteractiveTarget(t._path)},_removePath:function(t){_t(t._path),t.removeInteractiveTarget(t._path),delete this._layers[d(t)]},_updatePath:function(t){t._project(),t._update()},_updateStyle:function(t){var r=t._path,a=t.options;r&&(a.stroke?(r.setAttribute("stroke",a.color),r.setAttribute("stroke-opacity",a.opacity),r.setAttribute("stroke-width",a.weight),r.setAttribute("stroke-linecap",a.lineCap),r.setAttribute("stroke-linejoin",a.lineJoin),a.dashArray?r.setAttribute("stroke-dasharray",a.dashArray):r.removeAttribute("stroke-dasharray"),a.dashOffset?r.setAttribute("stroke-dashoffset",a.dashOffset):r.removeAttribute("stroke-dashoffset")):r.setAttribute("stroke","none"),a.fill?(r.setAttribute("fill",a.fillColor||a.color),r.setAttribute("fill-opacity",a.fillOpacity),r.setAttribute("fill-rule",a.fillRule||"evenodd")):r.setAttribute("fill","none"))},_updatePoly:function(t,r){this._setPath(t,Kr(t._parts,r))},_updateCircle:function(t){var r=t._point,a=Math.max(Math.round(t._radius),1),c=Math.max(Math.round(t._radiusY),1)||a,f="a"+a+","+c+" 0 1,0 ",g=t._empty()?"M0 0":"M"+(r.x-a)+","+r.y+f+a*2+",0 "+f+-a*2+",0 ";this._setPath(t,g)},_setPath:function(t,r){t._path.setAttribute("d",r)},_bringToFront:function(t){Ee(t._path)},_bringToBack:function(t){Te(t._path)}});X.vml&&mi.include(Bh);function Xo(t){return X.svg||X.vml?new mi(t):null}rt.include({getRenderer:function(t){var r=t.options.renderer||this._getPaneRenderer(t.options.pane)||this.options.renderer||this._renderer;return r||(r=this._renderer=this._createRenderer()),this.hasLayer(r)||this.addLayer(r),r},_getPaneRenderer:function(t){if(t==="overlayPane"||t===void 0)return!1;var r=this._paneRenderers[t];return r===void 0&&(r=this._createRenderer({pane:t}),this._paneRenderers[t]=r),r},_createRenderer:function(t){return this.options.preferCanvas&&Yo(t)||Xo(t)}});var Go=De.extend({initialize:function(t,r){De.prototype.initialize.call(this,this._boundsToLatLngs(t),r)},setBounds:function(t){return this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=ct(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}});function Fh(t,r){return new Go(t,r)}mi.create=tn,mi.pointsToPath=Kr,ie.geometryToLayer=Xi,ie.coordsToLatLng=rr,ie.coordsToLatLngs=Gi,ie.latLngToCoords=or,ie.latLngsToCoords=qi,ie.getFeature=Oe,ie.asFeature=Ki,rt.mergeOptions({boxZoom:!0});var qo=Jt.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._resetStateTimeout=0,t.on("unload",this._destroy,this)},addHooks:function(){tt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){ut(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){_t(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(t){if(!t.shiftKey||t.which!==1&&t.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),li(),Wn(),this._startPoint=this._map.mouseEventToContainerPoint(t),tt(document,{contextmenu:me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(t){this._moved||(this._moved=!0,this._box=ot("div","leaflet-zoom-box",this._container),it(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(t);var r=new et(this._point,this._startPoint),a=r.getSize();mt(this._box,r.min),this._box.style.width=a.x+"px",this._box.style.height=a.y+"px"},_finish:function(){this._moved&&(_t(this._box),gt(this._container,"leaflet-crosshair")),hi(),Un(),ut(document,{contextmenu:me,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(t){if(!(t.which!==1&&t.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(h(this._resetState,this),0);var r=new ft(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(r).fire("boxzoomend",{boxZoomBounds:r})}},_onKeyDown:function(t){t.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});rt.addInitHook("addHandler","boxZoom",qo),rt.mergeOptions({doubleClickZoom:!0});var Ko=Jt.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var r=this._map,a=r.getZoom(),c=r.options.zoomDelta,f=t.originalEvent.shiftKey?a-c:a+c;r.options.doubleClickZoom==="center"?r.setZoom(f):r.setZoomAround(t.containerPoint,f)}});rt.addInitHook("addHandler","doubleClickZoom",Ko),rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var $o=Jt.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new le(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),t.on("zoomend",this._onZoomEnd,this),t.whenReady(this._onZoomEnd,this))}it(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){gt(this._map._container,"leaflet-grab"),gt(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var t=this._map;if(t._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var r=ct(this._map.options.maxBounds);this._offsetLimit=Q(this._map.latLngToContainerPoint(r.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(r.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(t){if(this._map.options.inertia){var r=this._lastTime=+new Date,a=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(a),this._times.push(r),this._prunePositions(r)}this._map.fire("move",t).fire("drag",t)},_prunePositions:function(t){for(;this._positions.length>1&&t-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var t=this._map.getSize().divideBy(2),r=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=r.subtract(t).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(t,r){return t-(t-r)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var t=this._draggable._newPos.subtract(this._draggable._startPos),r=this._offsetLimit;t.x<r.min.x&&(t.x=this._viscousLimit(t.x,r.min.x)),t.y<r.min.y&&(t.y=this._viscousLimit(t.y,r.min.y)),t.x>r.max.x&&(t.x=this._viscousLimit(t.x,r.max.x)),t.y>r.max.y&&(t.y=this._viscousLimit(t.y,r.max.y)),this._draggable._newPos=this._draggable._startPos.add(t)}},_onPreDragWrap:function(){var t=this._worldWidth,r=Math.round(t/2),a=this._initialWorldOffset,c=this._draggable._newPos.x,f=(c-r+a)%t+r-a,g=(c+r+a)%t-r-a,b=Math.abs(f+a)<Math.abs(g+a)?f:g;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=b},_onDragEnd:function(t){var r=this._map,a=r.options,c=!a.inertia||t.noInertia||this._times.length<2;if(r.fire("dragend",t),c)r.fire("moveend");else{this._prunePositions(+new Date);var f=this._lastPos.subtract(this._positions[0]),g=(this._lastTime-this._times[0])/1e3,b=a.easeLinearity,E=f.multiplyBy(b/g),D=E.distanceTo([0,0]),R=Math.min(a.inertiaMaxSpeed,D),U=E.multiplyBy(R/D),$=R/(a.inertiaDeceleration*b),nt=U.multiplyBy(-$/2).round();!nt.x&&!nt.y?r.fire("moveend"):(nt=r._limitOffset(nt,r.options.maxBounds),V(function(){r.panBy(nt,{duration:$,easeLinearity:b,noMoveStart:!0,animate:!0})}))}}});rt.addInitHook("addHandler","dragging",$o),rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Jo=Jt.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(t){this._map=t,this._setPanDelta(t.options.keyboardPanDelta),this._setZoomDelta(t.options.zoomDelta)},addHooks:function(){var t=this._map._container;t.tabIndex<=0&&(t.tabIndex="0"),tt(t,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),ut(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var t=document.body,r=document.documentElement,a=t.scrollTop||r.scrollTop,c=t.scrollLeft||r.scrollLeft;this._map._container.focus(),window.scrollTo(c,a)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(t){var r=this._panKeys={},a=this.keyCodes,c,f;for(c=0,f=a.left.length;c<f;c++)r[a.left[c]]=[-1*t,0];for(c=0,f=a.right.length;c<f;c++)r[a.right[c]]=[t,0];for(c=0,f=a.down.length;c<f;c++)r[a.down[c]]=[0,t];for(c=0,f=a.up.length;c<f;c++)r[a.up[c]]=[0,-1*t]},_setZoomDelta:function(t){var r=this._zoomKeys={},a=this.keyCodes,c,f;for(c=0,f=a.zoomIn.length;c<f;c++)r[a.zoomIn[c]]=t;for(c=0,f=a.zoomOut.length;c<f;c++)r[a.zoomOut[c]]=-t},_addHooks:function(){tt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){ut(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){if(!(t.altKey||t.ctrlKey||t.metaKey)){var r=t.keyCode,a=this._map,c;if(r in this._panKeys){if(!a._panAnim||!a._panAnim._inProgress)if(c=this._panKeys[r],t.shiftKey&&(c=N(c).multiplyBy(3)),a.options.maxBounds&&(c=a._limitOffset(N(c),a.options.maxBounds)),a.options.worldCopyJump){var f=a.wrapLatLng(a.unproject(a.project(a.getCenter()).add(c)));a.panTo(f)}else a.panBy(c)}else if(r in this._zoomKeys)a.setZoom(a.getZoom()+(t.shiftKey?3:1)*this._zoomKeys[r]);else if(r===27&&a._popup&&a._popup.options.closeOnEscapeKey)a.closePopup();else return;me(t)}}});rt.addInitHook("addHandler","keyboard",Jo),rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Qo=Jt.extend({addHooks:function(){tt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){ut(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(t){var r=Po(t),a=this._map.options.wheelDebounceTime;this._delta+=r,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var c=Math.max(a-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(h(this._performZoom,this),c),me(t)},_performZoom:function(){var t=this._map,r=t.getZoom(),a=this._map.options.zoomSnap||0;t._stop();var c=this._delta/(this._map.options.wheelPxPerZoomLevel*4),f=4*Math.log(2/(1+Math.exp(-Math.abs(c))))/Math.LN2,g=a?Math.ceil(f/a)*a:f,b=t._limitZoom(r+(this._delta>0?g:-g))-r;this._delta=0,this._startTime=null,b&&(t.options.scrollWheelZoom==="center"?t.setZoom(r+b):t.setZoomAround(this._lastMousePos,r+b))}});rt.addInitHook("addHandler","scrollWheelZoom",Qo);var Rh=600;rt.mergeOptions({tapHold:X.touchNative&&X.safari&&X.mobile,tapTolerance:15});var ts=Jt.extend({addHooks:function(){tt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){ut(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(clearTimeout(this._holdTimeout),t.touches.length===1){var r=t.touches[0];this._startPos=this._newPos=new Z(r.clientX,r.clientY),this._holdTimeout=setTimeout(h(function(){this._cancel(),this._isTapValid()&&(tt(document,"touchend",Ct),tt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",r))},this),Rh),tt(document,"touchend touchcancel contextmenu",this._cancel,this),tt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function t(){ut(document,"touchend",Ct),ut(document,"touchend touchcancel",t)},_cancel:function(){clearTimeout(this._holdTimeout),ut(document,"touchend touchcancel contextmenu",this._cancel,this),ut(document,"touchmove",this._onMove,this)},_onMove:function(t){var r=t.touches[0];this._newPos=new Z(r.clientX,r.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(t,r){var a=new MouseEvent(t,{bubbles:!0,cancelable:!0,view:window,screenX:r.screenX,screenY:r.screenY,clientX:r.clientX,clientY:r.clientY});a._simulated=!0,r.target.dispatchEvent(a)}});rt.addInitHook("addHandler","tapHold",ts),rt.mergeOptions({touchZoom:X.touch,bounceAtZoomLimits:!0});var es=Jt.extend({addHooks:function(){it(this._map._container,"leaflet-touch-zoom"),tt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){gt(this._map._container,"leaflet-touch-zoom"),ut(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var r=this._map;if(!(!t.touches||t.touches.length!==2||r._animatingZoom||this._zooming)){var a=r.mouseEventToContainerPoint(t.touches[0]),c=r.mouseEventToContainerPoint(t.touches[1]);this._centerPoint=r.getSize()._divideBy(2),this._startLatLng=r.containerPointToLatLng(this._centerPoint),r.options.touchZoom!=="center"&&(this._pinchStartLatLng=r.containerPointToLatLng(a.add(c)._divideBy(2))),this._startDist=a.distanceTo(c),this._startZoom=r.getZoom(),this._moved=!1,this._zooming=!0,r._stop(),tt(document,"touchmove",this._onTouchMove,this),tt(document,"touchend touchcancel",this._onTouchEnd,this),Ct(t)}},_onTouchMove:function(t){if(!(!t.touches||t.touches.length!==2||!this._zooming)){var r=this._map,a=r.mouseEventToContainerPoint(t.touches[0]),c=r.mouseEventToContainerPoint(t.touches[1]),f=a.distanceTo(c)/this._startDist;if(this._zoom=r.getScaleZoom(f,this._startZoom),!r.options.bounceAtZoomLimits&&(this._zoom<r.getMinZoom()&&f<1||this._zoom>r.getMaxZoom()&&f>1)&&(this._zoom=r._limitZoom(this._zoom)),r.options.touchZoom==="center"){if(this._center=this._startLatLng,f===1)return}else{var g=a._add(c)._divideBy(2)._subtract(this._centerPoint);if(f===1&&g.x===0&&g.y===0)return;this._center=r.unproject(r.project(this._pinchStartLatLng,this._zoom).subtract(g),this._zoom)}this._moved||(r._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var b=h(r._move,r,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=V(b,this,!0),Ct(t)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),ut(document,"touchmove",this._onTouchMove,this),ut(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});rt.addInitHook("addHandler","touchZoom",es),rt.BoxZoom=qo,rt.DoubleClickZoom=Ko,rt.Drag=$o,rt.Keyboard=Jo,rt.ScrollWheelZoom=Qo,rt.TapHold=ts,rt.TouchZoom=es,i.Bounds=et,i.Browser=X,i.CRS=Dt,i.Canvas=Ho,i.Circle=nr,i.CircleMarker=Yi,i.Class=y,i.Control=Wt,i.DivIcon=Wo,i.DivOverlay=Qt,i.DomEvent=ih,i.DomUtil=th,i.Draggable=le,i.Evented=Y,i.FeatureGroup=te,i.GeoJSON=ie,i.GridLayer=_i,i.Handler=Jt,i.Icon=Ie,i.ImageOverlay=$i,i.LatLng=st,i.LatLngBounds=ft,i.Layer=Ut,i.LayerGroup=ze,i.LineUtil=ph,i.Map=rt,i.Marker=Hi,i.Mixin=hh,i.Path=he,i.Point=Z,i.PolyUtil=_h,i.Polygon=De,i.Polyline=ee,i.Popup=Ji,i.PosAnimation=Co,i.Projection=gh,i.Rectangle=Go,i.Renderer=ne,i.SVG=mi,i.SVGOverlay=No,i.TileLayer=Ae,i.Tooltip=Qi,i.Transformation=Tn,i.Util=q,i.VideoOverlay=jo,i.bind=h,i.bounds=Q,i.canvas=Yo,i.circle=Ch,i.circleMarker=Ph,i.control=di,i.divIcon=Dh,i.extend=s,i.featureGroup=wh,i.geoJSON=Zo,i.geoJson=Lh,i.gridLayer=Oh,i.icon=xh,i.imageOverlay=Sh,i.latLng=lt,i.latLngBounds=ct,i.layerGroup=vh,i.map=nh,i.marker=bh,i.point=N,i.polygon=kh,i.polyline=Mh,i.popup=zh,i.rectangle=Fh,i.setOptions=T,i.stamp=d,i.svg=Xo,i.svgOverlay=Th,i.tileLayer=Uo,i.tooltip=Ih,i.transformation=ri,i.version=o,i.videoOverlay=Eh;var Zh=window.L;i.noConflict=function(){return window.L=Zh,this},window.L=i})})(Tr,Tr.exports);var wl=Tr.exports;const Bf=wc(wl),ia=Gh({__proto__:null,default:Bf},[wl]),Ff="_current_f197c_1",Rf="_all_f197c_2",Zf="_header_f197c_11",jf="_type_f197c_18",Nf="_container_f197c_28",Wf="_row_f197c_34",ht={current:Ff,all:Rf,header:Zf,type:jf,container:Nf,row:Wf},na=n=>new Date(n).toTimeString().split(" ")[0],ra=()=>new Date().toISOString().replace(/:/g,"-").replace("Z","").replace("T","_").replace(".","_");var Lt=63710088e-1,Uf={centimeters:Lt*100,centimetres:Lt*100,degrees:Lt/111325,feet:Lt*3.28084,inches:Lt*39.37,kilometers:Lt/1e3,kilometres:Lt/1e3,meters:Lt,metres:Lt,miles:Lt/1609.344,millimeters:Lt*1e3,millimetres:Lt*1e3,nauticalmiles:Lt/1852,radians:1,yards:Lt*1.0936};function zr(n,e,i){i===void 0&&(i={});var o={type:"Feature"};return(i.id===0||i.id)&&(o.id=i.id),i.bbox&&(o.bbox=i.bbox),o.properties=e||{},o.geometry=n,o}function Vf(n,e,i){if(i===void 0&&(i={}),n.length<2)throw new Error("coordinates must be an array of two or more positions");var o={type:"LineString",coordinates:n};return zr(o,e,i)}function Hf(n,e){e===void 0&&(e="kilometers");var i=Uf[e];if(!i)throw new Error(e+" units is invalid");return n*i}function cn(n){var e=n%360;return e*Math.PI/180}function xl(n,e,i){if(n!==null)for(var o,s,l,h,u,d,_,p=0,m=0,v,x=n.type,P=x==="FeatureCollection",T=x==="Feature",O=P?n.features.length:1,A=0;A<O;A++){_=P?n.features[A].geometry:T?n.geometry:n,v=_?_.type==="GeometryCollection":!1,u=v?_.geometries.length:1;for(var w=0;w<u;w++){var M=0,k=0;if(h=v?_.geometries[w]:_,h!==null){d=h.coordinates;var F=h.type;switch(p=0,F){case null:break;case"Point":if(e(d,m,A,M,k)===!1)return!1;m++,M++;break;case"LineString":case"MultiPoint":for(o=0;o<d.length;o++){if(e(d[o],m,A,M,k)===!1)return!1;m++,F==="MultiPoint"&&M++}F==="LineString"&&M++;break;case"Polygon":case"MultiLineString":for(o=0;o<d.length;o++){for(s=0;s<d[o].length-p;s++){if(e(d[o][s],m,A,M,k)===!1)return!1;m++}F==="MultiLineString"&&M++,F==="Polygon"&&k++}F==="Polygon"&&M++;break;case"MultiPolygon":for(o=0;o<d.length;o++){for(k=0,s=0;s<d[o].length;s++){for(l=0;l<d[o][s].length-p;l++){if(e(d[o][s][l],m,A,M,k)===!1)return!1;m++}k++}M++}break;case"GeometryCollection":for(o=0;o<h.geometries.length;o++)if(xl(h.geometries[o],e)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function bl(n,e){var i,o,s,l,h,u,d,_,p,m,v=0,x=n.type==="FeatureCollection",P=n.type==="Feature",T=x?n.features.length:1;for(i=0;i<T;i++){for(u=x?n.features[i].geometry:P?n.geometry:n,_=x?n.features[i].properties:P?n.properties:{},p=x?n.features[i].bbox:P?n.bbox:void 0,m=x?n.features[i].id:P?n.id:void 0,d=u?u.type==="GeometryCollection":!1,h=d?u.geometries.length:1,s=0;s<h;s++){if(l=d?u.geometries[s]:u,l===null){if(e(null,v,_,p,m)===!1)return!1;continue}switch(l.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(e(l,v,_,p,m)===!1)return!1;break}case"GeometryCollection":{for(o=0;o<l.geometries.length;o++)if(e(l.geometries[o],v,_,p,m)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}v++}}function Yf(n,e,i){var o=i;return bl(n,function(s,l,h,u,d){l===0&&i===void 0?o=s:o=e(o,s,l,h,u,d)}),o}function Xf(n,e){bl(n,function(i,o,s,l,h){var u=i===null?null:i.type;switch(u){case null:case"Point":case"LineString":case"Polygon":return e(zr(i,s,{bbox:l,id:h}),o,0)===!1?!1:void 0}var d;switch(u){case"MultiPoint":d="Point";break;case"MultiLineString":d="LineString";break;case"MultiPolygon":d="Polygon";break}for(var _=0;_<i.coordinates.length;_++){var p=i.coordinates[_],m={type:d,coordinates:p};if(e(zr(m,s),o,_)===!1)return!1}})}function Gf(n,e){Xf(n,function(i,o,s){var l=0;if(i.geometry){var h=i.geometry.type;if(!(h==="Point"||h==="MultiPoint")){var u,d=0,_=0,p=0;if(xl(i,function(m,v,x,P,T){if(u===void 0||o>d||P>_||T>p){u=m,d=o,_=P,p=T,l=0;return}var O=Vf([u,m],i.properties);if(e(O,o,s,T,l)===!1)return!1;l++,u=m})===!1)return!1}}})}function qf(n,e,i){var o=i,s=!1;return Gf(n,function(l,h,u,d,_){s===!1&&i===void 0?o=l:o=e(o,l,h,u,d,_),s=!0}),o}var oa=6378137;function Kf(n){return Yf(n,function(e,i){return e+$f(i)},0)}function $f(n){var e=0,i;switch(n.type){case"Polygon":return sa(n.coordinates);case"MultiPolygon":for(i=0;i<n.coordinates.length;i++)e+=sa(n.coordinates[i]);return e;case"Point":case"MultiPoint":case"LineString":case"MultiLineString":return 0}return 0}function sa(n){var e=0;if(n&&n.length>0){e+=Math.abs(aa(n[0]));for(var i=1;i<n.length;i++)e-=Math.abs(aa(n[i]))}return e}function aa(n){var e,i,o,s,l,h,u,d=0,_=n.length;if(_>2){for(u=0;u<_;u++)u===_-2?(s=_-2,l=_-1,h=0):u===_-1?(s=_-1,l=0,h=1):(s=u,l=u+1,h=u+2),e=n[s],i=n[l],o=n[h],d+=(wr(o[0])-wr(e[0]))*Math.sin(wr(i[1]));d=d*oa*oa/2}return d}function wr(n){return n*Math.PI/180}function la(n){if(!n)throw new Error("coord is required");if(!Array.isArray(n)){if(n.type==="Feature"&&n.geometry!==null&&n.geometry.type==="Point")return n.geometry.coordinates;if(n.type==="Point")return n.coordinates}if(Array.isArray(n)&&n.length>=2&&!Array.isArray(n[0])&&!Array.isArray(n[1]))return n;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Jf(n,e,i){i===void 0&&(i={});var o=la(n),s=la(e),l=cn(s[1]-o[1]),h=cn(s[0]-o[0]),u=cn(o[1]),d=cn(s[1]),_=Math.pow(Math.sin(l/2),2)+Math.pow(Math.sin(h/2),2)*Math.cos(u)*Math.cos(d);return Hf(2*Math.atan2(Math.sqrt(_),Math.sqrt(1-_)),i.units)}function Qf(n,e){return e===void 0&&(e={}),qf(n,function(i,o){var s=o.geometry.coordinates;return i+Jf(s[0],s[1],e)},0)}const tp=({selected:n,features:e})=>{const{points:i,lines:o,polygons:s}=Le(()=>{const l=[],h=[],u=[];return e.forEach(d=>{d.geometry.type==="Point"&&l.push(d),d.geometry.type==="LineString"&&h.push(d),d.geometry.type==="Polygon"&&u.push(d)}),{points:l,lines:h,polygons:u}},[e]);return W("div",{class:ht.container,children:[W("div",{class:ht.all,children:[W("h3",{class:ht.header,children:" All Features "}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Total"})," ",e.length]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Polygons:"}),s.length]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"LineStrings:"}),o.length]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Points:"}),i.length]})]}),W("div",{class:ht.current,children:[W("h3",{class:ht.header,children:" Selected Feature "}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"ID"}),n?n.id.slice(0,8)+"...":"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Geometry Type"}),n?n.geometry.type:"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Created"}),n&&n.properties.createdAt?na(n.properties.createdAt):"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Updated"}),n&&n.properties.updatedAt?na(n.properties.updatedAt):"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Coordinates"}),n&&n.geometry.type==="Polygon"?n.geometry.coordinates[0].length:n&&n.geometry.type==="LineString"?n.geometry.coordinates.length:"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Area (m2)"}),n&&n.geometry.type==="Polygon"?Kf(n).toFixed(2):"N/A"]}),W("span",{class:ht.row,children:[W("span",{class:ht.type,children:"Length (km)"}),n&&n.geometry.type==="LineString"?Qf(n).toFixed(2):"N/A"]})]})]})},ep="_geojson_xqn2o_1",ip="_container_xqn2o_8",np="_copy_xqn2o_15",rp="_download_xqn2o_25",op="_formatSelect_xqn2o_43",sp="_downloadContainer_xqn2o_47",We={geojson:ep,container:ip,copy:np,download:rp,formatSelect:op,downloadContainer:sp},ap="modulepreload",lp=function(n){return"/"+n},ha={},hp=function(e,i,o){let s=Promise.resolve();if(i&&i.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),h=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.all(i.map(u=>{if(u=lp(u),u in ha)return;ha[u]=!0;const d=u.endsWith(".css"),_=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${_}`))return;const p=document.createElement("link");if(p.rel=d?"stylesheet":ap,d||(p.as="script",p.crossOrigin=""),p.href=u,h&&p.setAttribute("nonce",h),document.head.appendChild(p),d)return new Promise((m,v)=>{p.addEventListener("load",m),p.addEventListener("error",()=>v(new Error(`Unable to preload CSS for ${u}`)))})}))}return s.then(()=>e()).catch(l=>{const h=new Event("vite:preloadError",{cancelable:!0});if(h.payload=l,window.dispatchEvent(h),!h.defaultPrevented)throw l})};function cp(){return Ke(async(e,i)=>{hp(async()=>{const{serialize:o}=await import("./geojson-DJEQmR7t.js");return{serialize:o}},[]).then(({serialize:o})=>{const s=o(e),l=new Blob([s],{type:"octet/stream"}),h=URL.createObjectURL(l),u=document.createElement("a");u.href=h,u.download=i,u.click(),URL.revokeObjectURL(h)})},[])}function up(){return Ke((e,i)=>{const o=JSON.stringify(e,null,4),s=new Blob([o],{type:"text/plain"}),l=URL.createObjectURL(s),h=document.createElement("a");h.href=l,h.download=i,h.click(),URL.revokeObjectURL(l)},[])}const dp=({features:n,format:e,setFormat:i})=>{const o=Le(()=>({type:"FeatureCollection",features:n}),[n]),s=Le(()=>JSON.stringify(o,null,4),[o]),l=up(),h=cp(),u=()=>e==="geojson"?l(o,`terradraw_${ra()}.geojson`):h(o,`terradraw_${ra()}.fgb`),d=()=>{navigator.clipboard&&navigator.clipboard.writeText(s)};return W("div",{class:We.container,children:[W("textarea",{class:We.geojson,readonly:!0,children:s}),navigator.clipboard?W("button",{class:We.copy,onClick:d,children:"Copy"}):null,W("div",{class:We.downloadContainer,children:[W("button",{class:We.download,onClick:u,children:"Download"}),W("select",{class:We.formatSelect,onChange:_=>{i(_.currentTarget.value)},children:[W("option",{value:"geojson",children:"GeoJSON"}),W("option",{value:"flatgeobuf",children:"FlatGeobuf"})]})]})]})},fp="_button_1trrs_1",pp="_active_1trrs_21",_p="_hiddenOnMobile_1trrs_26",gp="_expanded_1trrs_30",mp="_collapsed_1trrs_31",xr={button:fp,active:pp,hiddenOnMobile:_p,expanded:gp,collapsed:mp};function yp(n){return n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" ")}const be=({mode:n,currentMode:e,changeMode:i,label:o,hiddenOnTouch:s})=>{let l=xr.button;return s&&(l=`${xr.hiddenOnMobile} ${l}`),e===n&&(l=`${xr.active} ${l}`),W("button",{id:n,class:l,onClick:()=>{i(n)},children:o||yp(n)})},vp="_buttons_tlija_1",wp={buttons:vp},xp=({mode:n,changeMode:e})=>W("div",{class:wp.buttons,children:[W(be,{mode:"select",currentMode:n,changeMode:e}),W(be,{mode:"point",currentMode:n,changeMode:e}),W(be,{label:"Line",mode:"linestring",currentMode:n,changeMode:e}),W(be,{label:"Rectangle",mode:"rectangle",currentMode:n,changeMode:e,hiddenOnTouch:!0}),W(be,{mode:"polygon",currentMode:n,changeMode:e}),W(be,{mode:"freehand",currentMode:n,changeMode:e,hiddenOnTouch:!0}),W(be,{mode:"circle",currentMode:n,changeMode:e,hiddenOnTouch:!0})]}),bp="_button_1j3ml_1",Pp="_geolocation_1j3ml_25",ca={button:bp,geolocation:Pp},Cp="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TpSKVDnaQIpihOlkQFREnrUIRKoRaoVUHk+snNGlIUlwcBdeCgx+LVQcXZ10dXAVB8APE1cVJ0UVK/F9SaBHjwXE/3t173L0DhEaFqWbXGKBqlpFKxMVMdlUMvEJABCEMYUZmpj4nSUl4jq97+Ph6F+NZ3uf+HH25vMkAn0g8y3TDIt4gntq0dM77xGFWknPE58SjBl2Q+JHristvnIsOCzwzbKRT88RhYrHYwUoHs5KhEk8SR3OqRvlCxuUc5y3OaqXGWvfkLwzmtZVlrtMcRAKLWIIEEQpqKKMCCzFaNVJMpGg/7uGPOH6JXAq5ymDkWEAVKmTHD/4Hv7s1CxPjblIwDnS/2PbHMBDYBZp12/4+tu3mCeB/Bq60tr/aAKY/Sa+3tegRENoGLq7bmrIHXO4AA0+6bMiO5KcpFArA+xl9UxbovwV619zeWvs4fQDS1FXyBjg4BEaKlL3u8e6ezt7+PdPq7we7TnLE88ZFWQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cCGg8jCU7Y7fkAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAC+UlEQVRo3u2aS2gUQRCGv/jInmIQshiMrqAHPZoYEImC8UGEiJeYo0HBk7kpqBgkwYtgwAd684EPkHgIaDyIinoSs8IGvGi8RVYRl6BoIE90vVQ8NNUzszM9k7jsD3Wp7qrqf6d75q9mIT70AkXDeuMqtoQyQZxEqsqFSLFciJTF1qoF0oo/LWOLFlVAM9APvANmlDfWvM3InH6JqVosBDqBnMfC/SwHHFxIEk3AcAQCpg0DjUk/hRPArEMS8zYLHE9iuy0DbgRY0G9gWvFPy5hf/HWpFQuWAgM+CxgBjgEZD4mSkTkjPrkGpKZzXPEo+h5oM+b3BdBabcAHj7yXXZPo9Ch2FUhFEI0p4JpHfmdvtDQwrhT4A3Q7VL/dktOMGbd8XEvGLcsvdSoGGX/aUutmVBIbgDnLQfSDdkb6AsQ9UOLmgPVRiFxSkn4H6gLEZoAWwzIB4uqkhln3YlgSy4FCiC3lAtoWK8iaSkarkuwXsCIBIrXAhFJ/ZxgZ36r4ngiZuPFTapnYFYZIk+J7nqCmexZwTf8EoG1xW4Eaw5cDfihz7wF3Qy64Czik+FcCWwzfBJD16q2jWpRrnl4Xa6j07BUiMXZ7Byzn5gKwyfCfkwNv4qNYGGwUM9EMnDV8o8DJUjvIOyR4dxtQq90Os7XeKL79CRJpV3zDYZWv1l9vToBEo+UeILQCfqskfJgAkUdK3WyUhEcsneGeALEdwH3DOgLE7bV0ioejEEkBeSXpZ6A+hg6xHviixOUt9wKBvyMzQI/ibwCGFC0WBTXAY2C1MnZG1hL5W/PUonGywCoHT6Tech6LUtvZzWODpVssAl8tr8qgRNolh5b7m+UJRcIOYMpDgQ5JXx70gm67xNjyTcmcWLAPmPSR1KPAeWBQGRuUsVGfHJNSK1Zs89hmLqwgNRLBGuBVDCReSu7ElXMXMOaAwJjkWlBUA0flVVwqgazEVrv4VV1irUiMFmA3sM4Y/wS8AF7LpUf+f2jaKv9FqRCpEKkQcY+/z6ggfksbhSoAAAAASUVORK5CYII=",Mp=({setLocation:n})=>{let e=ca.button;return W("button",{id:"geolocation",class:e,title:"Geolocation",onClick:()=>{console.log("clicked",navigator.geolocation),navigator.geolocation.getCurrentPosition(i=>{n([i.coords.longitude,i.coords.latitude])},i=>{alert("Error getting geolocation"),console.error(i)})},children:W("img",{class:ca.geolocation,src:Cp})})},kp="_button_1bc05_1",Lp="_clear_1bc05_25",ua={button:kp,clear:Lp},Sp="/assets/clear-CiYKj2tk.png",Ep=({draw:n,clearLocalStorage:e})=>{let i=ua.button;return W("button",{id:"clear",class:i,title:"Clear",onClick:()=>{n.clear(),e()},children:W("img",{class:ua.clear,src:Sp})})};function Tp(){const n=Ke(()=>{localStorage&&localStorage.removeItem("terra-draw")},[]),e=Ke(o=>{localStorage&&localStorage.setItem("terra-draw",JSON.stringify(o))},[]),i=Ke(()=>localStorage?localStorage.getItem("terra-draw"):null,[]);return{clearLocalStorage:n,setLocalStorage:e,getLocalStorage:i}}function zp(n){return n.filter(e=>!e.properties.selectionPoint&&!e.properties.midPoint).map(e=>(e.properties.selected&&(e.properties.selected=!1),e))}const Ip=()=>{const n={L:ia,id:"leaflet-map",lng:0,lat:30,zoom:3},e=Xc(null),[i,o]=we(),[s,l]=we("static"),[h,u]=we(!0),[d,_]=we(),[p,m]=we([]),[v,x]=we(localStorage.getItem("tab")?localStorage.getItem("tab"):"info"),[P,T]=we("geojson"),O=I=>{x(I),localStorage.setItem("tab",I)},{clearLocalStorage:A,setLocalStorage:w,getLocalStorage:M}=Tp();bs(()=>{o(Af(n))},[]);const k=Le(()=>{if(i){const I=Nu(i,ia);return I.start(),I}},[i]),F=Ke(I=>{k&&(l(I),k.setMode(I))},[k]);return bs(()=>{if(k){k.on("change",()=>{const B=k.getSnapshot();m(B),_(B.find(z=>z.properties.selected)),w(zp(B))});const I=M();if(I){const B=JSON.parse(I);k.addFeatures(B)}}},[M,w,k]),W("div",{class:Ft.home,children:[W("div",{ref:e,class:Ft.map,id:n.id,children:[navigator.geolocation&&k?W(Mp,{setLocation:I=>{i&&i.setView([I[1],I[0]],14)}}):null,k?W(Ep,{draw:k,clearLocalStorage:A}):null,k?W(xp,{mode:s,changeMode:F}):null]}),W("div",{class:h?Ft.expanded:Ft.collapsed,children:[W("button",{class:Ft.collapse,onClick:()=>{typeof window<"u"&&setTimeout(()=>{i==null||i.invalidateSize()},500),u(!h)},children:h?">":"<"}),W("div",{class:h?Ft.tabs:Ft.tabsHidden,children:[W("div",{class:Ft.tabButtons,children:[W("span",{class:v==="geojson"?Ft.tabActive:Ft.tab,onClick:()=>O("geojson"),children:"GeoJSON"}),W("span",{class:v==="info"?Ft.tabActive:Ft.tab,onClick:()=>O("info"),children:"Info"})]}),v==="info"?W(tp,{selected:d,features:p}):W(dp,{features:p,format:P,setFormat:I=>T(I)})]})]})]})},Dp="_apiDocs_1l37o_1",Op={apiDocs:Dp},Ap=()=>W("iframe",{class:Op.apiDocs,width:"100%",src:"https://jameslmilner.github.io/terra-draw/modules.html"}),Bp=()=>W("div",{id:"app",children:[W(Oc,{}),W(qt,{history:mc(),children:[W(vn,{path:"/",component:Ip}),W(vn,{path:"/api/",component:Ap})]})]});let Pe;const Fp=(n,e)=>{if(Pe=void 0,e&&e.type==="click"){if(e.ctrlKey||e.metaKey||e.altKey||e.shiftKey||e.button!==0)return n;const i=e.target.closest("a[href]");if(!i||i.origin!=location.origin||/^#/.test(i.getAttribute("href"))||!/^(_?self)?$/i.test(i.target))return n;Pe=!0,e.preventDefault(),e=i.href.replace(location.origin,"")}else typeof e=="string"?Pe=!0:e&&e.url?(Pe=!e.replace,e=e.url):e=location.pathname+location.search;return Pe===!0?history.pushState(null,"",e):Pe===!1&&history.replaceState(null,"",e),e};function Pl(n){const[e,i]=Aa(Fp,n.url||location.pathname+location.search),o=Pe===!0,s=Le(()=>{const l=new URL(e,location.origin),h=l.pathname.replace(/(.)\/$/g,"$1");return{url:e,path:h,query:Object.fromEntries(l.searchParams),route:(u,d)=>i({url:u,replace:d}),wasPush:o}},[e]);return Yc(()=>(addEventListener("click",i),addEventListener("popstate",i),()=>{removeEventListener("click",i),removeEventListener("popstate",i)}),[]),Qe(Pl.ctx.Provider,{value:s},n.children)}Promise.resolve();Pl.ctx=Ar({});Ar({});const da=J.__e;J.__e=(n,e,i)=>{if(n&&n.then){let o=e;for(;o=o.__;)if(o.__c&&o.__c.__c)return e.__e==null&&(e.__e=i.__e,e.__k=i.__k),e.__k||(e.__k=[]),o.__c.__c(n,e)}da&&da(n,e,i)};let fa;function Rp(n,e){if(typeof window>"u")return;let i=document.querySelector("script[type=isodata]");e=e||i&&i.parentNode||document.body,!fa&&i?Or(n,e):Dr(n,e),fa=!0}typeof window<"u"&&Rp(W(Bp,{}),document.getElementById("app"));
